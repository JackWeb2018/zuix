#### Component Management

Exception made for handling of standard events and behaviors,
a view cannot implement a more complex UI logic.

This is where *components* are being used. Differently from a
view, a component has a piece of *JavaScript* code associated
to it and can so control any element in its view and implement
any kind of UI functionality.

This JavaScript code is the **Controller** (or *Presenter*)
of the component.

<small><strong>EXAMPLE</strong> Declaration of a generic controller for ```path/to/component_name```</small>
<pre><code class="language-js">
// Controller of component 'path/to/component_name'
zuix.controller(function(cp) {

    cp.create = function() { /* called after loading, when the component is created */ };

    cp.destroy = function() { /* called when the component is destroyed */ }

}).for('path/to/component_name');
</code></pre>


##### The Controller

The ```cp``` object passed to the controller handler is the controller instance itself and exposes
the following fields/methods.

Component's life-cycle handlers:

- ```cp.create = function() {..}```

    *handler function* that gets called after loading, when the component is created

- ```cp.destroy = function() {..}```

    *handler function* called when the component is destroyed

Component's methods:

- ```cp.view()``` - get the component's view element
- ```cp.field(fieldName)``` - get from the component's view the element with matching ```data-ui-field``` attribute
- ```cp.model([mode])``` - get/set the data model object
- ```cp.options([options])``` - get/set the component's options
- ```cp.loadHtml([options])``` - replace the current view with another one
- ```cp.loadCss([options])``` - replace the current view's style with another one
- ```cp.saveView([options])``` - save the current view
- ```cp.restoreView([options])``` - restore a previously saved view

##### Loading a component

To load a component, the ```data-ui-load``` attribute is used. The value of this
attribute is the *component identifier*. Also a ```data-ui-options```
attribute might be provided as for all other options/features already described
for ```data-ui-include``` in [content loading](#Getting_Started--Content_Loading).

<small><strong>EXAMPLE</strong> Loading of the component ```path/to/component_name```</small>
```html
<div data-ui-load="path/to/component_name"></div>
```





<p>&nbsp;</p>
<p>&nbsp;</p>

----

<mark>DRAFT TEXT BELOW THIS LINE</mark>

----

<p>&nbsp;</p>
<p>&nbsp;</p>




For example, consider the following "Summary Card" component, which
shows a title, a summary text and a link to open the full article.

<small><strong>EXAMPLE</strong> View template for the component ```site/components/summary_card```</small>
<pre data-line="3,5,10"><code class="language-html">
<div data-ui-view="site/components/summary_card" class="mdl-card mdl-shadow--2dp">
    <div class="mdl-card__title">
        <h2 data-ui-field="title" class="mdl-card__title-text">Welcome</h2>
    </div>
    <div data-ui-field="summary" class="mdl-card__supporting-text">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.
        Mauris sagittis pellentesque lacus eleifend lacinia...
    </div>
    <div class="mdl-card__actions mdl-card--border">
        <a data-ui-field="button-read" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
            Read more
        </a>
    </div>
</div>
</code></pre>

The above view template can be either placed in-line or
in files (```site/components/summary_card.html``` - ```site/components/summary_card.css```),
in which case the ```data-ui-view``` attribute can be omitted.

<small><strong>EXAMPLE</strong> Controller for the component ```site/components/summary_card```</small>
<pre data-line="5"><code>
zuix.controller(function(cp) {

    cp.create = function() {
        // bind UI events
        cp.field('button-read').on('click', function() { ... };
        // etc...
    };

}).for('site/components/summary_card');
</code></pre>

Also the controller code can be either placed in-line or
in its own file (```site/components/summary_card.js```),
in which case the instruction ```.for('site/components/summary_card')``` can be omitted.

<small><strong>EXAMPLE</strong> Inclusion of the component ```site/components/summary_card```</small>
```html
<div data-ui-load="site/components/summary_card"></div>
```

<small><strong>RESULT</strong> Component ```site/components/actions_menu```</small>

<div data-ui-view="site/components/summary_card" class="mdl-card mdl-shadow--2dp">
<div class="mdl-card__title">
<h2 data-ui-field="title" class="mdl-card__title-text">Welcome</h2>
</div>
<div data-ui-field="summary" class="mdl-card__supporting-text">
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
Mauris sagittis pellentesque lacus eleifend lacinia...
</div>
<div class="mdl-card__actions mdl-card--border">
<a data-ui-field="button-read" class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
Read more
</a>
</div>
</div>
<style>
    [data-ui-component="site/components/summary_card"]
    .mdl-card { width: auto; }
</style>
<script>
    zuix.controller(function(cp) {

        cp.create = function() {
            // load the view template
            zuix.$(cp.field('button-read')).on('click', function () {
                console.log('clicked!');
                cp.restoreView();
            });
        };

    }).for('site/components/summary_card');
</script>


Or with inline data-binding.....


```html
<div data-ui-load="site/components/summary_card">
    <div data-ui-field="title">Article 1</div>
    <div data-ui-field="summary">Text of article 1 summary...</div>
</div>
<div data-ui-load="site/components/summary_card">
    <div data-ui-field="title">Article 2</div>
    <div data-ui-field="summary">Text of article 2 summary...</div>
</div>
```


<div layout="row center-stretch">
<div data-ui-load="site/components/summary_card">
<div data-ui-field="title">Change Template on click</div>
<div data-ui-field="summary">Text of article 1 summary...</div>
</div>
<div data-ui-load="site/components/summary_card">
<div data-ui-field="title">Article 2</div>
<div data-ui-field="summary">Text of article 2 summary...</div>
</div>
</div>



```js
zuix.controller(function(cp) {

    cp.create = function() { /* called after loading, when the component is created */ };

    cp.destroy = function() { /* called when the component is destroyed */ }

}).for('path/to/component_name');
```



##### Inline Component




<small><strong>COMPONENT SCHEMA</strong> Inline definition of the component identified by ```path/to/component_name```</small>
<pre data-line="2,5,8"><code class="language-html">
<div data-ui-view="path/to/component_name">
    <!-- HTML View -->
</div>
<style>
    /*--  CSS View's Style -*/
</style>
<script>
    //--   JS Controller
    zuix.controller(function(cp) {

        cp.create = function() { /* ... */ };

        cp.destroy = function() { /* ... */ }

    }).for('path/to/component_name');
</script>
</code></pre>




The following example is an "action menu" component.


<small><strong>EXAMPLE COMPONENT</strong> Inline definition of the component ```site/components/actions_menu```</small>
<pre data-line="1,24,30"><code class="language-html">
<div data-ui-view="site/components/actions_menu"
     layout="row center-left">
    <!-- FAB menu button -->
    <div style="max-width: 56px;">
        <a class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--6dp">
            <i class="material-icons">settings</i>
        </a>
    </div>
    <!-- menu actions buttons -->
    <div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">edit</i>
        </div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">insert_comment</i>
        </div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">delete_forever</i>
        </div>
    </div>
</div>
<script>
// 'site/components/actions_menu' controller
zuix.controller(function(cp) {

    cp.create = function() { ... }

    cp.destroy = function() { ... }

}, 'site/components/actions_menu');
</script>
</code></pre>

Loading of the above component

```html
<div data-ui-load="site/components/actions_menu"></div>
```

<small><strong>RESULT</strong> Component ```site/components/actions_menu```</small>

<div data-ui-field="example-actions_menu"
 data-ui-options="example_action_menu_options"
 data-ui-load="site/components/actions_menu"
 -data-ui-lazyload="false"
 class="content-padding"
 layout="row center-left">
<!-- menu actions -->
<!-- Colored FAB button with ripple -->
<div style="max-width: 56px;">
<a class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--6dp">
<i class="material-icons">settings</i>
</a>
</div>
<div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">edit</i>
</div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">insert_comment</i>
</div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">delete_forever</i>
</div>
</div>
</div>
<style>
[data-ui-load="site/components/actions_menu"] [class*="mdl-button--mini-fab"] {
    margin: 4px 0 4px 16px;
}
</style>
<script>
var example_action_menu_options = {
    on: {
        'item:click': function (e, i) {
            console.log('Action menu clicked ', i, this);
        }
    }
};
</script>



A component can also be implemented in files:

- *(componentId)*.html
- *(componentId)*.css
- *(componentId)*.js



This JavaScript code is the so called **Controller** of the component
and it is an handler function that implements the following
two methods:

- **create()**
called when the component is created
- **destroy()**
called when the component is destroyed


For example consider an action menu component implemented with
an MDL FAB that, when clicked, will shows up some action buttons.

Example - MDL action menu

<pre><code class="language-html">
<div layout="row center-left">
    <!-- FAB menu button -->
    <div style="max-width: 56px;">
        <a class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--6dp">
            <i class="material-icons">settings</i>
        </a>
    </div>
    <!-- menu actions buttons -->
    <div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">edit</i>
        </div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">insert_comment</i>
        </div>
        <div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
            <i class="material-icons">delete_forever</i>
        </div>
    </div>
</div>
</code></pre>

That will output the following

<div layout="row center-left" class="content-padding">
<!-- FAB menu button -->
<div style="max-width: 56px;">
<a class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--6dp">
<i class="material-icons">settings</i>
</a>
</div>
<!-- menu actions buttons -->
<div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">edit</i>
</div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">insert_comment</i>
</div>
<div class="mdl-button mdl-button--fab mdl-js-button mdl-js-ripple-effect mdl-button--mini-fab mdl-shadow--2dp">
<i class="material-icons">delete_forever</i>
</div>
</div>
</div>

which actually looks good, but it's not animated and also
we won't be able to know when the user clicked a button by just
using event or behavior handlers of the view.

For that purpose we need to write the *JavaScript* code
that implements the component's controller.

The *controller* code will take care of collapsing/expanding
the actions buttons when the user clicks the FAB button.
It will also cause an ```item:click``` event when an
action buttons is clicked.

The *JavaScript* code can be either be placed inline or in a separate file.








There are different ways for loading a component.
The previous example is a component


###### Inline Component



###### Component bundled with its own View

<pre><code class="language-html">
<div data-ui-view="site/components/actions_menu"
     data-ui-load="site/components/actions_menu"
     data-ui-options="componentOptions">
     <!-- inline component view -->
    <h3 data-ui-field="title"></h3>
</div>
<script>
var exampleController = zuix.controller(function(cp){
    cp.create = function() {
        cp.field('title').html('Helllo World!');
    }
});
var componentOptions = { controller: exampleController };
</script>
</code></pre>

or in a file...
....


- <mark>Component with both view and controller on a file</mark>
- <mark>Component with inline view and controller on a file</mark>
- <mark>Component with inline view and inline controller</mark>
- <mark>Component with controller only (?)</mark>


<small>
    <strong>Inline controller</strong>
    The controller is specified in the ```data-ui-options```
    attribute.
</small>
<pre><code class="language-html keyword-start line-numbers">
    <div data-ui-load="site/components/actions_menu"
         data-ui-options="componentOptions"></div>
    <script>
    var exampleController = zuix.controller(function(cp){
        cp.create = function() {
            cp.view().html('Helllo World!');
        }
    });
    var componentOptions = {
        controller: exampleController,
        ready: function () {
            console.log('Loading complete.');
            console.log('Component object', this);
        },
        error: function(error) {
            console.log('Loading error!', error);
        }
    };
    </script>
</code></pre>

<!--
<small>
    <strong>INLINE CONTROLLER (METHOD 2)</strong>
    The controller is passed with the options
    of the ```zuix.load(view,options)``` method.
</small>
<pre><code class="language-html keyword-start line-numbers">
    <script>
    var exampleController = zuix.controller(function(cp){
        cp.create = function() {
            cp.view().html('Helllo World!');
        }
    });
    var componentContext = zuix.load('simple_view', {
        controller: exampleController,
        ready: function () {
            console.log('Component loading complete');
            console.log('Component Context', this);
        },
        error: function(error) {
            console.log('Component loading error', error);
        }
    });
    componentContext.append(my_container);
    </script>
</code></pre>
-->

<small><strong>EXAMPLE</strong> Controller implementation</small>

<pre><code class="language-js">
zuix.controller(function (cp) {
    var actions_menu, fab, actions;
    var open = false;

    cp.create = function () {

        // actions menu view
        actions_menu = zuix.$(cp.view());

        // fab button
        fab = actions_menu.children().eq(0);
        fab.on('click', function () {
            toggleActionsMenu();
        });

        // actions buttons
        actions = actions_menu.children().eq(1)
                    .css('overflow', 'hidden')
                    .children();
        actions.each(function (index) {
            zuix.$(this).on('click', function () {
                toggleActionsMenu();
                cp.trigger('item:click', index);
            }).css('visibility','hidden');
        });

    };

});
</code></pre>

<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

So a complete component may consist of three files:

    (component_name).css
    (component_name).html
    (component_name).js


<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


<div data-ui-field="test"
data-ui-load="site/components/slideshow"
data-ui-options="main.options.example_component"
style="visibility:hidden;background: black">
<img src="https://images.pexels.com/photos/132037/pexels-photo-132037.jpeg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/132037/pexels-photo-132037.jpeg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/1562/italian-landscape-mountains-nature.jpg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/1562/italian-landscape-mountains-nature.jpg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/36717/amazing-animal-beautiful-beautifull.jpg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/36717/amazing-animal-beautiful-beautifull.jpg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/30469/pexels-photo-30469.jpg?h=60&auto=compress"
     data-href=https://images.pexels.com/photos/30469/pexels-photo-30469.jpg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/132037/pexels-photo-132037.jpeg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/132037/pexels-photo-132037.jpeg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/1562/italian-landscape-mountains-nature.jpg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/1562/italian-landscape-mountains-nature.jpg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/36717/amazing-animal-beautiful-beautifull.jpg?h=60&auto=compress"
     data-href="https://images.pexels.com/photos/36717/amazing-animal-beautiful-beautifull.jpg?h=240&auto=compress">
<img src="https://images.pexels.com/photos/30469/pexels-photo-30469.jpg?h=60&auto=compress"
     data-href=https://images.pexels.com/photos/30469/pexels-photo-30469.jpg?h=240&auto=compress">
</div>

<p>.</p>

<style type="text/css">
    /*
     * Custom keyword styles
     */
    .token.keyword.keyword-data-ui-load, .token.keyword.keyword-load {
        color: #f92672;
    }
    .token.zuix_obj {
        color: purple;
    }
    .token.zuix_ctr {
        color: gray;
    }
</style>


##### Applying a same Controller to different Views


<p></p>
<p>.</p>
<p>.</p>
<p>.</p>
<p></p>

##### Component Life-Cycle



#### Hooks

<p></p>
<p>.</p>
<p>.</p>
<p>.</p>
<p></p>


#### About caching


<p></p>
<p>.</p>
<p>.</p>
<p>.</p>
<p></p>

#### Guidelines


<p></p>
<p>.</p>
<p>.</p>
<p>.</p>
<p></p>


### More examples

<p>.</p>

<p>.</p>

...

##### Example 1 - Loading external hosted component

<small>HTML</small>
<pre><code class="language-markup">
    <div data-ui-load="https://codepen.io/genielabs/pen/RomJZy"></div>
</code></pre>
<small>JavaScript</small>
<pre><code class="language-js">
    // load a component from CodePen
    // and override its controller logic
    // with an inline one
    zuix.load('https://codepen.io/genielabs/pen/RomJZy', {
        container: zuix.field('my-container'),
        controller: zuix.controller(function(cp) {
            // inline controller function
            // TODO: implement your own controller logic
        },
        ready: function (context) {
            // component loaded and ready
            console.log(context);
        }
    });
</code></pre>
<!--
<small>Result</small>
<div self="size1of2">
    <div data-ui-load="https://codepen.io/genielabs/pen/RomJZy"
         data-ui-options="main.options.codepen_example_01"
    ></div>
</div>

<small>Component on CodePen</small>
<p data-height="430" data-theme-id="26976" data-slug-hash="RomJZy" data-default-tab="js,result" data-user="genielabs" data-embed-version="2" data-pen-title="zuix test" class="codepen">See the Pen <a href="https://codepen.io/genielabs/pen/RomJZy/">zuix test</a> by Gene (<a href="https://codepen.io/genielabs">@genielabs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script src="https://production-assets.codepen.io/assets/embed/ei.js"></script>

-->
