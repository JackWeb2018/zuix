/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.
         https://genielabs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';!function(z){if("object"==typeof exports)module.exports=z();else if("function"==typeof define&&define.amd)define(z);else{var h;"undefined"!=typeof window?h=window:"undefined"!=typeof global?h=global:"undefined"!=typeof self&&(h=self);h.zuix=z()}}(function(){return function h(p,q,c){function e(a,b){if(!q[a]){if(!p[a]){var f="function"==typeof require&&require;if(!b&&f)return f(a,!0);if(d)return d(a,!0);throw Error("Cannot find module '"+a+"'");}f=q[a]={exports:{}};p[a][0].call(f.exports,
function(b){var d=p[a][1][b];return e(d?d:b)},f,f.exports,h,p,q,c)}return q[a].exports}for(var d="function"==typeof require&&require,b=0;b<c.length;b++)e(c[b]);return e}({1:[function(h,p,q){function c(b){e=window?window.console:{};this._context=b;this._timers={};this.args=function(a,b,d){a="%c "+b+" %c"+(new Date).toISOString()+" %c"+a;b=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];
for(var c=0;c<d.length;c++)if("string"==typeof d[c]&&0==d[c].indexOf("timer:")){var g=d[c].split(":");if(3==g.length)switch(g[2]){case "start":this._timers[g[1]]=(new Date).getTime();a+=" %cSTART "+g[1];b.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":a+=" %cSTOP "+g[1]+" "+((new Date).getTime()-this._timers[g[1]])+" ms",b.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}a+=" \n%c ";b.push("background-color:transparent;color:inherit;");for(c=b.length-
1;0<=c;c--)Array.prototype.unshift.call(d,b[c]);Array.prototype.unshift.call(d,a);Array.prototype.push.call(d,"\n\n")}}var e=null,d="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" ");c.prototype.console=function(b){if(b)window.console=e;else for(window.console={},b=0;b<d.length;b++)window.console[d[b]]||(window.console[d[b]]=function(){})};c.prototype.i=c.prototype.info=c.prototype.l=c.prototype.log=
function(){this.args(this._context,"INFO",arguments);e.log.apply(e,arguments);return this};c.prototype.w=c.prototype.warn=function(){this.args(this._context,"WARN",arguments);e.log.apply(e,arguments);return this};c.prototype.e=c.prototype.error=function(){this.args(this._context,"ERROR",arguments);e.log.apply(e,arguments);return this};c.prototype.d=c.prototype.debug=function(){this.args(this._context,"DEBUG",arguments);e.log.apply(e,arguments);return this};c.prototype.t=c.prototype.trace=function(){this.args(this._context,
"TRACE",arguments);e.log.apply(e,arguments);return this};p.exports=function(b){return new c(b)}},{}],2:[function(h,p,q){function c(d){var b=this;b._worker=null;b._taskList=[];b._requests=[];null==d&&(d=function(){});b.taskQueue=function(a,c,f){b._taskList.push({tid:a,fn:c,status:0,priority:f,step:function(a){e.t(a,"load:step");d(b,"load:step",{task:a})},end:function(){this.status=2;e.t(this.tid,"load:next","timer:task:stop");d(b,"load:next",{task:this.tid});b._taskList.splice(this.index,1);b.taskCheck();
null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});e.t(a,"task added",f,"priority");b._taskList.sort(function(a,b){return a.priority>b.priority?1:b.priority>a.priority?-1:0});b.taskCheck()};b.taskCheck=function(){for(var a=0;a<b._taskList.length;a++){if(0==b._taskList[a].status){b._taskList[a].status=1;e.t(b._taskList[a].tid,"load:begin",a,"timer:task:start");d(b,"load:begin",{task:b._taskList[a].tid});b._taskList[a].index=a;b._taskList[a].fn.call(b._taskList[a]);
return}if(1==b._taskList[a].status||2==b._taskList[a].status)return}e.t("load:end");d(b,"load:end")}}var e=h("./Logger")("TaskQueue.js");c.prototype.queue=function(d,b,a){return this.taskQueue(d,b,a)};c.prototype.requestLock=function(d){return null!=d._taskerLock?!1:d._taskerLock=!0};c.prototype.releaseLock=function(d){setTimeout(function(){delete d._taskerLock},10)};c.prototype.lockLater=function(d,b,a){var c=this;null==d._taskerLock?b():null==d._taskerTimeout&&(d._taskerTimeout=!0,d._taskerTimeout=
setTimeout(function(){delete d._taskerTimeout;c.lockLater(d,b,a)},a));return!0};p.exports=c},{"./Logger":1}],3:[function(h,p,q){p.exports={isNoU:function(c){return"undefined"===typeof c||null===c},isFunction:function(c){return"function"===typeof c},objectEquals:function(c,e){if(null===c||void 0===c||null===e||void 0===e)return c===e;if(c.constructor!==e.constructor)return!1;if(c instanceof Function||c instanceof RegExp)return c===e;if(c===e||c.valueOf()===e.valueOf())return!0;if(Array.isArray(c)&&
c.length!==e.length||c instanceof Date||!(c instanceof Object)||!(e instanceof Object))return!1;var d=Object.keys(c);return Object.keys(e).every(function(b){return-1!==d.indexOf(b)})&&d.every(function(b){return util.objectEquals(c[b],e[b])})},propertyFromPath:function(c,e){if("string"===typeof e){e=e.replace(/\[(\w+)]/g,".$1");e=e.replace(/^\./,"");for(var d=e.split("."),b=c,a=0,h=d.length;a<h;++a){var f=d[a];if("undefined"!==typeof b[f])b=b[f];else return}return b}},cloneObject:function e(d){if(null===
d||"object"!==typeof d)return d;var b=d.constructor(),a;for(a in d)b[a]=e(d[a]);return b},evalJs:eval}},{}],4:[function(h,p,q){function c(a){b(this,a.type,a)}function e(a,b,d){var f=!1;g.each(m,function(){if(this.element===a&&this.path===b&&this.handler==d)return u.w("Handler already registered",a,b,d),f=!0,!1});f||(m.push({element:a,path:b,handler:d}),a.addEventListener(b,c,!1))}function d(a,b,d){var f=1,e=-1;g.each(m,function(c){this.element===a&&this.path===b&&this.handler==d&&(f--,e=c)});-1!==
e&&m.splice(e,1);0==f&&a.removeEventListener(b,c)}function b(a,b,d){var c=g(a);g.each(m,function(){this.element===a&&this.path===b&&this.handler.call(c,d)})}function a(k){this._selection=[];"undefined"===typeof k&&(k=document.documentElement);if(k instanceof a)return k;if(k instanceof HTMLCollection||k instanceof NodeList||Array.isArray(k))this._selection=k;else if(k instanceof HTMLElement||k instanceof Node)this._selection=[k];else if("string"===typeof k)this._selection=document.documentElement.querySelectorAll(k);
else if(null!==k)throw u.e("ZxQuery cannot wrap object of this type.",typeof k,k),Error(),k;return this}var u=h("./Logger")("TaskQueue.js"),f=h("./Util.js"),m=[];a.prototype.length=function(){return this._selection.length};a.prototype.parent=function(k){return f.isNoU(k)?new a(this._selection[0].parentNode):new a(g.getClosest(this._selection[0],k))};a.prototype.children=function(k){return f.isNoU(k)?new a(this._selection[0].children):new a(this._selection[0].querySelectorAll(k))};a.prototype.reverse=
function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};a.prototype.get=function(a){f.isNoU(a)&&(a=0);return this._selection[a]};a.prototype.eq=function(k){return new a(this._selection[k])};a.prototype.find=function(k){return new a(this._selection[0].querySelectorAll(k))};a.prototype.each=function(a){g.each(this._selection,a);return this};a.prototype.attr=function(a,b){if(f.isNoU(b))return this._selection[0].getAttribute(a);this.each(function(d,c){this.get().setAttribute(a,
b)});return this};a.prototype.trigger=function(a,b){var d;window.CustomEvent?d=new CustomEvent(a,{detail:b}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,b));this.each(function(a,k){k.dispatchEvent(d)});return this};a.prototype.one=function(a,b){var d=!1;this.on(a,function(c,f){d||(d=!0,g(this).off(a,b),b.call(this,c,f))});return this};a.prototype.on=function(a,b){var d=a.match(/\S+/g)||[];this.each(function(a,k){g.each(d,function(a,d){e(k,d,b)})});return this};a.prototype.off=
function(a,b){var c=a.match(/\S+/g)||[];this.each(function(a,k){g.each(c,function(a,c){d(k,c,b)})});return this};a.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};a.prototype.position=function(){return null!=this._selection[0]?g.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};a.prototype.css=function(a,b){if(f.isNoU(b))return this._selection[0].style[a];this.each(function(d,c){c.style[a]=b});return this};a.prototype.addClass=function(a){var b=
a.match(/\S+/g)||[];g.each(this._selection,function(d,c){c.classList?g.each(b,function(a,k){c.classList.add(k)}):c.className+=" "+a});return this};a.prototype.hasClass=function(a){return g.hasClass(this._selection[0],a)};a.prototype.removeClass=function(a){var b=a.match(/\S+/g)||[];g.each(this._selection,function(d,c){c.classList?g.each(b,function(a,k){c.classList.remove(k)}):c.className=c.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")});return this};a.prototype.prev=
function(){return new a(this._selection[0].previousElementSibling)};a.prototype.next=function(){return new a(this._selection[0].nextElementSibling)};a.prototype.html=function(a){if(f.isNoU(a))return this._selection[0].innerHTML;this.each(function(b,d){d.innerHTML=a});return this};a.prototype.append=function(a){"string"===typeof a?this._selection[0].innerHTML+=a:this._selection[0].appendChild(a);return this};a.prototype.prepend=function(a){"string"===typeof a?this._selection[0].innerHTML=a+this._selection[0].innerHTML:
this._selection[0].insertBefore(a,this._selection[0].innerHTML.firstElementChild);return this};a.prototype.display=function(a){if(f.isNoU(a))return this._selection[0].style.display;g.each(this._selection,function(b,d){d.style.display=a});return this};a.prototype.visibility=function(a){if(f.isNoU(a))return this._selection[0].style.visibility;g.each(this._selection,function(b,d){d.style.visibility=a});return this};a.prototype.show=function(){return this.display("")};a.prototype.hide=function(){return this.display("none")};
var g=function(b){return new a(b)};g.find=function(a){return g().find(a)};g.each=function(a,b){if(null!=a)for(var d=0,c=a.length;d<c;d++){var f=a[d];f instanceof Element&&(f=g(f));if(!1===b.call(f,d,a[d]))break}return this};g.hasClass=function(a,b){var d=b.match(/\S+/g)||[],c=!1;g.each(d,function(b,d){if(c=a.classList?a.classList.contains(d):(new RegExp("(^| )"+d+"( |$)","gi")).test(a.className))return!1});return c};g.ajax=function(a){var b;b=f.isNoU(a)||f.isNoU(a.url)?a:a.url;var d=new XMLHttpRequest;
d.open("GET",b);d.onload=function(){200===d.status?f.isFunction(a.success)&&a.success(d.responseText):f.isFunction(a.error)&&a.error(d);f.isFunction(a.then)&&a.then(d)};d.send();return this};g.wrapElement=function(a,b){var d=document.createElement(a);"string"===typeof b?d.innerHTML=b:d.appendChild(b);return d};g.wrapCss=function(a,b){for(var d=/([.,\w])([^/{};]+)({)/g,c,f=null,e="";c=d.exec(b);){if(null!=f){var f=b.substring(f.index,c.index),m=/(.*)[^s]\{([^\}]+)[\}]/g.exec(f);if(null!=m&&1<m.length){var h=
m[1].split(",");g.each(h,function(b,d){e+="\n"+a+"\n"+d;b<h.length-1&&(e+=", ")});e+=" {"+m[2]+"}\n"}else u.w("ZUIX WARNING: z$.wrapCss was unable to parse rule.",m,f)}f=c}null!=f&&(e+=a+" "+b.substring(f.index));""!=e&&(b=e);return b};g.appendCss=function(a,b){var d=null,c;"string"===typeof a?(c=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style"),d.type="text/css",d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a))):a instanceof Element&&
(d=a);f.isNoU(b)||c.removeChild(b);f.isNoU(d)||c.appendChild(d);return d};g.getClosest=function(a,d){for(;a&&a!==document;a=a.parentNode)if(a.matches(d))return a;return null};g.getPosition=function(a){for(var d=g.isInView(a),b=0,c=0;a;){if("BODY"==a.tagName)var f=a.scrollTop||document.documentElement.scrollTop,b=b+(a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+a.clientLeft),c=c+(a.offsetTop-f+a.clientTop);else b+=a.offsetLeft-a.scrollLeft+a.clientLeft,c+=a.offsetTop-a.scrollTop+
a.clientTop;a=a.offsetParent}return{x:b,y:c,visible:d}};g.isInView=function(a){if(null===a.offsetParent)return!1;a=a.getBoundingClientRect();return 0<a.bottom&&0<a.right&&a.left<(window.innerWidth||document.documentElement.clientWidth)&&a.top<(window.innerHeight||document.documentElement.clientHeight)};g.ZxQuery=a;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||
Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var b=a.length;0<=--b&&a.item(b)!==this;);return-1<b});(function(){function a(b,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,d.bubbles,d.cancelable,d.detail);return c}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();p.exports=g},{"./Logger":1,"./Util.js":3}],
5:[function(h,p,q){h=h("./zuix/Zuix.js");"object"===typeof p&&p.exports?p.exports=h.call(this):this.zuix=h.call(this)},{"./zuix/Zuix.js":8}],6:[function(h,p,q){function c(a,b){this._options=null;this.contextId=null==a||null==a.contextId?null:a.contextId;this.componentId=null;this.trigger=function(a,d,c){"function"===typeof b&&b(a,d,c)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(a);
return this}var e=h("../helpers/Logger")("ComponentContext.js"),d=h("../helpers/ZxQuery"),b=h("../helpers/Util");c.prototype.container=function(a){if(null==a)return this._container;this._container=a;return this};c.prototype.view=function(a){if("undefined"===typeof a)return this._view;"string"===typeof a?(a={content:a},this.trigger(this,"html:parse",a),a=a.content,null!=this._container?(this._view=this._container,this._view.innerHTML+=a):(a=d.wrapElement("div",a),null!=this._view?this._view.innerHTML=
a.innerHTML:this._view=a),d(this._view).find("script").each(function(a,b){"true"!==this.attr("zuix-loaded")&&(this.attr("zuix-loaded","true"),eval.call(window,b.innerHTML))}),this.trigger(this,"view:process",d(this._view))):(a instanceof d.ZxQuery&&(a=a.get()),null!=this._container?(this._view=d.wrapElement("div",a.outerHTML).firstElementChild,this._view.removeAttribute("data-ui-view"),this._container.appendChild(this._view),this._view=this._container):this._view=a);a=d(this._view);!1===this._options.css?
a.addClass("zuix-css-ignore"):a.removeClass("zuix-css-ignore");this.modelToView();return this};c.prototype.style=function(a){if("undefined"===typeof a)return this._style;null==a||a instanceof Element?(this._css=a instanceof Element?a.innerText:a,this._style=d.appendCss(a,this._style)):"string"===typeof a&&(this._css=a,a=d.wrapCss('[data-ui-component="'+this.componentId+'"]:not(.zuix-css-ignore)',a),a={content:a},this.trigger(this,"css:parse",a),a=a.content,this._style=d.appendCss(a,this._style));
return this};c.prototype.model=function(a){if("undefined"===typeof a)return this._model;this._model=a;this.modelToView();return this};c.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};c.prototype.options=function(a){if(null==a)return this._options;this._options=a;null!=a.componentId&&(this.componentId=a.componentId);this.container(a.container);this.view(a.view);"undefined"!==typeof a.css&&this.style(a.css);this.controller(a.controller);
this.model(a.model);return this};c.prototype.on=function(a,b){this._c.on(a,b);return this};c.prototype.loadCss=function(a,c){var f=this;b.isNoU(a)&&(a={});b.isNoU(a.caching)||(c=a.caching);var m=f.componentId+".css";b.isNoU(a.path)||(m=a.path);c||(m+="?"+(new Date).getTime());d.ajax({url:m,success:function(d){f.style(d);b.isFunction(a.success)&&a.success.call(f)},error:function(d){e.e(d,f);b.isFunction(a.error)&&a.error.call(f,d)},then:function(){b.isFunction(a.then)&&a.then.call(f)}});return this};
c.prototype.loadHtml=function(a,c){var f=this,m=f.componentId;b.isNoU(a)&&(a={});b.isNoU(a.caching)||(c=a.caching);b.isNoU(a.path)||(m=a.path);var g=d().find('[data-ui-view="'+m+'"]:not([data-ui-component*=""])');0<g.length()?(m=g.get(0),f.view()===m||null!=f.container()&&f.container().contains(m)?f.view(m):f.view(m.outerHTML),b.isFunction(a.success)&&a.success.call(f),b.isFunction(a.then)&&a.then.call(f)):(m==f.componentId&&(m+=".html"+(c?"":"?"+(new Date).getTime())),d.ajax({url:m,success:function(d){f.view(d);
b.isFunction(a.success)&&a.success.call(f)},error:function(d){e.e(d,f);b.isFunction(a.error)&&a.error.call(f,d)},then:function(){b.isFunction(a.then)&&a.then.call(f)}}));return this};c.prototype.viewToModel=function(){var a=this;this._model={};d(this._view).find("[data-ui-field]").each(function(d,b){if(0<this.parent("pre,code").length())return!0;var c=this.attr("data-ui-field"),g="";switch(b.tagName.toLowerCase()){case "img":g=b.src;break;case "input":g=b.value;break;default:g=b.innerHTML}if(0<c.indexOf(".")){for(var c=
c.split("."),e=a._model,h=0;h<c.length-1;h++)"undefined"===typeof e[c[h]]&&(e[c[h]]={}),e=e[c[h]];e[c[c.length-1]]=g}else a._model[c]=g});return this};c.prototype.modelToView=function(){if(null!=this._view&&null!=this._model){var a=this;d(this._view).find("[data-ui-field]").each(function(c,f){if(0<this.parent("pre,code").length())return!0;var e=this.attr("data-bind-to");null==e&&(e=this.attr("data-ui-field"));if("function"===typeof a._model)a._model.call(d(a._view),this,e);else{var g=b.propertyFromPath(a._model,
e);if("function"===typeof g)g.call(d(a._view),this,e);else if(null!=g)switch(f.tagName.toLowerCase()){case "img":f.src=g;break;case "input":f.value=g;break;default:f.innerHTML=g}}})}return this};p.exports=c},{"../helpers/Logger":1,"../helpers/Util":3,"../helpers/ZxQuery":4}],7:[function(h,p,q){function c(d){var b=this;this._view=null;this.context=d;this._fieldCache=[];this.destroy=this.create=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,
d){b._childNodes.push(d)})};this.restoreView=function(){0<this._childNodes.length&&(b.view().html(""),e.each(b._childNodes,function(a,d){b.view().append(d)}),this._childNodes.length=0)};this.on=function(a,d){this.addEvent(this.view(),a,d);return this};this.mapEvent=function(a,d,b,c){null!=d&&(d.off(b,this.eventRouter),a[b]=c,d.on(b,this.eventRouter))};this.eventRouter=function(a){"function"===typeof d._behaviorMap[a.type]&&d._behaviorMap[a.type].call(b.view(),a,a.detail);"function"===typeof d._eventMap[a.type]&&
d._eventMap[a.type].call(b.view(),a,a.detail)};var a=d.options(),c=null;if(null!=a.on)for(var f in a.on)c=a.on[f],b.addEvent(b.view(),f,c);if(null!=a.behavior)for(var h in a.behavior)c=a.behavior[h],b.addBehavior(b.view(),h,c);d.controller().call(this,this);return this}var e=h("../helpers/ZxQuery");c.prototype.addEvent=function(d,b,a){this.mapEvent(this.context._eventMap,d,b,a);return this};c.prototype.addBehavior=function(d,b,a){this.mapEvent(this.context._behaviorMap,d,b,a);return this};c.prototype.field=
function(d){var b=this,a=null;"undefined"===typeof this._fieldCache[d]?(a=this.view().find("[data-ui-field="+d+"]"),null!=a&&(a.on=function(d,c,h,g){if("string"===typeof c){var k=c;c=function(){b.trigger(k,h,g)}}e.ZxQuery.prototype.on.call(a,d,c)},this._fieldCache[d]=a)):a=this._fieldCache[d];return a};c.prototype.clearCache=function(){this._fieldCache.length=0};c.prototype.view=function(d){if(null!=this.context.view()||this._view!==this.context.view())this._view=e(this.context.view());if(null!=d)return this._view.find(d);
if(null!==this._view)return this._view;throw{message:"Not attacched to a view yet.",source:this};};c.prototype.model=function(d){if(null==d)return this.context.model();this.context.model(d);return this};c.prototype.options=function(){return this.context.options()};c.prototype.trigger=function(d,b,a){null==this.context._eventMap[d]&&!0!==a&&this.addEvent(this.view(),d,null);!0===a?this.context.trigger(this.context,d,b):this.view().trigger(d,b);return this};c.prototype.expose=function(d,b){this.context[d]=
b;return this};c.prototype.loadCss=function(d){this.context.loadCss(d);return this};c.prototype.loadHtml=function(d){this.saveView();this.context.loadHtml(d);return this};c.prototype.for=function(d){return this};p.exports=c},{"../helpers/ZxQuery":4}],8:[function(h,p,q){function c(){return this}function e(a){v.requestLock(e)?(r(a).find("[data-ui-load]:not([data-ui-loaded=true]),[data-ui-include]:not([data-ui-loaded=true])").each(function(a,b){this.visibility("hidden");var c=b.lazyContainer||r.getClosest(b,
"[data-ui-lazyload=scroll]");b.lazyContainer=c;if(!(null!=c&&"force"==c.getAttribute("data-ui-lazyload")||m()&&"false"!=this.attr("data-ui-lazyload")))return d(b),!0;if(null!==c&&(-1==G.indexOf(c)&&(G.push(c),r(c).on("scroll",function(){e(c)})),!r.getPosition(b).visible))return-1==y.indexOf(b)&&y.push(b),!0;var F=y.indexOf(b);-1<F&&y.splice(F,1);d(b)}),v.releaseLock(e)):v.lockLater(e,function(){e(a)},200)}function d(a){var d=r(a);if("true"===d.attr("data-ui-loaded")||0<d.parent("pre,code").length())n.w("Skipped",
a);else{d.attr("data-ui-loaded","true");var c=d.attr("data-ui-options");l.isNoU(c)?c={}:(c=l.propertyFromPath(window,c),c=l.cloneObject(c)||{});l.isNoU(c.view)&&!d.isEmpty()?(c.view=a,c.viewDeferred=!0):l.isNoU(c.view)&&l.isNoU(c.container)&&d.isEmpty()&&(c.container=a);a=d.attr("data-ui-load");l.isNoU(a)&&(a=d.attr("data-ui-include"),d.attr("data-ui-component",a),l.isNoU(c.controller)&&(c.controller=function(){}));var e=d.attr("data-bind-model");!l.isNoU(e)&&0<e.length&&(c.model=l.propertyFromPath(window,
e));e=d.attr("data-ui-context");l.isNoU(e)||(c.contextId=e);d=d.attr("data-ui-priority");l.isNoU(d)?c.priority=w.length:c.priority=d;b(a,c)}}function b(d,c){var b=null;l.isNoU(c)?(c={},b=new E(c,f)):l.isNoU(c.contextId)?(!1===c&&(c={}),c.contextId="zuix-ctx-"+ ++L,b=a(c)):(b=u(c.contextId),null!==b?b.options(c):b=a(c));b.componentId!=d&&(b.componentId=d);l.isFunction(c.ready)&&(b.ready=c.ready);l.isFunction(c.error)&&(b.error=c.error);var e=g(b.componentId);null!==e&&null==c.controller&&null==b.controller()&&
(b.controller(e.controller),n.t(b.componentId,"loaded controller from cache"));if(l.isNoU(c.view)){if(null!==e&&null!=e.view&&(b.view(e.view),n.t(b.componentId,"loaded html from cache")),l.isNoU(b.view()))return v.queue("html:"+b.componentId,function(){var a=this;b.loadHtml({caching:t,success:function(){!1!==c.css?(a.step("css:"+b.componentId),b.loadCss({caching:t,error:function(a){n.e(a,b)},then:function(){k(b,a)}})):k(b,a)},error:function(a){n.e(a,b);l.isFunction(c.error)&&b.error.call(b,a)}})},
c.priority),b}else b.view(c.view);v.queue("js:"+b.componentId,function(){k(b,this)},w.length);return b}function a(a){a=new E(a,f);w.push(a);return a}function u(a){var b=null;a instanceof r.ZxQuery&&(a=a.get());r.each(w,function(c,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||l.objectEquals(d.contextId,a))return b=d,!1});return b}function f(a,b,c){l.isFunction(B[b])&&B[b].call(a,c);"view:process"==b&&e(c)}function m(a){null!=a&&(H=!a);return!C&&!H}function g(a){var b=null;r.each(x,
function(c,d){if(l.objectEquals(d.componentId,a))return b=d,!1});return b}function k(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(n.d(a.componentId,"loading controller"),l.isNoU(b)||b.step("js:"+a.componentId),l.isFunction(D[a.componentId]))a.controller(D[a.componentId]),A(a,b);else{var c=function(b){r.ajax({url:a.componentId+".js"+(t?"":"?"+(new Date).getTime()),success:function(b){try{var c=b.indexOf("function"),d=b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-
4));var e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+11));var f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+'.js"\n';a.controller(J(b))}catch(g){n.e(Error(),g,b,a),l.isFunction(a.error)&&a.error.call(a,g)}},error:function(b){n.e(b,Error(),a);l.isFunction(a.error)&&a.error.call(a,b)},then:function(){A(a,b)}})};l.isNoU(b)?v.queue("js:"+a.componentId,function(){c(this)},a.options().priority):c(b)}else A(a,b)}function I(a){var b=a.view()===a.container()?
a.view().innerHTML:a.view().outerHTML,b=r.wrapElement("div",b),b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};x.push(b);n.t(a.componentId,"added to cache",b);return b}function A(a,b){if(!l.isNoU(a.view())){var c=g(a.componentId);a.options().viewDeferred?n.w(a.componentId,"deferred view, not caching"):null===c&&(c=I(a),n.t(a.componentId,"added to cache",c));null!=b&&b.callback(function(){setTimeout(function(){n.d(a.componentId,"controller::create:deferred");l.isFunction(d.create)&&
d.create();d.trigger("view:create");e()},500)});n.d(a.componentId,"initializing component");if(l.isFunction(a.controller())){var d=a._c=new K(a);if(!l.isNoU(d.view())){d.view().attr("data-ui-component",a.componentId);l.isNoU(a.model())&&!l.isNoU(a.view())&&a.viewToModel();d.trigger("view:apply");if(a.options().viewDeferred){a.options().viewDeferred=!1;d.saveView();null===c&&(c={componentId:a.componentId,controller:a.controller()},x.push(c),n.e(a.componentId,"added to cache",c));var f=-1;!1!==a.options().css&&
(null==c.css?(-1==f&&(f=0),f++,a.loadCss({caching:t,then:function(){c.css=this._css;0===--f&&null!=b&&b.end();n.e(a.componentId,"updated cached css",c,f)}})):a.style(c.css));!1!==a.options().html&&(null==c.view?(-1==f&&(f=0),f++,a.loadHtml({caching:t,then:function(){c.view=this.view().innerHTML;0===--f&&null!=b&&b.end();n.e(a.componentId,"updated cached html",c,f)}})):a.view(c.view));-1==f&&null!=b&&b.end()}else null!=b&&b.end();d.view().css("visibility","")}null==b&&(n.d(a.componentId,"controller::create"),
l.isFunction(d.create)&&d.create(),d.trigger("view:create"))}else n.w(a.componentId,"no controller defined");l.isFunction(a.ready)&&a.ready.call(a)}n.d(a.componentId,"component created")}function J(a){var b=function(a){};if("string"===typeof a)try{b=eval.call(this,a)}catch(c){n.e(this,c,a)}return b}var n=h("../helpers/Logger")("Zuix.js"),l=h("../helpers/Util"),r=h("../helpers/ZxQuery");q=h("../helpers/TaskQueue");var E=h("./ComponentContext"),K=h("./ContextController"),x=[],L=0,w=[],B=[],D={},y=[],
G=[],v=new q(function(a,b,c){f(a,b,c)}),C=!1,H=!1,t=!0;navigator&&navigator.userAgent&&(C=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));C&&n.d(navigator.userAgent,"is a bot, ignoring 'data-ui-lazyload' option.");c.prototype.controller=function(a){"function"!==typeof a["for"]&&(a["for"]=function(b){return D[b]=a});return a};c.prototype.field=function(a,b){return r(b).find('[data-ui-field="'+a+'"]')};c.prototype.componentize=function(a){e(a);return this};c.prototype.load=
b;c.prototype.unload=function(a){l.isNoU(a)||l.isNoU(a._c)||(l.isNoU(a._c.view())||a._c.view().attr("data-ui-component",null),l.isFunction(a._c.destroy)&&a._c.destroy());return this};c.prototype.context=u;c.prototype.trigger=function(a,b,c){f(a,b,c);return this};c.prototype.hook=function(a,b){l.isNoU(b)||(B[a]=b);return this};c.prototype.lazyLoad=m;c.prototype.httpCaching=function(a){null!=a&&(t=a);return t};c.prototype.$=r;c.prototype.TaskQueue=q;c.prototype.ZxQuery=r.ZxQuery;c.prototype.dumpCache=
function(){n.d("Component Cache",x)};c.prototype.dumpContexts=function(){n.d("Loaded Component Instances",w)};p.exports=function(a){var b=new c;"loading"!=document.readyState?b.componentize():document.addEventListener("DOMContentLoaded",function(){b.componentize()});return b}},{"../helpers/Logger":1,"../helpers/TaskQueue":2,"../helpers/Util":3,"../helpers/ZxQuery":4,"./ComponentContext":6,"./ContextController":7}]},{},[5])(5)});
//# sourceMappingURL=zuix.min.js.map
