/*
 @license
 Copyright 2015-2019 G-Labs. All Rights Reserved.
         https://zuixjs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';(function(n){"object"===typeof exports&&"undefined"!==typeof module?module.exports=n():"function"===typeof define&&define.amd?define([],n):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).zuix=n()})(function(){return function(){function n(q,v,c){function g(b,d){if(!v[b]){if(!q[b]){var a="function"==typeof require&&require;if(!d&&a)return a(b,!0);if(h)return h(b,!0);d=Error("Cannot find module '"+b+"'");throw d.code="MODULE_NOT_FOUND",
d;}d=v[b]={exports:{}};q[b][0].call(d.exports,function(a){return g(q[b][1][a]||a)},d,d.exports,n,q,v,c)}return v[b].exports}for(var h="function"==typeof require&&require,d=0;d<c.length;d++)g(c[d]);return g}return n}()({1:[function(n,q,v){function c(e){a=e}function g(){null!==e&&(cancelAnimationFrame(e),e=null);k++;if(k<b.length&&!a.willBreak())return d(),!0;(k>=b.length||a.willBreak())&&h();return!1}function h(e){k=-1;b.length=0;b=[];a.status(null!=e?e:"done")}function d(){const d=b[k];if(null==d)return!1;
const c=function(){null!==e&&(cancelAnimationFrame(e),e=null);a.doWork(d.item,function(){e=requestAnimationFrame(g)})||g()};if(d.cancelable)if(a.willBreak())h("stopped");else if(null==e)e=requestAnimationFrame(c);else return!1;else c();return!0}c.prototype.isReady=function(){return 0===b.length||-1===k};c.prototype.getJobs=function(){return b};c.prototype.setJobs=function(e){0<b.length?(k=-1,b.length=0):(b=e.slice(),a.status("start",b),g())};c.prototype.append=function(a){this.isReady()?this.setJobs(a):
Array.prototype.push.apply(b,a)};let b=[],k=-1,a=null,e=null;q.exports=function(a){return new c(a)}},{}],2:[function(n,q,v){function c(c){h=window?window.console:{};d=window?window:{};this._timers={};this.args=function(a,e,b){a="%c "+e+" %c"+(new Date).toISOString()+" %c"+a;e=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];for(var d=0;d<b.length;d++)if("string"==typeof b[d]&&0===
b[d].indexOf("timer:")){const c=b[d].split(":");if(3===c.length){let f;switch(c[2]){case "start":this._timers[c[1]]=(new Date).getTime();a+=" %cSTART "+c[1];e.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":f=(new Date).getTime()-this._timers[c[1]],a+=" %cSTOP "+c[1]+" "+f+" ms",200<f?e.push("background-color:rgba(200,200,200,0.2);color:#ff0000;"):100<f?e.push("background-color:rgba(200,200,200,0.2);color:#ff7700;"):e.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}}a+=
" \n%c ";e.push("background-color:transparent;color:inherit;");for(d=e.length-1;0<=d;d--)Array.prototype.unshift.call(b,e[d]);Array.prototype.unshift.call(b,a);Array.prototype.push.call(b,"\n\n")};this.log=function(a,e){"function"===typeof b&&b.call(c,a,e);d.zuixNoConsoleOutput||(this.args(c,a,e),h.log.apply(h,e))}}const g="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" ");let h=null,d=null,
b=null;c.prototype.monitor=function(d){b=d};c.prototype.console=function(b){if(b)window.console=h;else for(window.console={},b=0;b<g.length;b++)window.console[g[b]]||(window.console[g[b]]=function(){})};c.prototype.i=c.prototype.info=c.prototype.l=c.prototype.log=function(){this.log("INFO",arguments);return this};c.prototype.w=c.prototype.warn=function(){this.log("WARN",arguments);return this};c.prototype.e=c.prototype.error=function(){this.log("ERROR",arguments);return this};c.prototype.d=c.prototype.debug=
function(){this.log("DEBUG",arguments);return this};c.prototype.t=c.prototype.trace=function(){this.log("TRACE",arguments);return this};q.exports=function(b){return new c(b)}},{}],3:[function(n,q,v){function c(){this.observableList=[]}function g(c){let d="";for(;c&&c.__path__;){const b=c;c=c.__parents__[0];d=null!=c&&null!=c.__path__?"['"+b.__path__+"']."+d:b.__path__+d}return d}c.prototype.observable=function(c){const d=this;let b;var h=this.observableList.filter(function(a){return c===a.proxy||
c===a.target});1===h.length&&(b=h[0]);const a=function(e){const b=[];e.__parents__.forEach(function(e){b.push(...a(e))});b.push(...e.__listeners__);return b};null==b&&(h={context:null,get:function(e,b){let d=e[b];if("undefined"!==typeof d){var c=[],f=this.context.observable(e);if("object"===typeof d){const e=this.context.observable(d);-1===e.__parents__.indexOf(f)&&(e.__parents__.push(f),e.__path__=b);c.push(...a(e));d=e.proxy}else c.push(...a(f));var B=g(f)+b;c.forEach(function(f){f.get(e,b,d,B)});
return d}},set:function(e,b,d){let c=JSON.parse(JSON.stringify(e));e[b]=d;const f=this.context.observable(e),B=g(f)+b;a(f).forEach(function(f){f.set(e,b,d,B,c)});return!0}},Object.assign(h,{context:this}),b=Proxy.revocable(c,h),b.target=c,b.__parents__=[],b.__listeners__=[],b.subscribe=function(a){d.observableList.forEach(function(e){if(e!==b&&-1!==e.__listeners__.indexOf(a))throw Error("Listener already registered.");});b.__listeners__.push(a);return b},b.unsubscribe=function(a){a=b.__listeners__.indexOf(a);
-1!==a&&b.__listeners__.splice(a,1);0===b.__listeners__.length&&(b.revoke(),d.observableList=d.observableList.filter(function(a){if(a===b)return!1;const e=a.__parents__.indexOf(b);return-1!==e&&(a.__parents__.splice(e,1),0===a.__parents__.length&&0===a.__listeners__.length)?(a.unsubscribe(null),!1):!0}));return b},this.observableList.push(b));return b};q.exports=c},{}],4:[function(n,q,v){function c(c){const d=this;d._worker=null;d._taskList=[];d._requests=[];null==c&&(c=function(){});d.taskQueue=
function(b,h,a){d._taskList.push({tid:b,fn:h,status:0,priority:a,step:function(a){g.t(a,"load:step");c(d,"load:step",{task:a})},end:function(){this.status=2;g.t(this.tid,"load:next","timer:task:stop");c(d,"load:next",{task:this.tid});d._taskList.splice(this.index,1);d.taskCheck();null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});g.t(b,"task added",a,"priority");d._taskList.sort(function(a,b){return a.priority>b.priority?1:b.priority>a.priority?-1:0});d.taskCheck()};
d.taskCheck=function(){for(let b=0;b<d._taskList.length;b++){if(0===d._taskList[b].status){d._taskList[b].status=1;g.t(d._taskList[b].tid,"load:begin","timer:task:start");c(d,"load:begin",{task:d._taskList[b].tid});d._taskList[b].index=b;d._taskList[b].fn.call(d._taskList[b]);return}if(1===d._taskList[b].status||2===d._taskList[b].status)return}g.t("load:end");c(d,"load:end")}}const g=n("./Logger")("TaskQueue.js");c.prototype.callback=function(c){};c.prototype.queue=function(c,d,b){return this.taskQueue(c,
d,b)};q.exports=c},{"./Logger":2}],5:[function(n,q,v){q.exports={isIE:function(){return 0<window.navigator.userAgent.indexOf("Trident")},isNoU:function(c){return"undefined"===typeof c||null===c},isFunction:function(c){return"function"===typeof c},objectEquals:function(c,g){if(null===c||void 0===c||null===g||void 0===g)return c===g;if(c.constructor!==g.constructor)return!1;if(c instanceof Function||c instanceof RegExp)return c===g;if(c===g||c.valueOf()===g.valueOf())return!0;if(Array.isArray(c)&&c.length!==
g.length||c instanceof Date||!(c instanceof Object)||!(g instanceof Object))return!1;const h=Object.keys(c);return Object.keys(g).every(function(c){return-1!==h.indexOf(c)})&&h.every(function(d){return util.objectEquals(c[d],g[d])})},propertyFromPath:function(c,g){if("string"===typeof g){g=g.match(/\[(".*?"|'.*?'|(.*?))\]|".*?"|'.*?'|[0-9a-zA-Z_$]+/g);for(let h=0;h<g.length;h++){let d=g[h];d.startsWith("[")&&d.endsWith("]")&&(d=d.substring(1,d.length-1).trim());d.startsWith('"')&&d.endsWith('"')?
d=d.substring(1,d.length-1):d.startsWith("'")&&d.endsWith("'")&&(d=d.substring(1,d.length-1));if("undefined"!==typeof c[d])c=c[d];else return}return c}},cloneObject:function h(g){if(null===g||"object"!==typeof g)return g;let d=g;try{d=g.constructor();for(let b in g)g.hasOwnProperty(b)&&(d[b]=h(g[b]))}catch(b){}return d},hasPassiveEvents:function(){let g=!1;try{const h=Object.defineProperty({},"passive",{get:function(){g=!0}});window.addEventListener("testPassive",null,h);window.removeEventListener("testPassive",
null,h)}catch(h){}return g},dom:{queryAttribute:function(g,h,d){const b=g.split(",");let k="";b.forEach(function(a,e){k=null!=h?k+("["+a+'="'+h+'"]'):k+("["+a+"]");d&&(k+=d.get(e));e<b.length-1&&(k+=",")});return k},getAttribute:function(g,h){let d;"string"===typeof h&&-1!==h.indexOf(",")?h.split(",").filter(function(b,h){b=g.getAttribute(b);null!=b&&(d=b);return null!=d}):d=g.getAttribute(h);return d},setAttribute:function(g,h,d){"string"===typeof h&&-1!==h.indexOf(",")?h.split(",").forEach(function(b){g.setAttribute(b,
d)}):g.setAttribute(h,d)},cssNot:function(g,h){const d=g.split(",");let b="";d.forEach(function(k,a){b=null!=h?b+(":not(["+k+'="'+h+'"])'):b+(":not(["+k+"])");a<d.length-1&&(b+=",")});return function(b){return{get:function(a){const e=b.split(",");return a>=e.length?e[0]:e[a]}}}(b)}}}},{}],6:[function(n,q,v){function c(f){d(this,f.type,f)}function g(f,e,b,d){let B=!1;m.each(z,function(){if(this.element===f&&this.path===e&&this.handler===b)return a.w("Handler already registered",f,e,b),B=!0,!1});B||
(z.push({element:f,path:e,handler:b,opgions:d}),f.addEventListener(e,c,!C||null!=d&&!1===d.passive?!1:{passive:!0}))}function h(f,a,e){let b=1,d=-1;m.each(z,function(c){this.element===f&&this.path===a&&this.handler===e&&(b--,d=c)});-1!==d&&z.splice(d,1);0===b&&f.removeEventListener(a,c)}function d(f,a,e){const b=m(f);m.each(z,function(){this.element===f&&this.path===a&&this.handler.call(b,e,b)})}function b(f){m.each(z,function(){this.element===f&&(a.t("Removing event handler",this.element,this.path,
this.handler),h(this.element,this.path,this.handler))})}function k(f){this._selection=[];"undefined"===typeof f&&(f=document.documentElement);if(f instanceof k)return f;if(f instanceof HTMLCollection||f instanceof NodeList){const a=this._selection=[];m.each(f,function(f,e){a.push(e)})}else if(Array.isArray(f))this._selection=f;else if(f===window||f instanceof HTMLElement||f instanceof Node)this._selection=[f];else if("string"===typeof f)this._selection=document.documentElement.querySelectorAll(f);
else if(null!==f)throw a.e("ZxQuery cannot wrap object of this type.",typeof f,f),Error("ZxQuery cannot wrap object of this type.");return this}const a=n("./Logger")("TaskQueue.js"),e=n("./Util.js");let C=e.hasPassiveEvents();const z=[];k.prototype.length=function(){return this._selection.length};k.prototype.parent=function(f){return e.isNoU(f)?new k(this._selection[0].parentNode):new k(m.getClosest(this._selection[0],f))};k.prototype.children=function(f){return e.isNoU(f)?new k(this._selection[0].children):
new k(this._selection[0].querySelectorAll(f))};k.prototype.reverse=function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};k.prototype.get=function(f){e.isNoU(f)&&(f=0);return this._selection[f]};k.prototype.eq=function(f){const a=this._selection;let e=a[f];1<arguments.length&&(e=[],m.each(arguments,function(f,b){null!=a[b]&&e.push(a[b])}));return new k(e)};k.prototype.find=function(f){return new k(this._selection[0].querySelectorAll(f))};k.prototype.each=function(f){m.each(this._selection,
f);return this};k.prototype.attr=function(f,a){const b=this;if("object"===typeof f)m.each(f,function(f,a){b.each(function(b,d){e.dom.setAttribute(d,f,a)})});else{if("undefined"==typeof a)return e.dom.getAttribute(this._selection[0],f);null===a?this._selection[0].removeAttribute(f):this.each(function(b,d){e.dom.setAttribute(this.get(),f,a)})}return this};k.prototype.trigger=function(f,a){let e;window.CustomEvent?e=new CustomEvent(f,{detail:a}):(e=document.createEvent("CustomEvent"),e.initCustomEvent(f,
!0,!0,a));this.each(function(f,a){a.dispatchEvent(e)});return this};k.prototype.one=function(f,a){let e=!1;this.on(f,function(b,d){e||(e=!0,m(this).off(f,a),a.call(this,b,d,this))});return this};k.prototype.on=function(f,a){const e=f.match(/\S+/g)||[];let b;"function"!==typeof a&&(b=a,a=b.handler);this.each(function(f,d){m.each(e,function(f,e){g(d,e,a,b)})});return this};k.prototype.off=function(f,a){const e=f.match(/\S+/g)||[];this.each(function(f,b){m.each(e,function(f,e){h(b,e,a)})});return this};
k.prototype.reset=function(){this.each(function(f,a){b(a)});return this};k.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};k.prototype.position=function(){return null!=this._selection[0]?m.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};k.prototype.css=function(f,a){const b=this;if("object"===typeof f)m.each(f,function(f,a){b.each(function(e,b){b.style[f]=a})});else{if(e.isNoU(a))return this._selection[0].style[f];b.each(function(e,b){b.style[f]=
a})}return this};k.prototype.addClass=function(f){const a=f.match(/\S+/g)||[];m.each(this._selection,function(e,b){b.classList?m.each(a,function(f,a){b.classList.add(a)}):b.className+=" "+f});return this};k.prototype.hasClass=function(f){return m.hasClass(this._selection[0],f)};k.prototype.removeClass=function(f){const a=f.match(/\S+/g)||[];m.each(this._selection,function(e,b){b.classList?m.each(a,function(a,f){b.classList.remove(f)}):b.className=b.className.replace(new RegExp("(^|\\b)"+f.split(" ").join("|")+
"(\\b|$)","gi")," ")});return this};k.prototype.prev=function(){return new k(this._selection[0].previousElementSibling)};k.prototype.next=function(){return new k(this._selection[0].nextElementSibling)};k.prototype.html=function(a){if(e.isNoU(a))return this._selection[0].innerHTML;this.each(function(f,b){b.innerHTML=a});return this};k.prototype.checked=function(a){if(e.isNoU(a)){const a=this._selection[0].checked;return null!=a&&"false"!=a&&(a||"checked"==a)}this.each(function(f,b){b.checked=a});return this};
k.prototype.value=function(a){if(e.isNoU(a))return this._selection[0].value;this.each(function(f,b){b.value=a});return this};k.prototype.append=function(a){"string"===typeof a?this._selection[0].innerHTML+=a:this._selection[0].appendChild(a);return this};k.prototype.insert=function(a,b){a=this.children().get(a);null!==a?this._selection[0].insertBefore(b,a):this._selection[0].appendChild(b);return this};k.prototype.prepend=function(a){"string"===typeof a?this._selection[0].innerHTML=a+this._selection[0].innerHTML:
this._selection[0].insertBefore(a,this._selection[0].firstElementChild);return this};k.prototype.detach=function(){const f=this._selection[0],b=f.parentNode;null!=b&&(f.__zuix_oldParent=b,f.__zuix_oldIndex=Array.prototype.indexOf.call(b.children,f),b.removeChild(f),a.t("Detached from parent",b,f));return this};k.prototype.attach=function(){const a=this._selection[0];null!=a.parentNode&&null!=a.__zuix_oldParent&&a.parentNode.removeChild(a);null==a.parentNode&&null!=a.__zuix_oldParent&&(m(a.__zuix_oldParent).insert(a.__zuix_oldIndex,
a),a.__zuix_oldParent=null,delete a.__zuix_oldParent,delete a.__zuix_oldIndex);return this};k.prototype.display=function(a){if(e.isNoU(a))return this._selection[0].style.display;m.each(this._selection,function(b,f){f.style.display=a});return this};k.prototype.visibility=function(a){if(e.isNoU(a))return this._selection[0].style.visibility;m.each(this._selection,function(b,f){f.style.visibility=a});return this};k.prototype.show=function(a){return this.display(null==a?"":a)};k.prototype.hide=function(){return this.display("none")};
const m=function(a){return new k(a)};m.find=function(a){return m().find(a)};m.each=function(a,b){const f=null==a?0:Object.keys(a).length;if(0<f){let e=0;for(let d in a)if(a.hasOwnProperty(d)){let c=a[d];c instanceof Element&&(c=m(c));if(!1===b.call(c,d,a[d],c))break;e++;if(e>=f)break}}return this};m.ajax=function(a){let b;b=e.isNoU(a)||e.isNoU(a.url)?a:a.url;const f=new XMLHttpRequest;f.onload=function(){200===f.status?e.isFunction(a.success)&&a.success(f.responseText):e.isFunction(a.error)&&a.error(f,
f.statusText,f.status);e.isFunction(a.then)&&a.then(f)};f.onerror=function(b,f,d){e.isFunction(a.error)&&a.error(b,f,d)};"function"==typeof a.beforeSend&&a.beforeSend(f);try{f.open("GET",b),f.send()}catch(J){e.isFunction(a.error)&&a.error(f,f.statusText,f.status,J)}return this};m.hasClass=function(a,b){b=b.match(/\S+/g)||[];let e=!1;m.each(b,function(b,f){if(e=a.classList?a.classList.contains(f):(new RegExp("(^| )"+f+"( |$)","gi")).test(a.className))return!1});return e};m.classExists=function(a){a=
a.match(/\S+/g)||[];let b=!1;m.each(a,function(a,e){a=document.styleSheets;if(null!=a)for(let f=0;f<a.length;f++)try{const d=a[f].rules||a[f].cssRules;if(null!=d)for(let a=0;a<d.length;a++)if(d[a].selectorText===e){b=!0;break}}catch(p){if("SecurityError"!==p.name&&"InvalidAccessError"!==p.name)throw p;}});return b};m.wrapElement=function(a,b){a=document.createElement(a);"string"===typeof b?a.innerHTML=b:a.appendChild(b);return a};m.wrapCss=function(b,e){const f=/(([a-zA-Z0-9\240-\377=:-_\n,.@]+.*){([^{}]|((.*){([^}]+)[}]))*})/g;
let d="",c;e=e.replace(/\/\*[\s\S]*?\*\/|([^:]|^)\/\/.*$/g,"");do if((c=f.exec(e))&&1<c.length){var h=c[2];if(null!=h&&0<h.length){h=h.replace(/\n/g,"");const a=h.split(",");let e=!1;m.each(a,function(f,c){"."===c.replace(" ","")?d+="\n"+b+" ":"@"===c.trim()[0]?(d+=c+" ",c.trim().toLowerCase().startsWith("@media")&&(e=!0)):d+="\n"+b+"\n"+c+" ";f<a.length-1&&(d+=", ")});e?(h=m.wrapCss(b,c[1].substring(c[2].length).replace(/^{([^\0]*?)}$/,"$1")),d+="{\n  "+h+"\n}"):d+=c[1].substring(c[2].length)+"\n"}else a.w("z$.wrapCss was unable to parse rule.",
h,c)}while(c);""!==d&&(e=d);return e};m.appendCss=function(a,b,d){const f=document.head||document.getElementsByTagName("head")[0];let c=null;e.isNoU(b)?(b=document.getElementById(d),null!=b&&f.removeChild(b)):f.removeChild(b);"string"===typeof a?(c=document.createElement("style"),c.type="text/css",c.id=d,c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a))):a instanceof Element&&(c=a);e.isNoU(c)||f.appendChild(c);return c};m.replaceCssVars=function(a,b){const e=new RegExp(/\B\$var\[(.*[^\[\]])]/g);
let f="",c=0,d=0,h;for(;h=e.exec(a);){let e=h[0];if(1<h.length){var g=h[1];let a=b;if(0<g.indexOf(".")){g=g.split(".");for(let b=0;b<g.length-1&&(a=a[g[b]],"undefined"!==typeof a);b++);"undefined"!==typeof a&&(e=a[g[g.length-1]],c++)}else"undefined"!==typeof a[g]&&(e=a[g],c++)}f+=a.substr(d,h.index-d)+e;d=h.index+h[0].length}0<c&&(a=f+=a.substr(d));return a};m.replaceBraces=function(a,b){const f=new RegExp(/{?{.*?}?}/g);let c="",d=0,h=0;for(var g;g=f.exec(a);){if("string"===typeof g[0]&&(0===g[0].trim().length||
0<=g[0].indexOf("\n"))){g=a.substr(h,g.index-h)+g[0];c+=g;h+=g.length;continue}let f=g[0];if("function"===typeof b){const a=b(g[0]);e.isNoU(a)||(f=a,d++)}c+=a.substr(h,g.index-h)+f;h=g.index+g[0].length}return 0<d?c+=a.substr(h):null};m.getClosest=function(a,b){for(;a&&a!==document;a=a.parentNode)if(a.matches(b))return a;return null};m.getPosition=function(a,b){var e;{var c=e=0,d=a.getBoundingClientRect();let b=a;for(;b;){if("body"===b.tagName.toLowerCase()){const a=b.scrollTop||document.documentElement.scrollTop;
e+=b.offsetLeft-(b.scrollLeft||document.documentElement.scrollLeft)+b.clientLeft;c+=b.offsetTop-a+b.clientTop}else e+=b.offsetLeft-b.scrollLeft+b.clientLeft,c+=b.offsetTop-b.scrollTop+b.clientTop;b=b.offsetParent}e={x:e,y:c,rect:d}}e.visible=!1;d=a.offsetParent;if(null!=d){if(d!==document.body){for(c=d.offsetParent;null!=c&&null!==c.offsetParent&&c.offsetHeight===c.scrollHeight;)c=c.offsetParent;null!=c&&(d=c)}c=d.getBoundingClientRect();d===document.body&&(c={x:c.x,y:c.y,width:document.documentElement.offsetWidth||
document.documentElement.clientWidth,height:document.documentElement.offsetHeight||document.documentElement.clientHeight,top:0,left:0,right:document.documentElement.clientWidth||document.documentElement.offsetWidth,bottom:document.documentElement.clientHeight||document.documentElement.offsetHeight});null==b&&(b=0);d=a.getBoundingClientRect();b=!(d.left-1>c.right-b||d.right+1<c.left+b||d.top-1>c.bottom-b||d.bottom+1<c.top+b);e.visible=b;e.frame={dx:(d.left+d.width/2-c.left)/c.width,dy:(d.top+d.height/
2-c.top)/c.height};a=m(a);!b&&a.hasClass("--ui--visible")?(a.removeClass("--ui--visible"),e.event="exit"):b?b&&(a.hasClass("--ui--visible")?e.event="scroll":(e.event="enter",a.addClass("--ui--visible"))):e.event="off-scroll"}return e};m.ZxQuery=k;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=
(this.document||this.ownerDocument).querySelectorAll(a);let b=a.length;for(;0<=--b&&a.item(b)!==this;);return-1<b});(function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};const e=document.createEvent("CustomEvent");e.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return e}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();String.prototype.hashCode=function(){let a=0;if(0===this.length)return a;for(let b=0;b<this.length;b++){let e=
this.charCodeAt(b);a=(a<<5)-a+e;a|=0}return a};String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return this.substr(!b||0>b?0:+b,a.length)===a});q.exports=m},{"./Logger":2,"./Util.js":5}],7:[function(n,q,v){n=n("./zuix/Zuix.js");"object"===typeof q&&q.exports?q.exports=n.call(this):this.zuix=n.call(this)},{"./zuix/Zuix.js":13}],8:[function(n,q,v){q.exports=function(c){return null}},{}],9:[function(n,q,v){function c(a,e,c){k=a;this._options=null;this.contextId=null==e||null==
e.contextId?null:e.contextId;this.componentId=null;this.trigger=function(a,b,e){"function"===typeof c&&c(a,b,e)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this._modelListener=Object.assign({context:null,get:function(a,b,e,c){},set:function(a,e,c,g,k){const f=d(this.context.view());if(f.get()){let d=f.find(b.dom.queryAttribute(h.dataBindTo,g));null==d.get()&&(d=f.find(b.dom.queryAttribute(h.dataUiField,
g)));d.get()&&this.context.dataBind(d.get(),c);this.context._c&&"function"===typeof this.context._c.update&&this.context._c.update(a,e,c,g,k)}}},{context:this});this.options(e);return this}const g=n("../helpers/Logger")("ComponentContext.js"),h=n("./OptionAttributes"),d=n("../helpers/ZxQuery"),b=n("../helpers/Util");let k=null;c.prototype.container=function(a){if(null==a)return this._container;a instanceof d.ZxQuery&&(a=a.get());this._container=a;return this};c.prototype.view=function(a){if("undefined"===
typeof a)return this._view;a instanceof d.ZxQuery&&(a=a.get());g.t(this.componentId,"view:attach","timer:view:start");if("string"===typeof a){a={content:a};this.trigger(this,"html:parse",a);a=a.content;const e=d.wrapElement("div",a);null!=e.firstElementChild&&(null!=b.dom.getAttribute(e.firstElementChild,h.dataUiView)?1===e.children.length&&(a=e.firstElementChild.innerHTML):a=e.innerHTML);null!=this._container?(this._view=this._container,this._view.innerHTML+=a):null!=this._view?this._view.innerHTML=
a:this._view=e;d(this._view).find("script").each(function(a,b){"true"!==this.attr(h.zuixLoaded)&&(this.attr(h.zuixLoaded,"true"),eval.call(window,b.innerHTML))});this.trigger(this,"view:process",d(this._view))}else a instanceof d.ZxQuery&&(a=a.get()),null!=this._container?(this._view=d.wrapElement("div",a.outerHTML).firstElementChild,this._view.removeAttribute(h.dataUiView),this._container.appendChild(this._view),this._view=this._container):this._view=a;a=d(this._view);!1===this._options.css?a.addClass("zuix-css-ignore"):
a.removeClass("zuix-css-ignore");a.find(b.dom.queryAttribute(h.dataUiLoad)).each(function(a,b){this.attr(h.dataUiLoaded,"false")});this.modelToView();g.t(this.componentId,"view:attach","timer:view:stop");return this};c.prototype.style=function(a){if("undefined"===typeof a)return this._style;g.t(this.componentId,"view:style","timer:view:start");null==a||a instanceof Element?(this._css=a instanceof Element?a.innerText:a,this._style=d.appendCss(a,this._style,this.componentId)):"string"===typeof a&&(this._css=
a,a={content:a},this.trigger(this,"css:parse",a),a=a.content,a=d.wrapCss("["+h.dataUiComponent+'="'+this.componentId+'"]:not(.zuix-css-ignore)',a),this._style=d.appendCss(a,this._style,this.componentId));g.t(this.componentId,"view:style","timer:view:stop");return this};c.prototype.model=function(a){if("undefined"===typeof a)return this._model;if(this._model===a)return this;null!==this._model&&"function"!==typeof this._model&&k.observable(this._model).unsubscribe(this._modelListener);this._model=a;
null!=a&&("function"!==typeof a&&(this._model=k.observable(a).subscribe(this._modelListener).proxy),this.modelToView(),null!=this._c&&b.isFunction(this._c.update)&&this._c.update.call(this._c,null,null,null,null,this._c));return this};c.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};c.prototype.options=function(a){if(null==a)return this._options;const b=this._options=this._options||{};Object.assign(b,a);this.componentId=b.componentId||
this.componentId;this.container(b.container);this.view(b.view);"undefined"!==typeof b.css&&this.style(b.css);this.controller(b.controller);this.model(b.model);return this};c.prototype.on=function(a,b){this._c.on(a,b);return this};c.prototype.loadCss=function(a,e){const c=this;b.isNoU(a)&&(a={});b.isNoU(a.caching)||(e=a.caching);let h=c.componentId+".css";b.isNoU(a.path)||(h=a.path);e||(h+="?"+(new Date).getTime());d.ajax({url:k.getResourcePath(h),success:function(e){c.style(e);b.isFunction(a.success)&&
a.success.call(c,e,c)},error:function(e){g.e(e,c);b.isFunction(a.error)&&a.error.call(c,e,c)},then:function(){b.isFunction(a.then)&&a.then.call(c,c)}});return this};c.prototype.loadHtml=function(a,e){const c=this;let n=c.componentId;b.isNoU(a)&&(a={});b.isNoU(a.caching)||(e=a.caching);b.isNoU(a.path)||(n=a.path);var m=k.store("zuix.inlineViews");null==m&&(m=[],k.store("zuix.inlineViews",m));if(null!=m[n])c.view(m[n]),b.isFunction(a.success)&&a.success.call(c,m[n],c),b.isFunction(a.then)&&a.then.call(c,
c);else{const f=d().find(b.dom.queryAttribute(h.dataUiView,n,b.dom.cssNot(h.dataUiComponent,0)));0<f.length()?(e=f.get(0),m[n]=e.innerHTML,c.view()===e||null!=c.container()&&c.container().contains(e)?(f.attr(h.dataUiView,null),c._view=e,this.trigger(this,"view:process",d(c.view()))):c.view(e.innerHTML),b.isFunction(a.success)&&a.success.call(c,e.innerHTML,c),b.isFunction(a.then)&&a.then.call(c,c)):(m=b.isNoU(a.cext)?".html":a.cext,n==c.componentId&&(n+=m+(e?"":"?"+(new Date).getTime())),d.ajax({url:k.getResourcePath(n),
success:function(e){c.view(e);b.isFunction(a.success)&&a.success.call(c,e,c)},error:function(e){g.e(e,c);b.isFunction(a.error)&&a.error.call(c,e,c)},then:function(){b.isFunction(a.then)&&a.then.call(c,c)}}))}return this};c.prototype.viewToModel=function(){g.t(this.componentId,"view:model","timer:vm:start");const a=this;this._model={};d(this._view).find(b.dom.queryAttribute(h.dataUiField)).each(function(c,d){if(0<this.parent("pre,code").length())return!0;c=this.attr(h.dataUiField);d=!b.isNoU(d.innerHTML)&&
b.isIE()?d.cloneNode(!0):d;if(0<c.indexOf(".")){c=c.split(".");let b=a._model;for(let a=0;a<c.length-1;a++)"undefined"===typeof b[c[a]]&&(b[c[a]]={}),b=b[c[a]];b[c[c.length-1]]=d}else a._model[c]=d});g.t(this.componentId,"view:model","timer:vm:stop");return this};c.prototype.dataBind=function(a,c){switch(a.tagName.toLowerCase()){case "img":a.src=b.isNoU(c.src)?b.isNoU(c.innerHTML)?c:c.innerHTML:c.src;c.alt&&(a.alt=c.alt);break;case "a":a.href=b.isNoU(c.href)?b.isNoU(c.innerHTML)?c:c.innerHTML:c.getAttribute("href");
c.title&&(a.title=c.title);b.isNoU(c.href)||b.isNoU(c.innerHTML)||""===c.innerHTML.trim()||(a.innerHTML=c.innerHTML);break;case "input":a.value=b.isNoU(c.value)?b.isNoU(c.innerHTML)?c:c.innerHTML:c.value;break;default:if(a.innerHTML=b.isNoU(c.innerHTML)?c:c.innerHTML,null!=c.attributes)for(let d=0;d<c.attributes.length;d++){const e=c.attributes[d];e.specified&&e.name!==h.dataUiField&&("+"===e.value[0]&&a.hasAttribute(e.name)&&(e.value=a.getAttribute(e.name)+" "+e.value.substring(1)),b.dom.setAttribute(a,
e.name,e.value))}}};c.prototype.modelToView=function(){g.t(this.componentId,"model:view","timer:mv:start");if(null!=this._view&&null!=this._model){const a=this;d(this._view).find(b.dom.queryAttribute(h.dataUiField)).each(function(c,g){if(0<this.parent("pre,code").length())return!0;c=this.attr(h.dataBindTo);null==c&&(c=this.attr(h.dataUiField));const e=d(a._view);if("function"===typeof a._model)a._model.call(e,this,c,e);else{const d=b.propertyFromPath(a._model,c);"function"===typeof d?d.call(e,this,
c,e):null!=d&&a.dataBind(g,d)}})}g.t(this.componentId,"model:view","timer:mv:stop");return this};q.exports=c},{"../helpers/Logger":2,"../helpers/Util":5,"../helpers/ZxQuery":6,"./OptionAttributes":12}],10:[function(n,q,v){function c(){}function g(a,b){null!=a&&(H=!a);null!=b&&(K=b);return!D&&!H}function h(a){null==a&&(a=document);F.indexOf(a)||F.push(a)}function d(a){for(let b=0;b<y.length;b++){const c=y[b];if(c.element===a)return c.waiting}return null}function b(a){null==a&&0<F.length&&(a=F.unshift());
a instanceof t.ZxQuery&&(a=a.get());d(a);var b=l.dom.queryAttribute(r.dataUiLoad,null,l.dom.cssNot(r.dataUiLoaded))+","+l.dom.queryAttribute(r.dataUiInclude,null,l.dom.cssNot(r.dataUiLoaded));b=t(a).find(b);b=Array.prototype.slice.call(b._selection);y.push({element:a,waiting:b});a=[];for(var c=0;c<b.length;c++){var e=b[c],f=+l.dom.getAttribute(e,r.dataUiPriority);isNaN(f)&&(f=0);let d=0;var u=e.parentNode;let h=!1;for(;null!=u&&u!==document;){d++;if(null!=l.dom.getAttribute(u,r.dataUiView)){h=!0;
break}u=u.parentNode}h||(u=new A,u.element=e,u.priority=f+1E3*d,a.push(u))}b=0;for(c=0;c<a.length;c++){e=!1;for(f=0;f<x.length;f++)if(a[c].element===x[f].element){e=!0;break}e||(e=a[c].element,f=l.dom.getAttribute(e,r.dataUiOptions),z(e,f),x.push(a[c]),b++)}p.t("componentize:count",x.length,b);(0===b||0===F.length&&0===x.length)&&E.trigger(this,"componentize:end")}function k(){x.sort(function(a,b){return a.priority-b.priority});let a=null,b=0<x.length?x.shift():null;for(;null!=b&&null!=b.element;){const c=
J(b.element);g()&&c?(b.lazy=!0,b.visible=t.getPosition(b.element,K).visible):(b.lazy=!1,b.visible=!0);if(null!=b.element&&b.visible){a={item:b,cancelable:b.lazy};break}if(0<x.length)b=x.shift();else break}return a}function a(a){b(a);a=k();null!=a&&L.append([a])}function e(b){var c=t(b);if(null!=c.attr(r.dataUiLoaded)||0<c.parent("pre,code").length())return!1;c.attr(r.dataUiLoaded,"true");let e=c.attr(r.dataUiOptions);l.isNoU(e)?e={}:(e=l.propertyFromPath(window,e),e=l.cloneObject(e)||{});var d=c.attr(r.dataUiContext);
if(!l.isNoU(d)){var f=E.context(d);null!==f&&(e=f.options());e.contextId=d}l.isNoU(e.view)&&!c.isEmpty()?(e.view=b,e.viewDeferred=!0):l.isNoU(e.view)&&l.isNoU(e.container)&&c.isEmpty()&&(e.container=b);d=c.attr(r.dataUiLoad);if(l.isNoU(d))if(d=c.attr(r.dataUiInclude),null!=d)d=C(d),c.attr(r.dataUiInclude,d),c.attr(r.dataUiComponent,d),l.isNoU(e.controller)&&(e.controller=function(){});else return!1;else d=C(d),c.attr(r.dataUiLoad,d);f=c.attr(r.dataBindModel);!l.isNoU(f)&&0<f.length&&(e.model=l.propertyFromPath(window,
f));c=c.attr(r.dataUiPriority);l.isNoU(c)||(e.priority=+c);t(b).one("component:ready",function(){h(b);a(b)});E.load(d,e);return!0}function C(a){if("@"===a[0]){let b=E.store("config"),c="https://zuixjs.github.io/zkit/lib/";null!=b&&null!=b[location.host]&&(b=b[location.host]);if(null!=b)switch(typeof b.libraryPath){case "object":t.each(b.libraryPath,function(b,e){return a.startsWith(b+"/")?(c=e,!1):!0});break;case "string":c=b.libraryPath}a=c+a.substring(a.indexOf("/")+1)}return a}function z(a,b){"string"===
typeof b&&(b=l.propertyFromPath(window,b));null!=a&&null!=b&&(null!=b.lazyLoad&&l.dom.setAttribute(a,r.dataUiLazyload,b.lazyLoad.toString().toLowerCase()),null!=b.contextId&&l.dom.setAttribute(a,r.dataUiContext,b.contextId.toString().toLowerCase()),null!=b.componentId&&l.dom.setAttribute(a,r.dataUiLoad,b.componentId.toString().toLowerCase()))}function m(a){for(let b=0;b<N.length;b++){const c=N[b];if(c.element===a)return c}return null}function f(a){a={element:a};N.push(a);return a}function B(a){for(let b=
0;b<w.length;b++){const c=w[b];if(c.element===a)return c}return null}function M(a){a={element:a};w.push(a);return a}function J(b){if("false"===l.dom.getAttribute(b,r.dataUiLazyload))return!1;let c=m(b);if(null==c){var e=l.dom.queryAttribute(r.dataUiLazyload,"scroll")+","+l.dom.queryAttribute(r.dataUiLazyload,"true");e=t.getClosest(b.parentNode,e);if(null!=e)return c=f(b),b=B(e),null==b&&(b=M(e),"scroll"===l.dom.getAttribute(e,r.dataUiLazyload)&&function(b,c){let u=(new Date).getTime();t(c===document.body?
window:c).on("scroll",function(){const b=(new Date).getTime();100<b-u&&(u=b,a(c))})}(this,e)),!0;if("true"===l.dom.getAttribute(b,r.dataUiLazyload))return c=f(b),!0}else return!0;return!1}const r=n("./OptionAttributes");c.prototype.componentize=function(b,c){E.trigger(this,"componentize:begin");if(null!=c){const a=d(b);null==a?y.push({element:b,waiting:[c]}):a.push(c)}else h(b);a(b);return this};c.prototype.applyOptions=function(a,b){z(a,b);return this};c.prototype.resolvePath=function(a){return C(a)};
c.prototype.willLoadMore=function(){return 0<x.length||0<F.length};c.prototype.lazyLoad=function(a,b){return g(a,b)};c.prototype.dequeue=function(a){for(let b=0;b<x.length;b++)if(x[b].element===a){x.splice(b,1);break}};c.prototype.setHost=function(a){E=a;return this};q.exports=function(){return new c};const p=n("../helpers/Logger")("ComponentContext.js"),l=n("../helpers/Util"),t=n("../helpers/ZxQuery"),F=[],x=[],N=[],w=[],A=function(){return{element:null,priority:0,visible:!0,lazy:!1}},L=n("./../helpers/AsynChain")({doWork:function(a,
b){t(a.element).one("component:ready",function(){b()});return e(a.element)},willBreak:function(){return!1},status:function(b){switch(b){case "done":a()}}});let H=!1,K=1,E=null,D=!1;navigator&&navigator.userAgent&&(D=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));D&&p.d(navigator.userAgent,"is a bot, ignoring `lazy-loading` option.");const y=[]},{"../helpers/Logger":2,"../helpers/Util":5,"../helpers/ZxQuery":6,"./../helpers/AsynChain":1,"./OptionAttributes":12}],
11:[function(n,q,v){function c(c){const d=this;this._view=null;this.context=c;this._fieldCache=[];this.destroy=this.update=this.create=this.init=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,b){d._childNodes.push(b)})};this.restoreView=function(){0<this._childNodes.length&&(d.view().html(""),g.each(d._childNodes,function(a,b){d.view().append(b)}),this._childNodes.length=0)};this.on=function(a,b){this.addEvent(a,b);return this};this.mapEvent=
function(a,b,c,d){null!=b&&(b.off(c,this.eventRouter),a[c]=d,b.on(c,this.eventRouter))};this.eventRouter=function(a){const b=d.view();"function"===typeof c._behaviorMap[a.type]&&c._behaviorMap[a.type].call(b,a,a.detail,b);"function"===typeof c._eventMap[a.type]&&c._eventMap[a.type].call(b,a,a.detail,b)};const b=c.options();let h=null;if(null!=b.on)for(let a in b.on)b.on.hasOwnProperty(a)&&(h=b.on[a],d.addEvent(a,h));if(null!=b.behavior)for(let a in b.behavior)b.behavior.hasOwnProperty(a)&&(h=b.behavior[a],
d.addBehavior(a,h));c.controller().call(this,this);return this}const g=n("../helpers/ZxQuery");c.prototype.addEvent=function(c,d){this.mapEvent(this.context._eventMap,this.view(),c,d);return this};c.prototype.addBehavior=function(c,d){this.mapEvent(this.context._behaviorMap,this.view(),c,d);return this};c.prototype.field=function(c){return null};c.prototype.clearCache=function(){this._fieldCache.length=0};c.prototype.view=function(c){if(null!=this.context.view()||this._view!==this.context.view())this.clearCache(),
this._view=g(this.context.view());if(null!=c)return this._view.find(c);if(null!==this._view)return this._view;throw Error("Not attached to a view yet.");};c.prototype.model=function(c){if(null==c)return this.context.model();this.context.model(c);return this};c.prototype.options=function(){return this.context.options()};c.prototype.trigger=function(c,d,b){null==this.context._eventMap[c]&&!0!==b&&this.addEvent(c,null);!0===b?(b=this.context.container(),null==b&&(b=this.context.view()),null!=b&&g(b).trigger(c,
d),this.context.trigger(this.context,c,d)):this.view().trigger(c,d);return this};c.prototype.expose=function(c,d){if("object"===typeof c){const b=this;g.each(c,function(c,a){b.context[c]=a})}else this.context[c]=d;return this};c.prototype.loadCss=function(c){this.context.loadCss(c);return this};c.prototype.loadHtml=function(c){this.saveView();this.context.loadHtml(c);return this};c.prototype.log={};c.prototype.for=function(c){return this};q.exports=c},{"../helpers/ZxQuery":6}],12:[function(n,q,v){n=
Object.freeze({dataBindModel:"data-bind-model",dataBindTo:"data-bind-to",dataUiComponent:"z-component",dataUiContext:"data-ui-context,z-context",dataUiField:"data-ui-field,z-field",dataUiInclude:"data-ui-include,z-include",dataUiLazyload:"data-ui-lazyload,z-lazy",dataUiLoad:"data-ui-load,z-load",dataUiLoaded:"z-loaded",dataUiOptions:"data-ui-options,z-options",dataUiPriority:"data-ui-priority,z-priority",dataUiView:"data-ui-view,z-view",zuixLoaded:"zuix-loaded"});q.exports=n},{}],13:[function(n,q,
v){function c(){w.setHost(this);this._store=[];this._fieldCache=[];return this}function g(a){"function"!==typeof a["for"]&&(a["for"]=function(b){return K[b]=a});return a}function h(a,b,c){l.isNoU(c)&&(c=this);null==c._fieldCache&&(c._fieldCache={});let u=null;"undefined"===typeof c._fieldCache[a]?(u=t(b).find(l.dom.queryAttribute(A.dataUiField,a)),null!=u&&0<u.length()&&(c._fieldCache[a]=u,1===u.length()&&l.isNoU(u.field)&&(u.field=function(a){return h(a,u,u)}))):u=c._fieldCache[a];return u}function d(a){let b=
zuix.store("config");null!=b&&null!=b[location.host]&&(b=b[location.host]);a=w.resolvePath(a);!a.startsWith("//")&&0>a.indexOf("://")&&(a=(null!=b&&null!=b.resourcePath?b.resourcePath:"")+a);return a}function b(a,b){let c=m(a.componentId);null!==c&&null==b.controller&&null==a.controller()&&(a.controller(c.controller),p.t(a.componentId+":js","component:cached:js"));if(l.isNoU(b.view)){if(null!==c&&(null!=c.view&&(a.view(c.view),p.t(a.componentId+":html","component:cached:html")),!1!==b.css&&(b.css=
!1,c.css_applied||(c.css_applied=!0,a.style(c.css),p.t(a.componentId+":css","component:cached:css")))),l.isNoU(a.view()))return O("resource-loader").queue(a.componentId+":html",function(){y[a.componentId]=this;a.loadHtml({cext:b.cext,caching:I,success:function(d){null==c&&(c=B(a));c.view=d;delete c.controller;!1!==b.css?(y[a.componentId].step(a.componentId+":css"),a.loadCss({caching:I,success:function(a){c.css=a},error:function(b){p.e(b,a)},then:function(){f(a,y[a.componentId])}})):f(a,y[a.componentId])},
error:function(c){p.e(c,a);l.isFunction(b.error)&&a.error.call(a,c,a)}})},b.priority),a}else a.view(b.view);null==a.controller()?O("resource-loader").queue(a.componentId+":js",function(){y[a.componentId]=this;f(a,y[a.componentId])},L.length):f(a);return a}function k(a){if(a instanceof Element){const b=a;a=zuix.context(b);w.dequeue(b)}l.isNoU(a)||(l.isNoU(a._c)||(l.isNoU(a._c.view())||(a._c.view().attr(A.dataUiComponent,null),a._c.view().reset(),l.isNoU(a._c._fieldCache)||t.each(a._c._fieldCache,function(a,
b){b.reset()}),a.model(null),a._c.view().detach()),l.isFunction(a._c.destroy)&&a._c.destroy.call(a,a)),a=a.container(),null!=a&&null!=a.parentNode&&a.parentNode.removeChild(a))}function a(a){a=new x(zuix,a,C);L.push(a);return a}function e(a,b){let c=null;if(a instanceof t.ZxQuery)a=a.get();else if("string"===typeof a){const b=t.find(l.dom.queryAttribute(A.dataUiContext,a));0<b.length()&&(a=b.get())}t.each(L,function(b,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||l.objectEquals(d.contextId,
a))return c=d,!1});if("function"===typeof b&&(a instanceof Element||a instanceof t.ZxQuery))if(null!=c&&c.isReady)b.call(c,c);else t(a).one("component:ready",function(){c=zuix.context(this);b.call(c,c)});return c}function C(a,b,c){l.isFunction(H[b])&&H[b].call(a,c,a)}function z(a){null!=a&&(I=a);return I}function m(a){let b=null;t.each(G,function(c,d){if(l.objectEquals(d.componentId,a))return b=d,!1});return b}function f(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(p.d(a.componentId,
"controller:load"),l.isNoU(b)||b.step(a.componentId+":js"),l.isFunction(K[a.componentId]))a.controller(K[a.componentId]),M(a,b);else{const c=function(b){const c=a.componentId+".js"+(I?"":"?"+(new Date).getTime());t.ajax({url:d(c),success:function(b){try{const c=b.indexOf("function"),d=b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-4));const e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+11));const f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+
'.js"\n';a.controller(r(b))}catch(Q){p.e(Error(),Q,b,a),l.isFunction(a.error)&&a.error.call(a,Q,a)}},error:function(b){p.e(b,Error(),a);l.isFunction(a.error)&&a.error.call(a,b,a)},then:function(){M(a,b)}})};l.isNoU(b)?O("resource-loader").queue(a.componentId+":js",function(){c(y[a.componentId]=this)},a.options().priority):c(b)}else M(a,b)}function B(a){var b=a.view().innerHTML;b=t.wrapElement("div",b);b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};G.push(b);p.t(a.componentId,
"bundle:added");return b}function M(a,b){y[a.componentId]=null;if(l.isNoU(a.view()))p.e(a.componentId,"component:view:undefined");else{let d=m(a.componentId);a.options().viewDeferred?p.w(a.componentId,"component:deferred:load"):null===d?d=B(a):null==d.controller&&(d.controller=a.controller());null!=b&&b.callback(function(){p.d(a.componentId,"controller:create:deferred");J(a._c)});var c=t(a.view());null==c.attr(A.dataUiContext)&&c.attr(A.dataUiContext,a.contextId);p.d(a.componentId,"component:initializing");
if(l.isFunction(a.controller())){c=a._c=new N(a);c.log=n("../helpers/Logger")(a.contextId);"function"===typeof c.init&&c.init();if(!l.isNoU(c.view()))if(null==c.view().attr(A.dataUiComponent)&&c.view().attr(A.dataUiComponent,a.componentId),l.isNoU(a.model())&&!l.isNoU(a.view())&&a.viewToModel(),c.trigger("view:apply"),a.options().viewDeferred){a.options().viewDeferred=!1;c.saveView();null===d&&(d={componentId:a.componentId,controller:a.controller()},G.push(d),p.t(a.componentId,"bundle:added"),p.d(a.componentId,
"component:deferred:load"));let e=-1;!1!==a.options().css&&(null==d.css?(-1===e&&(e=0),e++,a.loadCss({caching:I,success:function(b){null==d.css&&(d.css=b);p.d(a.componentId,"component:deferred:css",e)},then:function(){0===--e&&null!=b&&b.end()}})):a.style(d.css));!1!==a.options().html&&(null==d.view?(-1===e&&(e=0),e++,a.loadHtml({cext:a.options().cext,caching:I,success:function(b){null==d.view&&(d.view=b);p.d(a.componentId,"component:deferred:html",e)},error:function(b){p.e(b,a);l.isFunction(a.options().error)&&
a.options().error.call(a,b,a)},then:function(){0===--e&&null!=b&&b.end()}})):a.view(d.view));-1===e&&null!=b&&b.end()}else null!=b&&b.end();null==b&&(p.d(a.componentId,"controller:create"),J(c))}else p.w(a.componentId,"component:controller:undefined")}}function J(a){p.t(a.context.componentId,"controller:init","timer:init:start");a.view().find(l.dom.queryAttribute(A.dataUiLoaded,"false",l.dom.cssNot(A.dataUiComponent))).each(function(a,b){this.attr(A.dataUiLoaded,null)});a.field=function(b){b=h(b,
a.view(),a);b.on=function(b,c,d,e){if("string"===typeof c){const b=c;c=function(){a.trigger(b,d,e)}}return t.ZxQuery.prototype.on.call(this,b,c)};return b};l.isFunction(a.create)&&a.create();a.trigger("view:create");l.isFunction(a.context.ready)&&a.context.ready.call(a.context,a.context);a.trigger("component:ready",a.view(),!0);a.context.isReady=!0;p.t(a.context.componentId,"controller:init","timer:init:stop");p.i(a.context.componentId,"component:loaded",a.context.contextId);if(null!=D[a.context.componentId]){const c=
D[a.context.componentId];D[a.context.componentId]=null;let d;for(;null!=c&&null!=(d=c.shift());)b(d.c,d.o)}zuix.componentize(a.view())}function r(a){let b=function(a){};if("string"===typeof a)try{b=eval.call(this,a)}catch(S){p.e(this,S,a)}return b}const p=n("../helpers/Logger")("Zuix.js"),l=n("../helpers/Util"),t=n("../helpers/ZxQuery"),F=n("../helpers/TaskQueue");v=n("../helpers/ObjectObserver");const x=n("./ComponentContext"),N=n("./ContextController"),w=n("./Componentizer")(),A=n("./OptionAttributes");
n("./ComponentCache");const L=[],H=[],K={},E=[],D={},y=[],O=function(a){l.isNoU(E[a])&&(E[a]=new F(function(a,b,c){C(a,b,c)}));return E[a]};let G=[],P=0,I=!0;const R=new v;c.prototype.field=function(a,b){return h.call(this,a,b)};c.prototype.load=function(c,d){{c=w.resolvePath(c);let f;l.isNoU(d)?(d={},f=new x(zuix,d,C)):(d.componentId=c,l.isNoU(d.contextId)?(!1===d&&(d={}),d.contextId="zuix-ctx-"+ ++P,f=a(d)):(f=e(d.contextId),null!==f?f.options(d):f=a(d)));f.componentId!=c&&(f.componentId=c);l.isFunction(d.ready)&&
(f.ready=d.ready);l.isFunction(d.error)&&(f.error=d.error);null==y[c]?(y[c]=!0,d=b(f,d)):(null==D[c]&&(D[c]=[]),D[c].push({c:f,o:d}),d=f)}return d};c.prototype.unload=function(a){k(a);return this};c.prototype.controller=function(a){return g.call(this,a)};c.prototype.context=function(a,b){return e.call(this,a,b)};c.prototype.createComponent=function(b,c){null==c&&(c={});l.isNoU(c.contextId)&&(c.contextId="zuix-ctx-"+ ++P);if(null!=e(c.contextId))throw Error("Context arelady exists.");c.container=document.createElement("div");
c.componentId=b;w.applyOptions(c.container,c);return a(c)};c.prototype.trigger=function(a,b,c){C(a,b,c);return this};c.prototype.hook=function(a,b){l.isNoU(b)?delete H[a]:H[a]=b;return this};c.prototype.using=function(a,b,c){b=w.resolvePath(b);a=a.toLowerCase();const d=a+"-"+b.hashCode();if("component"===a)a=e(d),null==a?zuix.load(b,{contextId:d,view:"",priority:-10,ready:function(a){"function"===typeof c&&c(b,a)},error:function(){c(b,null)}}):"function"===typeof c&&c(b,a);else{const e="style"===
a;if(0===t.find(a+'[id="'+d+'"]').length()){const f=document.head||document.getElementsByTagName("head")[0],g=document.createElement(a);g.type=e?"text/css":"text/javascript";g.id=d;f.appendChild(g);const h=function(a){e?g.styleSheet?g.styleSheet.cssText=a:g.appendChild(document.createTextNode(a)):g.innerText?g.innerText=a:g.appendChild(document.createTextNode(a));c&&c(b,d)},k="_res/"+a+"/"+d;a=m(k);null!=a?h(e?a.css:a.controller):t.ajax({url:b,success:function(a){G.push({componentId:k,view:null,css:e?
a:null,controller:e?null:a,using:b});h(a)},error:function(){f.removeChild(g);c&&c(b)}})}else c&&c(b,d)}};c.prototype.lazyLoad=function(a,b){if(null!=a)w.lazyLoad(a,b);else return w.lazyLoad();return this};c.prototype.httpCaching=function(a){if(null!=a)z(a);else return z();return this};c.prototype.componentize=function(a){w.componentize(a);return this};c.prototype.store=function(a,b){null!=b&&(this._store[a]=b);return this._store[a]};c.prototype.getResourcePath=function(a){return d(a)};c.prototype.observable=
function(a){return R.observable(a)};c.prototype.bundle=function(a,b){if(l.isNoU(a))return G;if(a&&"boolean"===typeof a){p.t("bundle:start");const c=w.lazyLoad();w.lazyLoad(!1);w.componentize();"function"===typeof b&&(a=function(a){setTimeout(function(){w.willLoadMore()?(p.t("bundle:wait"),a(a)):(p.t("bundle:end"),w.lazyLoad(c),b())},1E3)},a(a))}else{for(let b=0;b<a.length;b++)a[b].css_applied&&delete a[b].css_applied,"string"===typeof a[b].controller&&(a[b].controller=eval(a[b].controller));G=a}return this};
c.prototype.$=t;c.prototype.TaskQueue=F;c.prototype.ObjectObserver=v;c.prototype.ZxQuery=t.ZxQuery;c.prototype.dumpCache=function(){return G};c.prototype.dumpContexts=function(){return L};q.exports=function(a){const b=new c;"loading"!=document.readyState?b.componentize():document.addEventListener("DOMContentLoaded",function(){b.componentize()});p.monitor(function(a,c){l.isFunction(b.monitor)&&b.monitor(a,Array.prototype.slice.call(c))});return b}},{"../helpers/Logger":2,"../helpers/ObjectObserver":3,
"../helpers/TaskQueue":4,"../helpers/Util":5,"../helpers/ZxQuery":6,"./ComponentCache":8,"./ComponentContext":9,"./Componentizer":10,"./ContextController":11,"./OptionAttributes":12}]},{},[7])(7)});
//# sourceMappingURL=zuix.min.js.map
