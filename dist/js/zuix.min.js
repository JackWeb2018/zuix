/*
 @license
 Copyright 2015-2019 G-Labs. All Rights Reserved.
         https://zuixjs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';(function(m){"object"===typeof exports&&"undefined"!==typeof module?module.exports=m():"function"===typeof define&&define.amd?define([],m):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).zuix=m()})(function(){return function(){function m(u,v,e){function k(a,c){if(!v[a]){if(!u[a]){var h="function"==typeof require&&require;if(!c&&h)return h(a,!0);if(f)return f(a,!0);c=Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",
c;}c=v[a]={exports:{}};u[a][0].call(c.exports,function(c){return k(u[a][1][c]||c)},c,c.exports,m,u,v,e)}return v[a].exports}for(var f="function"==typeof require&&require,c=0;c<e.length;c++)k(e[c]);return k}return m}()({1:[function(m,u,v){function e(d){r=d}function k(){null!==n&&(cancelAnimationFrame(n),n=null);h++;if(h<a.length&&!r.willBreak())return c(),!0;(h>=a.length||r.willBreak())&&f();return!1}function f(d){h=-1;a.length=0;a=[];r.status(null!=d?d:"done")}function c(){const d=a[h];if(null==d)return!1;
const c=function(){null!==n&&(cancelAnimationFrame(n),n=null);r.doWork(d.item,function(){n=requestAnimationFrame(k)})||k()};if(d.cancelable)if(r.willBreak())f("stopped");else if(null==n)n=requestAnimationFrame(c);else return!1;else c();return!0}e.prototype.isReady=function(){return 0===a.length||-1===h};e.prototype.getJobs=function(){return a};e.prototype.setJobs=function(d){0<a.length?(h=-1,a.length=0):(a=d.slice(),r.status("start",a),k())};e.prototype.append=function(d){this.isReady()?this.setJobs(d):
Array.prototype.push.apply(a,d)};let a=[],h=-1,r=null,n=null;u.exports=function(d){return new e(d)}},{}],2:[function(m,u,v){function e(e){f=window?window.console:{};c=window?window:{};this._timers={};this.args=function(a,c,d){a="%c "+c+" %c"+(new Date).toISOString()+" %c"+a;c=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];for(var f=0;f<d.length;f++)if("string"==typeof d[f]&&0===
d[f].indexOf("timer:")){const g=d[f].split(":");if(3===g.length){let b;switch(g[2]){case "start":this._timers[g[1]]=(new Date).getTime();a+=" %cSTART "+g[1];c.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":b=(new Date).getTime()-this._timers[g[1]],a+=" %cSTOP "+g[1]+" "+b+" ms",200<b?c.push("background-color:rgba(200,200,200,0.2);color:#ff0000;"):100<b?c.push("background-color:rgba(200,200,200,0.2);color:#ff7700;"):c.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}}a+=
" \n%c ";c.push("background-color:transparent;color:inherit;");for(f=c.length-1;0<=f;f--)Array.prototype.unshift.call(d,c[f]);Array.prototype.unshift.call(d,a);Array.prototype.push.call(d,"\n\n")};this.log=function(h,n){"function"===typeof a&&a.call(e,h,n);c.zuixNoConsoleOutput||(this.args(e,h,n),f.log.apply(f,n))}}const k="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" ");let f=null,c=null,
a=null;e.prototype.monitor=function(c){a=c};e.prototype.console=function(a){if(a)window.console=f;else for(window.console={},a=0;a<k.length;a++)window.console[k[a]]||(window.console[k[a]]=function(){})};e.prototype.i=e.prototype.info=e.prototype.l=e.prototype.log=function(){this.log("INFO",arguments);return this};e.prototype.w=e.prototype.warn=function(){this.log("WARN",arguments);return this};e.prototype.e=e.prototype.error=function(){this.log("ERROR",arguments);return this};e.prototype.d=e.prototype.debug=
function(){this.log("DEBUG",arguments);return this};e.prototype.t=e.prototype.trace=function(){this.log("TRACE",arguments);return this};u.exports=function(a){return new e(a)}},{}],3:[function(m,u,v){function e(){this.observableList=[]}function k(f){let c="";for(;f&&f.__path__;){const a=f;f=f.__parents__[0];c=null!=f&&null!=f.__path__?"['"+a.__path__+"']."+c:a.__path__+c}return c}e.prototype.observable=function(f){const c=this;let a;var e=this.observableList.filter(function(a){return f===a.proxy||
f===a.target});1===e.length&&(a=e[0]);const r=function(a){const d=[];a.__parents__.forEach(function(a){d.push(...r(a))});d.push(...a.__listeners__);return d};null==a&&(e={context:null,get:function(a,d){let c=a[d];if("undefined"!==typeof c){var f=[],b=this.context.observable(a);if("object"===typeof c){const a=this.context.observable(c);-1===a.__parents__.indexOf(b)&&(a.__parents__.push(b),a.__path__=d);f.push(...r(a));c=a.proxy}else f.push(...r(b));var x=k(b)+d;f.forEach(function(b){b.get(a,d,c,x)});
return c}},set:function(a,d,c){let f=JSON.parse(JSON.stringify(a));a[d]=c;const b=this.context.observable(a),x=k(b)+d;r(b).forEach(function(b){b.set(a,d,c,x,f)});return!0}},Object.assign(e,{context:this}),a=Proxy.revocable(f,e),a.target=f,a.__parents__=[],a.__listeners__=[],a.subscribe=function(f){c.observableList.forEach(function(d){if(d!==a&&-1!==d.__listeners__.indexOf(f))throw Error("Listener already registered.");});a.__listeners__.push(f);return a},a.unsubscribe=function(f){f=a.__listeners__.indexOf(f);
-1!==f&&a.__listeners__.splice(f,1);0===a.__listeners__.length&&(a.revoke(),c.observableList=c.observableList.filter(function(d){if(d===a)return!1;const c=d.__parents__.indexOf(a);return-1!==c&&(d.__parents__.splice(c,1),0===d.__parents__.length&&0===d.__listeners__.length)?(d.unsubscribe(null),!1):!0}));return a},this.observableList.push(a));return a};u.exports=e},{}],4:[function(m,u,v){function e(f){const c=this;c._worker=null;c._taskList=[];c._requests=[];null==f&&(f=function(){});c.taskQueue=
function(a,e,r){c._taskList.push({tid:a,fn:e,status:0,priority:r,step:function(a){k.t(a,"load:step");f(c,"load:step",{task:a})},end:function(){this.status=2;k.t(this.tid,"load:next","timer:task:stop");f(c,"load:next",{task:this.tid});c._taskList.splice(this.index,1);c.taskCheck();null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});k.t(a,"task added",r,"priority");c._taskList.sort(function(a,d){return a.priority>d.priority?1:d.priority>a.priority?-1:0});c.taskCheck()};
c.taskCheck=function(){for(let a=0;a<c._taskList.length;a++){if(0===c._taskList[a].status){c._taskList[a].status=1;k.t(c._taskList[a].tid,"load:begin","timer:task:start");f(c,"load:begin",{task:c._taskList[a].tid});c._taskList[a].index=a;c._taskList[a].fn.call(c._taskList[a]);return}if(1===c._taskList[a].status||2===c._taskList[a].status)return}k.t("load:end");f(c,"load:end")}}const k=m("./Logger")("TaskQueue.js");e.prototype.callback=function(f){};e.prototype.queue=function(f,c,a){return this.taskQueue(f,
c,a)};u.exports=e},{"./Logger":2}],5:[function(m,u,v){u.exports={isIE:function(){return 0<window.navigator.userAgent.indexOf("Trident")},isNoU:function(e){return"undefined"===typeof e||null===e},isFunction:function(e){return"function"===typeof e},objectEquals:function(e,k){if(null===e||void 0===e||null===k||void 0===k)return e===k;if(e.constructor!==k.constructor)return!1;if(e instanceof Function||e instanceof RegExp)return e===k;if(e===k||e.valueOf()===k.valueOf())return!0;if(Array.isArray(e)&&e.length!==
k.length||e instanceof Date||!(e instanceof Object)||!(k instanceof Object))return!1;const f=Object.keys(e);return Object.keys(k).every(function(c){return-1!==f.indexOf(c)})&&f.every(function(c){return util.objectEquals(e[c],k[c])})},propertyFromPath:function(e,k){if("string"===typeof k){k=k.match(/\[(".*?"|'.*?'|(.*?))\]|".*?"|'.*?'|[0-9a-zA-Z_$]+/g);for(let f=0;f<k.length;f++){let c=k[f];c.startsWith("[")&&c.endsWith("]")&&(c=c.substring(1,c.length-1).trim());c.startsWith('"')&&c.endsWith('"')?
c=c.substring(1,c.length-1):c.startsWith("'")&&c.endsWith("'")&&(c=c.substring(1,c.length-1));if("undefined"!==typeof e[c])e=e[c];else return}return e}},cloneObject:function f(k){if(null===k||"object"!==typeof k)return k;let c=k;try{c=k.constructor();for(let a in k)k.hasOwnProperty(a)&&(c[a]=f(k[a]))}catch(a){}return c},hasPassiveEvents:function(){let k=!1;try{const f=Object.defineProperty({},"passive",{get:function(){k=!0}});window.addEventListener("testPassive",null,f);window.removeEventListener("testPassive",
null,f)}catch(f){}return k},dom:{queryAttribute:function(k,f,c){const a=k.split(",");let h="";a.forEach(function(k,n){h=null!=f?h+("["+k+'="'+f+'"]'):h+("["+k+"]");c&&(h+=c.get(n));n<a.length-1&&(h+=",")});return h},getAttribute:function(k,f){let c;if("string"===typeof f&&-1!==f.indexOf(",")){f=f.split(",");for(let a=0;a<f.length;a++){const h=k.getAttribute(f[a]);if(null!=h){c=h;break}}}else c=k.getAttribute(f);return c},setAttribute:function(k,f,c){"string"===typeof f&&-1!==f.indexOf(",")?f.split(",").forEach(function(a){k.setAttribute(a,
c)}):k.setAttribute(f,c)},cssNot:function(k,f){const c=k.split(",");let a="";c.forEach(function(h,k){a=h.startsWith(".")?a+(":not("+h+")"):null!=f?a+(":not(["+h+'="'+f+'"])'):a+(":not(["+h+"])");k<c.length-1&&(a+=",")});return function(a){return{get:function(c){const f=a.split(",");return c>=f.length||null==c?f[0]:f[c]}}}(a)}}}},{}],6:[function(m,u,v){function e(b){c(this,b.type,b)}function k(b,a,c,f){let x=!1;g.each(t,function(){if(this.element===b&&this.path===a&&this.handler===c)return r.w("Handler already registered",
b,a,c),x=!0,!1});x||(t.push({element:b,path:a,handler:c,opgions:f}),b.addEventListener(a,e,!d||null!=f&&!1===f.passive?!1:{passive:!0}))}function f(b,a,d){let c=1,x=-1;g.each(t,function(f){this.element===b&&this.path===a&&this.handler===d&&(c--,x=f)});-1!==x&&t.splice(x,1);0===c&&b.removeEventListener(a,e)}function c(b,a,d){const c=g(b);g.each(t,function(){this.element===b&&this.path===a&&this.handler.call(c,d,c)})}function a(b){g.each(t,function(){this.element===b&&(r.t("Removing event handler",
this.element,this.path,this.handler),f(this.element,this.path,this.handler))})}function h(b){this._selection=[];"undefined"===typeof b&&(b=document.documentElement);if(b instanceof h)return b;if(b instanceof HTMLCollection||b instanceof NodeList){const a=this._selection=[];g.each(b,function(b,d){a.push(d)})}else if(Array.isArray(b))this._selection=b;else if(b===window||b instanceof HTMLElement||b instanceof Node)this._selection=[b];else if("string"===typeof b)this._selection=document.documentElement.querySelectorAll(b);
else if(null!==b)throw r.e("ZxQuery cannot wrap object of this type.",typeof b,b),Error("ZxQuery cannot wrap object of this type.");return this}const r=m("./Logger")("TaskQueue.js"),n=m("./Util.js");let d=n.hasPassiveEvents();const t=[];h.prototype.length=function(){return this._selection.length};h.prototype.parent=function(b){return n.isNoU(b)?new h(this._selection[0].parentNode):new h(g.getClosest(this._selection[0],b))};h.prototype.children=function(b){return n.isNoU(b)?new h(this._selection[0].children):
new h(this._selection[0].querySelectorAll(b))};h.prototype.reverse=function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};h.prototype.get=function(b){n.isNoU(b)&&(b=0);return this._selection[b]};h.prototype.eq=function(b){const a=this._selection;let d=a[b];1<arguments.length&&(d=[],g.each(arguments,function(b,c){null!=a[c]&&d.push(a[c])}));return new h(d)};h.prototype.find=function(b){return new h(this._selection[0].querySelectorAll(b))};h.prototype.each=function(b){g.each(this._selection,
b);return this};h.prototype.attr=function(b,a){const d=this;if("object"===typeof b)g.each(b,function(b,a){d.each(function(d,c){n.dom.setAttribute(c,b,a)})});else{if("undefined"==typeof a)return n.dom.getAttribute(this._selection[0],b);null===a?this._selection[0].removeAttribute(b):this.each(function(d,c){n.dom.setAttribute(this.get(),b,a)})}return this};h.prototype.trigger=function(b,a){let d;window.CustomEvent?d=new CustomEvent(b,{detail:a}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(b,
!0,!0,a));this.each(function(b,a){a.dispatchEvent(d)});return this};h.prototype.one=function(b,a){let d=!1;this.on(b,function(c,f){d||(d=!0,g(this).off(b,a),a.call(this,c,f,this))});return this};h.prototype.on=function(b,a){const d=b.match(/\S+/g)||[];let c;"function"!==typeof a&&(c=a,a=c.handler);this.each(function(b,f){g.each(d,function(b,d){k(f,d,a,c)})});return this};h.prototype.off=function(b,a){const d=b.match(/\S+/g)||[];this.each(function(b,c){g.each(d,function(b,d){f(c,d,a)})});return this};
h.prototype.reset=function(){this.each(function(b,d){a(d)});return this};h.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};h.prototype.position=function(){return null!=this._selection[0]?g.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};h.prototype.css=function(b,a){const d=this;if("object"===typeof b)g.each(b,function(b,a){d.each(function(d,c){c.style[b]=a})});else{if(n.isNoU(a))return this._selection[0].style[b];d.each(function(d,c){c.style[b]=
a})}return this};h.prototype.addClass=function(b){const a=b.match(/\S+/g)||[];g.each(this._selection,function(d,c){c.classList?g.each(a,function(b,a){c.classList.add(a)}):c.className+=" "+b});return this};h.prototype.hasClass=function(b){return g.hasClass(this._selection[0],b)};h.prototype.removeClass=function(b){const a=b.match(/\S+/g)||[];g.each(this._selection,function(d,c){c.classList?g.each(a,function(b,a){c.classList.remove(a)}):c.className=c.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+
"(\\b|$)","gi")," ")});return this};h.prototype.prev=function(){return new h(this._selection[0].previousElementSibling)};h.prototype.next=function(){return new h(this._selection[0].nextElementSibling)};h.prototype.html=function(b){if(n.isNoU(b))return this._selection[0].innerHTML;this.each(function(a,d){d.innerHTML=b});return this};h.prototype.checked=function(b){if(n.isNoU(b)){const b=this._selection[0].checked;return null!=b&&"false"!=b&&(b||"checked"==b)}this.each(function(a,d){d.checked=b});return this};
h.prototype.value=function(b){if(n.isNoU(b))return this._selection[0].value;this.each(function(a,d){d.value=b});return this};h.prototype.append=function(b){"string"===typeof b?this._selection[0].innerHTML+=b:this._selection[0].appendChild(b);return this};h.prototype.insert=function(b,a){b=this.children().get(b);null!==b?this._selection[0].insertBefore(a,b):this._selection[0].appendChild(a);return this};h.prototype.prepend=function(b){"string"===typeof b?this._selection[0].innerHTML=b+this._selection[0].innerHTML:
this._selection[0].insertBefore(b,this._selection[0].firstElementChild);return this};h.prototype.detach=function(){const b=this._selection[0],a=b.parentNode;null!=a&&(b.__zuix_oldParent=a,b.__zuix_oldIndex=Array.prototype.indexOf.call(a.children,b),a.removeChild(b),r.t("Detached from parent",a,b));return this};h.prototype.attach=function(){const b=this._selection[0];null!=b.parentNode&&null!=b.__zuix_oldParent&&b.parentNode.removeChild(b);null==b.parentNode&&null!=b.__zuix_oldParent&&(g(b.__zuix_oldParent).insert(b.__zuix_oldIndex,
b),b.__zuix_oldParent=null,delete b.__zuix_oldParent,delete b.__zuix_oldIndex);return this};h.prototype.display=function(b){if(n.isNoU(b))return this._selection[0].style.display;g.each(this._selection,function(a,d){d.style.display=b});return this};h.prototype.visibility=function(b){if(n.isNoU(b))return this._selection[0].style.visibility;g.each(this._selection,function(a,d){d.style.visibility=b});return this};h.prototype.show=function(b){return this.display(null==b?"":b)};h.prototype.hide=function(){return this.display("none")};
const g=function(b){return new h(b)};g.find=function(b){return g().find(b)};g.each=function(b,a){const d=null==b?0:Object.keys(b).length;if(0<d){let c=0;for(let f in b)if(b.hasOwnProperty(f)){let e=b[f];e instanceof Element&&(e=g(e));if(!1===a.call(e,f,b[f],e))break;c++;if(c>=d)break}}return this};g.ajax=function(b){let a;a=n.isNoU(b)||n.isNoU(b.url)?b:b.url;const d=new XMLHttpRequest;d.onload=function(){200===d.status?n.isFunction(b.success)&&b.success(d.responseText):n.isFunction(b.error)&&b.error(d,
d.statusText,d.status);n.isFunction(b.then)&&b.then(d)};d.onerror=function(a,d,c){n.isFunction(b.error)&&b.error(a,d,c)};"function"==typeof b.beforeSend&&b.beforeSend(d);try{d.open("GET",a),d.send()}catch(M){n.isFunction(b.error)&&b.error(d,d.statusText,d.status,M)}return this};g.hasClass=function(b,a){a=a.match(/\S+/g)||[];let d=!1;g.each(a,function(a,c){if(d=b.classList?b.classList.contains(c):(new RegExp("(^| )"+c+"( |$)","gi")).test(b.className))return!1});return d};g.classExists=function(b){b=
b.match(/\S+/g)||[];let a=!1;g.each(b,function(b,d){b=document.styleSheets;if(null!=b)for(let c=0;c<b.length;c++)try{const f=b[c].rules||b[c].cssRules;if(null!=f)for(let b=0;b<f.length;b++)if(f[b].selectorText===d){a=!0;break}}catch(q){if("SecurityError"!==q.name&&"InvalidAccessError"!==q.name)throw q;}});return a};g.wrapElement=function(b,a){b=document.createElement(b);"string"===typeof a?b.innerHTML=a:b.appendChild(a);return b};g.wrapCss=function(b,a,d){const c=/(([a-zA-Z0-9\240-\377=:-_\n,.@]+.*){([^{}]|((.*){([^}]+)[}]))*})/g;
let f="",e;a=a.replace(/\/\*[\s\S]*?\*\/|([^:]|^)\/\/.*$/g,"");do if((e=c.exec(a))&&1<e.length){var t=e[2];if(null!=t&&0<t.length){t=t.replace(/\n/g,"");const a=t.split(",");let c=!1;g.each(a,function(e,g){"."===g.trim()?f+="\n"+d+" ":"@"===g.trim()[0]?(f+=g+" ",g.trim().toLowerCase().startsWith("@media")&&(c=!0)):f+="\n"+g.trim()+b+" ";e<a.length-1&&(f+=", ")});c?(t=g.wrapCss(b,e[1].substring(e[2].length).replace(/^{([^\0]*?)}$/,"$1"),d),f+="{\n  "+t+"\n}"):f+=e[1].substring(e[2].length)+"\n"}else r.w("z$.wrapCss was unable to parse rule.",
t,e)}while(e);""!==f&&(a=f);return a};g.appendCss=function(b,a,d){const c=document.head||document.getElementsByTagName("head")[0];let f=null;n.isNoU(a)?(a=document.getElementById(d),null!=a&&c.removeChild(a)):c.removeChild(a);"string"===typeof b?(f=document.createElement("style"),f.type="text/css",f.id=d,f.styleSheet?f.styleSheet.cssText=b:f.appendChild(document.createTextNode(b))):b instanceof Element&&(f=b);n.isNoU(f)||c.appendChild(f);return f};g.replaceCssVars=function(b,a){const d=new RegExp(/\B\$var\[(.*[^\[\]])]/g);
let c="",f=0,e=0,g;for(;g=d.exec(b);){let d=g[0];if(1<g.length){var t=g[1];let b=a;if(0<t.indexOf(".")){t=t.split(".");for(let a=0;a<t.length-1&&(b=b[t[a]],"undefined"!==typeof b);a++);"undefined"!==typeof b&&(d=b[t[t.length-1]],f++)}else"undefined"!==typeof b[t]&&(d=b[t],f++)}c+=b.substr(e,g.index-e)+d;e=g.index+g[0].length}0<f&&(b=c+=b.substr(e));return b};g.replaceBraces=function(b,a){const d=new RegExp(/{?{.*?}?}/g);let c="",f=0,e=0;for(var g;g=d.exec(b);){if("string"===typeof g[0]&&(0===g[0].trim().length||
0<=g[0].indexOf("\n"))){g=b.substr(e,g.index-e)+g[0];c+=g;e+=g.length;continue}let d=g[0];if("function"===typeof a){const b=a(g[0]);n.isNoU(b)||(d=b,f++)}c+=b.substr(e,g.index-e)+d;e=g.index+g[0].length}return 0<f?c+=b.substr(e):null};g.getClosest=function(b,a){for(b=b.parentNode;b&&b!==document;b=b.parentNode)if(b.matches(a))return b;return null};g.getPosition=function(b,a){var d;{var c=d=0,f=b.getBoundingClientRect();let a=b;for(;a;){if("body"===a.tagName.toLowerCase()){const b=a.scrollTop||document.documentElement.scrollTop;
d+=a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+a.clientLeft;c+=a.offsetTop-b+a.clientTop}else d+=a.offsetLeft-a.scrollLeft+a.clientLeft,c+=a.offsetTop-a.scrollTop+a.clientTop;a=a.offsetParent}d={x:d,y:c,rect:f}}d.visible=!1;f=b.offsetParent;if(null!=f){if(f!==document.body){for(c=f.offsetParent;null!=c&&null!==c.offsetParent&&c.offsetHeight===c.scrollHeight;)c=c.offsetParent;null!=c&&(f=c)}c=f.getBoundingClientRect();f===document.body&&(c={x:c.x,y:c.y,width:document.documentElement.offsetWidth||
document.documentElement.clientWidth,height:document.documentElement.offsetHeight||document.documentElement.clientHeight,top:0,left:0,right:document.documentElement.clientWidth||document.documentElement.offsetWidth,bottom:document.documentElement.clientHeight||document.documentElement.offsetHeight});null==a&&(a=0);f=b.getBoundingClientRect();a=!(f.left-1>c.right-a||f.right+1<c.left+a||f.top-1>c.bottom-a||f.bottom+1<c.top+a);d.visible=a;d.frame={dx:(f.left+f.width/2-c.left)/c.width,dy:(f.top+f.height/
2-c.top)/c.height};b=g(b);!a&&b.hasClass("--ui--visible")?(b.removeClass("--ui--visible"),d.event="exit"):a?a&&(b.hasClass("--ui--visible")?d.event="scroll":(d.event="enter",b.addClass("--ui--visible"))):d.event="off-scroll"}return d};g.ZxQuery=h;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=
(this.document||this.ownerDocument).querySelectorAll(a);let b=a.length;for(;0<=--b&&a.item(b)!==this;);return-1<b});(function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};const d=document.createEvent("CustomEvent");d.initCustomEvent(a,b.bubbles,b.cancelable,b.detail);return d}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();String.prototype.hashCode=function(){let a=0;if(0===this.length)return a;for(let b=0;b<this.length;b++){let d=
this.charCodeAt(b);a=(a<<5)-a+d;a|=0}return a};String.prototype.startsWith||(String.prototype.startsWith=function(a,d){return this.substr(!d||0>d?0:+d,a.length)===a});u.exports=g},{"./Logger":2,"./Util.js":5}],7:[function(m,u,v){m=m("./zuix/Zuix.js");"object"===typeof u&&u.exports?u.exports=m.call(this):this.zuix=m.call(this)},{"./zuix/Zuix.js":14}],8:[function(m,u,v){u.exports=function(e){return null}},{}],9:[function(m,u,v){function e(d,e,g){r=d;this._options=null;this.contextId=null==e||null==
e.contextId?null:e.contextId;this.componentId=null;this.trigger=function(a,d,c){"function"===typeof g&&g(a,d,c)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this._modelListener=Object.assign({context:null,get:function(a,d,c,f){},set:function(b,d,e,g,t){const h=c(this.context.view());if(h.get()){let c=h.find(a.dom.queryAttribute(f.dataBindTo,g));null==c.get()&&(c=h.find(a.dom.queryAttribute(f.dataUiField,
g)));c.get()&&this.context.dataBind(c.get(),e);this.context._c&&"function"===typeof this.context._c.update&&this.context._c.update(b,d,e,g,t)}}},{context:this});this._viewObserver=new h(this);this.options(e);return this}const k=m("../helpers/Logger")("ComponentContext.js"),f=m("./OptionAttributes"),c=m("../helpers/ZxQuery"),a=m("../helpers/Util"),h=m("./ViewObserver");let r=null;const n=[];e.prototype.dispose=function(){this._viewObserver.stop();a.isNoU(this._c)||(a.isNoU(this._c.view())||(this._c.view().attr(f.dataUiComponent,
null),this._c.view().reset(),a.isNoU(this._c._fieldCache)||c.each(this._c._fieldCache,function(a,d){d.reset()})),a.isFunction(this._c.destroy)&&this._c.destroy.call(this,this));this.model(null);this._c.view().detach();const d=this._container;null!=d&&null!=d.parentNode&&d.parentNode.removeChild(d)};e.prototype.container=function(a){if(null==a)return this._container;a instanceof c.ZxQuery&&(a=a.get());this._container=a;return this};e.prototype.view=function(d){if("undefined"===typeof d)return this._view;
d instanceof c.ZxQuery&&(d=d.get());if(d===this._view)return this;k.t(this.componentId,"view:attach","timer:view:start");if("string"===typeof d){d={content:d};this.trigger(this,"html:parse",d);d=d.content;const e=c.wrapElement("div",d);null!=e.firstElementChild&&(null!=a.dom.getAttribute(e.firstElementChild,f.dataUiView)?1===e.children.length&&(d=e.firstElementChild.innerHTML):d=e.innerHTML);null!=this._container?(this._view=this._container,this._view.innerHTML+=d):null!=this._view?this._view.innerHTML=
d:this._view=e;c(this._view).find("script").each(function(a,d){"true"!==this.attr(f.zuixLoaded)&&(this.attr(f.zuixLoaded,"true"),eval.call(window,d.innerHTML))});this.trigger(this,"view:process",c(this._view))}else null!=this._container?(this._view=c.wrapElement("div",d.outerHTML).firstElementChild,this._view.removeAttribute(f.dataUiView),this._container.appendChild(this._view),this._view=this._container):this._view=d;d=c(this._view);!1===this._options.css?d.addClass("zuix-css-ignore"):d.removeClass("zuix-css-ignore");
d.find(a.dom.queryAttribute(f.dataUiLoad)).each(function(a,b){this.attr(f.dataUiLoaded,"false")});const e=this.getCssId();d.attr(e,"");null!=this._container||null!=this._style?(d.find("*"+a.dom.cssNot(f.dataUiLoad).get()+a.dom.cssNot(f.dataUiInclude).get()).each(function(a,b){this.attr(e,"")}),this._viewObserver.start(),d.attr("_ctrl_",null)):d.attr("_ctrl_","");this.modelToView();k.t(this.componentId,"view:attach","timer:view:stop");return this};e.prototype.style=function(d){if("undefined"===typeof d)return this._style;
k.t(this.componentId,"view:style","timer:view:start");if(null==d||d instanceof Element)this._css=d instanceof Element?d.innerText:d,this._style=c.appendCss(d,this._style,this.componentId);else if("string"===typeof d){this._css=d;d={content:d};this.trigger(this,"css:parse",d);d=d.content;const e="["+this.getCssId()+"]";d=c.wrapCss(e+":not(.zuix-css-ignore)",d,e+a.dom.queryAttribute(f.dataUiLoad,this.componentId)+":not(.zuix-css-ignore),"+e+a.dom.queryAttribute(f.dataUiInclude,this.componentId)+":not(.zuix-css-ignore)");
this._style=c.appendCss(d,this._style,this.componentId)}k.t(this.componentId,"view:style","timer:view:stop");return this};e.prototype.model=function(d){if("undefined"===typeof d)return this._model;if(this._model===d)return this;null!==this._model&&"function"!==typeof this._model&&r.observable(this._model).unsubscribe(this._modelListener);this._model=d;null!=d&&("function"!==typeof d&&(this._model=r.observable(d).subscribe(this._modelListener).proxy),this.modelToView(),null!=this._c&&a.isFunction(this._c.update)&&
this._c.update.call(this._c,null,null,null,null,this._c));return this};e.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};e.prototype.options=function(a){if(null==a)return this._options;const d=this._options=this._options||{};Object.assign(d,a);this.componentId=d.componentId||this.componentId;null==n[this.componentId]&&(n[this.componentId]=n.length,n.length++);this.container(d.container);this.view(d.view);"undefined"!==typeof d.css&&
this.style(d.css);this.controller(d.controller);this.model(d.model);return this};e.prototype.on=function(a,c){this._c.on(a,c);return this};e.prototype.loadCss=function(d,f){const e=this;a.isNoU(d)&&(d={});a.isNoU(d.caching)||(f=d.caching);let b=e.componentId+".css";a.isNoU(d.path)||(b=d.path);f||(b+="?"+(new Date).getTime());c.ajax({url:r.getResourcePath(b),success:function(b){e.style(b);a.isFunction(d.success)&&d.success.call(e,b,e)},error:function(b){k.e(b,e);a.isFunction(d.error)&&d.error.call(e,
b,e)},then:function(){a.isFunction(d.then)&&d.then.call(e,e)}});return this};e.prototype.loadHtml=function(d,e){const g=this;let b=g.componentId;a.isNoU(d)&&(d={});a.isNoU(d.caching)||(e=d.caching);a.isNoU(d.path)||(b=d.path);var h=r.store("zuix.inlineViews");null==h&&(h=[],r.store("zuix.inlineViews",h));if(null!=h[b])g.view(h[b]),a.isFunction(d.success)&&d.success.call(g,h[b],g),a.isFunction(d.then)&&d.then.call(g,g);else{const t=c().find(a.dom.queryAttribute(f.dataUiView,b,a.dom.cssNot(f.dataUiComponent)));
0<t.length()?(e=t.get(0),h[b]=e.innerHTML,g.view()===e||null!=g.container()&&g.container().contains(e)?(t.attr(f.dataUiView,null),g._view=e,this.trigger(this,"view:process",c(g.view()))):g.view(e.innerHTML),a.isFunction(d.success)&&d.success.call(g,e.innerHTML,g),a.isFunction(d.then)&&d.then.call(g,g)):(h=a.isNoU(d.cext)?".html":d.cext,b==g.componentId&&(b+=h+(e?"":"?"+(new Date).getTime())),c.ajax({url:r.getResourcePath(b),success:function(b){g.view(b);a.isFunction(d.success)&&d.success.call(g,b,
g)},error:function(b){k.e(b,g);a.isFunction(d.error)&&d.error.call(g,b,g)},then:function(){a.isFunction(d.then)&&d.then.call(g,g)}}))}return this};e.prototype.viewToModel=function(){k.t(this.componentId,"view:model","timer:vm:start");const d=this;this._model={};c(this._view).find(a.dom.queryAttribute(f.dataUiField)).each(function(c,e){if(0<this.parent("pre,code").length())return!0;c=this.attr(f.dataUiField);e=!a.isNoU(e.innerHTML)&&a.isIE()?e.cloneNode(!0):e;if(0<c.indexOf(".")){c=c.split(".");let a=
d._model;for(let b=0;b<c.length-1;b++)"undefined"===typeof a[c[b]]&&(a[c[b]]={}),a=a[c[b]];a[c[c.length-1]]=e}else d._model[c]=e});k.t(this.componentId,"view:model","timer:vm:stop");return this};e.prototype.modelToView=function(){k.t(this.componentId,"model:view","timer:mv:start");if(null!=this._view&&null!=this._model){const d=this;c(this._view).find(a.dom.queryAttribute(f.dataUiField)).each(function(e,g){if(0<this.parent("pre,code").length())return!0;e=this.attr(f.dataBindTo);null==e&&(e=this.attr(f.dataUiField));
const b=c(d._view);if("function"===typeof d._model)d._model.call(b,this,e,b);else{const c=a.propertyFromPath(d._model,e);"function"===typeof c?c.call(b,this,e,b):null!=c&&d.dataBind(g,c)}})}k.t(this.componentId,"model:view","timer:mv:stop");return this};e.prototype.dataBind=function(d,c){switch(d.tagName.toLowerCase()){case "img":d.src=a.isNoU(c.src)?a.isNoU(c.innerHTML)?c:c.innerHTML:c.src;c.alt&&(d.alt=c.alt);break;case "a":d.href=a.isNoU(c.href)?a.isNoU(c.innerHTML)?c:c.innerHTML:c.getAttribute("href");
c.title&&(d.title=c.title);a.isNoU(c.href)||a.isNoU(c.innerHTML)||""===c.innerHTML.trim()||(d.innerHTML=c.innerHTML);break;case "input":d.value=a.isNoU(c.value)?a.isNoU(c.innerHTML)?c:c.innerHTML:c.value;break;default:if(d.innerHTML=a.isNoU(c.innerHTML)?c:c.innerHTML,null!=c.attributes)for(let e=0;e<c.attributes.length;e++){const b=c.attributes[e];b.specified&&b.name!==f.dataUiField&&("+"===b.value[0]&&d.hasAttribute(b.name)&&(b.value=d.getAttribute(b.name)+" "+b.value.substring(1)),a.dom.setAttribute(d,
b.name,b.value))}}};e.prototype.getCssId=function(){return"_cmp_"+n[this.componentId]};u.exports=e},{"../helpers/Logger":2,"../helpers/Util":5,"../helpers/ZxQuery":6,"./OptionAttributes":12,"./ViewObserver":13}],10:[function(m,u,v){function e(){}function k(a,b){null!=a&&(I=!a);null!=b&&(J=b);return!A&&!I}function f(a){null==a&&(a=document);E.indexOf(a)||E.push(a)}function c(a){for(let b=0;b<F.length;b++){const c=F[b];if(c.element===a)return c.waiting}return null}function a(a){null==a&&0<E.length&&
(a=E.unshift());a instanceof D.ZxQuery&&(a=a.get());c(a);var b=p.dom.queryAttribute(l.dataUiLoad,null,p.dom.cssNot(l.dataUiLoaded))+","+p.dom.queryAttribute(l.dataUiInclude,null,p.dom.cssNot(l.dataUiLoaded));b=D(a).find(b);b=Array.prototype.slice.call(b._selection);F.push({element:a,waiting:b});a=[];for(var d=0;d<b.length;d++){var e=b[d],z=+p.dom.getAttribute(e,l.dataUiPriority);isNaN(z)&&(z=0);let c=0;var f=e.parentNode;let P=!1;for(;null!=f&&f!==document;){c++;if(null!=p.dom.getAttribute(f,l.dataUiView)){P=
!0;break}f=f.parentNode}P||(f=new K,f.element=e,f.priority=z+1E3*c,a.push(f))}b=0;for(d=0;d<a.length;d++){e=!1;for(z=0;z<y.length;z++)if(a[d].element===y[z].element){e=!0;break}e||(e=a[d].element,z=p.dom.getAttribute(e,l.dataUiOptions),t(e,z),y.push(a[d]),b++)}q.t("componentize:count",y.length,b);(0===b||0===E.length&&0===y.length)&&B.trigger(this,"componentize:end")}function h(){y.sort(function(a,b){return a.priority-b.priority});let a=null,b=0<y.length?y.shift():null;for(;null!=b&&null!=b.element;){const c=
M(b.element);k()&&c?(b.lazy=!0,b.visible=D.getPosition(b.element,J).visible):(b.lazy=!1,b.visible=!0);if(null!=b.element&&b.visible){a={item:b,cancelable:b.lazy};break}if(0<y.length)b=y.shift();else break}return a}function r(b){a(b);b=h();null!=b&&L.append([b])}function n(a){var b=D(a);if(null!=b.attr(l.dataUiLoaded)||0<b.parent("pre,code").length())return!1;b.attr(l.dataUiLoaded,"true");let c=b.attr(l.dataUiOptions);p.isNoU(c)?c={}:(c=p.propertyFromPath(window,c),c=p.cloneObject(c)||{});var e=b.attr(l.dataUiContext);
if(!p.isNoU(e)){var z=B.context(e);null!==z&&(c=z.options());c.contextId=e}p.isNoU(c.view)&&!b.isEmpty()?(c.view=a,c.viewDeferred=!0):p.isNoU(c.view)&&p.isNoU(c.container)&&b.isEmpty()&&(c.container=a);e=b.attr(l.dataUiLoad);if(p.isNoU(e))if(e=b.attr(l.dataUiInclude),null!=e)e=d(e),b.attr(l.dataUiInclude,e),b.attr(l.dataUiComponent,""),p.isNoU(c.controller)&&(c.controller=function(){});else return!1;else e=d(e),b.attr(l.dataUiLoad,e);z=b.attr(l.dataBindModel);!p.isNoU(z)&&0<z.length&&(c.model=p.propertyFromPath(window,
z));b=b.attr(l.dataUiPriority);p.isNoU(b)||(c.priority=+b);D(a).one("component:ready",function(){f(a);r(a)});B.load(e,c);return!0}function d(a){if("@"===a[0]){let b=B.store("config"),c="https://zuixjs.github.io/zkit/lib/";null!=b&&null!=b[location.host]&&(b=b[location.host]);if(null!=b)switch(typeof b.libraryPath){case "object":D.each(b.libraryPath,function(b,d){return a.startsWith(b+"/")?(c=d,!1):!0});break;case "string":c=b.libraryPath}a=c+a.substring(a.indexOf("/")+1)}return a}function t(a,b){"string"===
typeof b&&(b=p.propertyFromPath(window,b));null!=a&&null!=b&&(null!=b.lazyLoad&&p.dom.setAttribute(a,l.dataUiLazyload,b.lazyLoad.toString().toLowerCase()),null!=b.contextId&&p.dom.setAttribute(a,l.dataUiContext,b.contextId.toString().toLowerCase()),null!=b.componentId&&p.dom.setAttribute(a,l.dataUiLoad,b.componentId.toString().toLowerCase()))}function g(a){for(let b=0;b<w.length;b++){const c=w[b];if(c.element===a)return c}return null}function b(a){a={element:a};w.push(a);return a}function x(a){for(let b=
0;b<C.length;b++){const c=C[b];if(c.element===a)return c}return null}function N(a){a={element:a};C.push(a);return a}function M(a){if("false"===p.dom.getAttribute(a,l.dataUiLazyload))return!1;let c=g(a);if(null==c){var d=p.dom.queryAttribute(l.dataUiLazyload,"scroll")+","+p.dom.queryAttribute(l.dataUiLazyload,"true");d=D.getClosest(a.parentNode,d);if(null!=d)return c=b(a),a=x(d),null==a&&(a=N(d),"scroll"===p.dom.getAttribute(d,l.dataUiLazyload)&&function(a,b){let c=(new Date).getTime();D(b===document.body?
window:b).on("scroll",function(){const a=(new Date).getTime();100<a-c&&(c=a,r(b))})}(this,d)),!0;if("true"===p.dom.getAttribute(a,l.dataUiLazyload))return c=b(a),!0}else return!0;return!1}const l=m("./OptionAttributes");e.prototype.componentize=function(a,b){B.trigger(this,"componentize:begin");if(null!=b){const d=c(a);null==d?F.push({element:a,waiting:[b]}):d.push(b)}else f(a);r(a);return this};e.prototype.applyOptions=function(a,b){t(a,b);return this};e.prototype.resolvePath=function(a){return d(a)};
e.prototype.willLoadMore=function(){return 0<y.length||0<E.length};e.prototype.lazyLoad=function(a,b){return k(a,b)};e.prototype.dequeue=function(a){for(let b=0;b<y.length;b++)if(y[b].element===a){y.splice(b,1);break}};e.prototype.setHost=function(a){B=a;return this};u.exports=function(){return new e};const q=m("../helpers/Logger")("ComponentContext.js"),p=m("../helpers/Util"),D=m("../helpers/ZxQuery"),E=[],y=[],w=[],C=[],K=function(){return{element:null,priority:0,visible:!0,lazy:!1}},L=m("./../helpers/AsynChain")({doWork:function(a,
b){D(a.element).one("component:ready",function(){b()});return n(a.element)},willBreak:function(){return!1},status:function(a){switch(a){case "done":r()}}});let I=!1,J=1,B=null,A=!1;navigator&&navigator.userAgent&&(A=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));A&&q.d(navigator.userAgent,"is a bot, ignoring `lazy-loading` option.");const F=[]},{"../helpers/Logger":2,"../helpers/Util":5,"../helpers/ZxQuery":6,"./../helpers/AsynChain":1,"./OptionAttributes":12}],
11:[function(m,u,v){function e(e){const c=this;this._view=null;this.context=e;this._fieldCache=[];this.destroy=this.update=this.create=this.init=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,e){c._childNodes.push(e)})};this.restoreView=function(){0<this._childNodes.length&&(c.view().html(""),k.each(c._childNodes,function(a,e){c.view().append(e)}),this._childNodes.length=0)};this.on=function(a,c){this.addEvent(a,c);return this};this.mapEvent=
function(a,c,d,e){null!=c&&(c.off(d,this.eventRouter),a[d]=e,c.on(d,this.eventRouter))};this.eventRouter=function(a){const f=c.view();"function"===typeof e._behaviorMap[a.type]&&e._behaviorMap[a.type].call(f,a,a.detail,f);"function"===typeof e._eventMap[a.type]&&e._eventMap[a.type].call(f,a,a.detail,f)};const a=e.options();let f=null;if(null!=a.on)for(let e in a.on)a.on.hasOwnProperty(e)&&(f=a.on[e],c.addEvent(e,f));if(null!=a.behavior)for(let e in a.behavior)a.behavior.hasOwnProperty(e)&&(f=a.behavior[e],
c.addBehavior(e,f));e.controller().call(this,this);return this}const k=m("../helpers/ZxQuery");e.prototype.addEvent=function(e,c){this.mapEvent(this.context._eventMap,this.view(),e,c);return this};e.prototype.addBehavior=function(e,c){this.mapEvent(this.context._behaviorMap,this.view(),e,c);return this};e.prototype.field=function(e){return null};e.prototype.clearCache=function(){this._fieldCache.length=0};e.prototype.view=function(e){if(null!=this.context.view()||this._view!==this.context.view())this.clearCache(),
this._view=k(this.context.view());if(null!=e)return this._view.find(e);if(null!==this._view)return this._view;throw Error("Not attached to a view yet.");};e.prototype.model=function(e){if(null==e)return this.context.model();this.context.model(e);return this};e.prototype.options=function(){return this.context.options()};e.prototype.trigger=function(e,c,a){null==this.context._eventMap[e]&&!0!==a&&this.addEvent(e,null);!0===a?(a=this.context.container(),null==a&&(a=this.context.view()),null!=a&&k(a).trigger(e,
c),this.context.trigger(this.context,e,c)):this.view().trigger(e,c);return this};e.prototype.expose=function(e,c){if("object"===typeof e){const a=this;k.each(e,function(c,e){a.context[c]=e})}else this.context[e]=c;return this};e.prototype.loadCss=function(e){this.context.loadCss(e);return this};e.prototype.loadHtml=function(e){this.saveView();this.context.loadHtml(e);return this};e.prototype.log={};e.prototype.for=function(e){return this};u.exports=e},{"../helpers/ZxQuery":6}],12:[function(m,u,v){m=
Object.freeze({dataBindModel:"z-model,data-bind-model",dataBindTo:"z-bind,data-bind-to",dataUiComponent:"z-component",dataUiContext:"z-context,data-ui-context",dataUiField:"z-field,data-ui-field",dataUiInclude:"z-include,data-ui-include",dataUiLazyload:"z-lazy,data-ui-lazyload",dataUiLoad:"z-load,data-ui-load",dataUiLoaded:"z-loaded",dataUiOptions:"z-options,data-ui-options",dataUiPriority:"z-priority,data-ui-priority",dataUiView:"z-view,data-ui-view",zuixLoaded:"zuix-loaded"});u.exports=m},{}],13:[function(m,
u,v){function e(c){const a=this._context=c;this._mutationObserver=null;this._mutationCallback=function(c,e){const h=f.dom.queryAttribute(k.dataUiComponent);for(let d of c)"childList"===d.type&&d.addedNodes.forEach(function(c){if(c instanceof Element){let e=zuix.$(c).parent(h);if(null==e.attr("_ctrl_")){if(e.get()===a._container||e.get()===a._view){var d=!1;for(var b=0;b<c.attributes.length;b++)if(c.attributes[b].name.startsWith("_cmp_")){d=!0;break}d||f.dom.setAttribute(c,a.getCssId(),"")}}else{d=
0;do d++,e=e.parent(h);while(10>d&&null!=e.get()&&null!=e.attr("_ctrl_"));if(e.get()){e=zuix.context(e);d=!1;for(b=0;b<c.attributes.length;b++)if(c.attributes[b].name.startsWith("_cmp_")){d=!0;break}d||(f.dom.setAttribute(c,e.getCssId(),""),zuix.$(c).find("*").each(function(){this.attr(e.getCssId(),"")}))}}}})}}const k=m("./OptionAttributes"),f=m("../helpers/Util");e.prototype.start=function(){this.stop();this._mutationObserver=new MutationObserver(this._mutationCallback);this._mutationObserver.observe(this._context._view,
{attributes:!1,childList:!0,subtree:!0})};e.prototype.stop=function(){null!=this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null)};u.exports=e},{"../helpers/Util":5,"./OptionAttributes":12}],14:[function(m,u,v){function e(){w.setHost(this);this._store=[];this._fieldCache=[];return this}function k(a){"function"!==typeof a["for"]&&(a["for"]=function(b){return I[b]=a});return a}function f(a,b,c){q.isNoU(c)&&(c=this);null==c._fieldCache&&(c._fieldCache={});let d=null;
"undefined"===typeof c._fieldCache[a]?(d=p(b).find(q.dom.queryAttribute(C.dataUiField,a)),null!=d&&0<d.length()&&(c._fieldCache[a]=d,1===d.length()&&q.isNoU(d.field)&&(d.field=function(a){return f(a,d,d)}))):d=c._fieldCache[a];return d}function c(a){let b=zuix.store("config");null!=b&&null!=b[location.host]&&(b=b[location.host]);a=w.resolvePath(a);!a.startsWith("//")&&0>a.indexOf("://")&&(a=(null!=b&&null!=b.resourcePath?b.resourcePath:"")+a);return a}function a(a,c){let d=t(a.componentId);null!==
d&&null==c.controller&&null==a.controller()&&(a.controller(d.controller),l.t(a.componentId+":js","component:cached:js"));if(q.isNoU(c.view)){if(null!==d&&(null!=d.view&&(a.view(d.view),l.t(a.componentId+":html","component:cached:html")),!1!==c.css&&(c.css=!1,d.css_applied||(d.css_applied=!0,a.style(d.css),l.t(a.componentId+":css","component:cached:css")))),q.isNoU(a.view()))return F("resource-loader").queue(a.componentId+":html",function(){A[a.componentId]=this;a.loadHtml({cext:c.cext,caching:H,success:function(e){null==
d&&(d=b(a));d.view=e;delete d.controller;!1!==c.css?(A[a.componentId].step(a.componentId+":css"),a.loadCss({caching:H,success:function(a){d.css=a},error:function(b){l.e(b,a)},then:function(){g(a,A[a.componentId])}})):g(a,A[a.componentId])},error:function(b){l.e(b,a);q.isFunction(c.error)&&a.error.call(a,b,a)}})},c.priority),a}else a.view(c.view);null==a.controller()?F("resource-loader").queue(a.componentId+":js",function(){A[a.componentId]=this;g(a,A[a.componentId])},K.length):g(a);return a}function h(a){a=
new E(zuix,a,n);K.push(a);return a}function r(a,b){let c=null;if(a instanceof p.ZxQuery)a=a.get();else if("string"===typeof a){const b=p.find(q.dom.queryAttribute(C.dataUiContext,a));0<b.length()&&(a=b.get())}p.each(K,function(b,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||q.objectEquals(d.contextId,a))return c=d,!1});if("function"===typeof b&&(a instanceof Element||a instanceof p.ZxQuery))if(null!=c&&c.isReady)b.call(c,c);else p(a).one("component:ready",function(){c=zuix.context(this);
b.call(c,c)});return c}function n(a,b,c){q.isFunction(L[b])&&L[b].call(a,c,a)}function d(a){null!=a&&(H=a);return H}function t(a){let b=null;p.each(G,function(c,d){if(q.objectEquals(d.componentId,a))return b=d,!1});return b}function g(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(l.d(a.componentId,"controller:load"),q.isNoU(b)||b.step(a.componentId+":js"),q.isFunction(I[a.componentId]))a.controller(I[a.componentId]),x(a,b);else{const d=function(b){const d=a.componentId+
".js"+(H?"":"?"+(new Date).getTime());p.ajax({url:c(d),success:function(b){try{const c=b.indexOf("function"),d=b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-4));const e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+11));const f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+'.js"\n';a.controller(M(b))}catch(Q){l.e(Error(),Q,b,a),q.isFunction(a.error)&&a.error.call(a,Q,a)}},error:function(b){l.e(b,Error(),a);q.isFunction(a.error)&&a.error.call(a,
b,a)},then:function(){x(a,b)}})};q.isNoU(b)?F("resource-loader").queue(a.componentId+":js",function(){d(A[a.componentId]=this)},a.options().priority):d(b)}else x(a,b)}function b(a){var b=a.view().innerHTML;b=p.wrapElement("div",b);b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};G.push(b);l.t(a.componentId,"bundle:added");return b}function x(a,c){A[a.componentId]=null;if(q.isNoU(a.view()))l.e(a.componentId,"component:view:undefined");else{let e=t(a.componentId);
a.options().viewDeferred?l.w(a.componentId,"component:deferred:load"):null===e?e=b(a):null==e.controller&&(e.controller=a.controller());null!=c&&c.callback(function(){l.d(a.componentId,"controller:create:deferred");N(a._c)});var d=p(a.view());null==d.attr(C.dataUiContext)&&d.attr(C.dataUiContext,a.contextId);l.d(a.componentId,"component:initializing");if(q.isFunction(a.controller())){d=a._c=new y(a);d.log=m("../helpers/Logger")(a.contextId);"function"===typeof d.init&&d.init();if(!q.isNoU(d.view()))if(null==
d.view().attr(C.dataUiComponent)&&d.view().attr(C.dataUiComponent,""),q.isNoU(a.model())&&!q.isNoU(a.view())&&a.viewToModel(),d.trigger("view:apply"),a.options().viewDeferred){a.options().viewDeferred=!1;d.saveView();null===e&&(e={componentId:a.componentId,controller:a.controller()},G.push(e),l.t(a.componentId,"bundle:added"),l.d(a.componentId,"component:deferred:load"));let b=-1;!1!==a.options().css&&(null==e.css?(-1===b&&(b=0),b++,a.loadCss({caching:H,success:function(c){null==e.css&&(e.css=c);
l.d(a.componentId,"component:deferred:css",b)},then:function(){0===--b&&null!=c&&c.end()}})):a.style(e.css));!1!==a.options().html&&(null==e.view?(-1===b&&(b=0),b++,a.loadHtml({cext:a.options().cext,caching:H,success:function(c){null==e.view&&(e.view=c);l.d(a.componentId,"component:deferred:html",b)},error:function(b){l.e(b,a);q.isFunction(a.options().error)&&a.options().error.call(a,b,a)},then:function(){0===--b&&null!=c&&c.end()}})):a.view(e.view));-1===b&&null!=c&&c.end()}else null!=c&&c.end();
null==c&&(l.d(a.componentId,"controller:create"),N(d))}else l.w(a.componentId,"component:controller:undefined")}}function N(b){l.t(b.context.componentId,"controller:init","timer:init:start");b.view().find(q.dom.queryAttribute(C.dataUiLoaded,"false",q.dom.cssNot(C.dataUiComponent))).each(function(a,b){this.attr(C.dataUiLoaded,null)});b.field=function(a){a=f(a,b.view(),b);a.on=function(a,c,d,e){if("string"===typeof c){const a=c;c=function(){b.trigger(a,d,e)}}return p.ZxQuery.prototype.on.call(this,
a,c)};return a};q.isFunction(b.create)&&b.create();b.trigger("view:create");q.isFunction(b.context.ready)&&b.context.ready.call(b.context,b.context);b.trigger("component:ready",b.view(),!0);b.context.isReady=!0;l.t(b.context.componentId,"controller:init","timer:init:stop");l.i(b.context.componentId,"component:loaded",b.context.contextId);if(null!=B[b.context.componentId]){const c=B[b.context.componentId];B[b.context.componentId]=null;let d;for(;null!=c&&null!=(d=c.shift());)a(d.c,d.o)}zuix.componentize(b.view())}
function M(a){let b=function(a){};if("string"===typeof a)try{b=eval.call(this,a)}catch(S){l.e(this,S,a)}return b}const l=m("../helpers/Logger")("Zuix.js"),q=m("../helpers/Util"),p=m("../helpers/ZxQuery"),D=m("../helpers/TaskQueue");v=m("../helpers/ObjectObserver");const E=m("./ComponentContext"),y=m("./ContextController"),w=m("./Componentizer")(),C=m("./OptionAttributes");m("./ComponentCache");const K=[],L=[],I={},J=[],B={},A=[],F=function(a){q.isNoU(J[a])&&(J[a]=new D(function(a,b,c){n(a,b,c)}));
return J[a]};let G=[],O=0,H=!0;const R=new v;e.prototype.field=function(a,b){return f.call(this,a,b)};e.prototype.load=function(b,c){{b=w.resolvePath(b);let d;q.isNoU(c)?(c={},d=new E(zuix,c,n)):(c.componentId=b,q.isNoU(c.contextId)?(!1===c&&(c={}),c.contextId="zuix-ctx-"+ ++O,d=h(c)):(d=r(c.contextId),null!==d?d.options(c):d=h(c)));d.componentId!=b&&(d.componentId=b);q.isFunction(c.ready)&&(d.ready=c.ready);q.isFunction(c.error)&&(d.error=c.error);null==A[b]?(A[b]=!0,c=a(d,c)):(null==B[b]&&(B[b]=
[]),B[b].push({c:d,o:c}),c=d)}return c};e.prototype.unload=function(a){if(a instanceof Element){const b=a;a=zuix.context(b);w.dequeue(b)}q.isNoU(a)||a.dispose();return this};e.prototype.controller=function(a){return k.call(this,a)};e.prototype.context=function(a,b){return r.call(this,a,b)};e.prototype.createComponent=function(a,b){null==b&&(b={});q.isNoU(b.contextId)&&(b.contextId="zuix-ctx-"+ ++O);if(null!=r(b.contextId))throw Error("Context arelady exists.");b.container=document.createElement("div");
b.componentId=a;w.applyOptions(b.container,b);return h(b)};e.prototype.trigger=function(a,b,c){n(a,b,c);return this};e.prototype.hook=function(a,b){q.isNoU(b)?delete L[a]:L[a]=b;return this};e.prototype.using=function(a,b,c){b=w.resolvePath(b);a=a.toLowerCase();const d=a+"-"+b.hashCode();if("component"===a)a=r(d),null==a?zuix.load(b,{contextId:d,view:"",priority:-10,ready:function(a){"function"===typeof c&&c(b,a)},error:function(){c(b,null)}}):"function"===typeof c&&c(b,a);else{const e="style"===
a;if(0===p.find(a+'[id="'+d+'"]').length()){const f=document.head||document.getElementsByTagName("head")[0],g=document.createElement(a);g.type=e?"text/css":"text/javascript";g.id=d;f.appendChild(g);const h=function(a){e?g.styleSheet?g.styleSheet.cssText=a:g.appendChild(document.createTextNode(a)):g.innerText?g.innerText=a:g.appendChild(document.createTextNode(a));c&&c(b,d)},k="_res/"+a+"/"+d;a=t(k);null!=a?h(e?a.css:a.controller):p.ajax({url:b,success:function(a){G.push({componentId:k,view:null,css:e?
a:null,controller:e?null:a,using:b});h(a)},error:function(){f.removeChild(g);c&&c(b)}})}else c&&c(b,d)}};e.prototype.lazyLoad=function(a,b){if(null!=a)w.lazyLoad(a,b);else return w.lazyLoad();return this};e.prototype.httpCaching=function(a){if(null!=a)d(a);else return d();return this};e.prototype.componentize=function(a){w.componentize(a);return this};e.prototype.store=function(a,b){null!=b&&(this._store[a]=b);return this._store[a]};e.prototype.getResourcePath=function(a){return c(a)};e.prototype.observable=
function(a){return R.observable(a)};e.prototype.bundle=function(a,b){if(q.isNoU(a))return G;if(a&&"boolean"===typeof a){l.t("bundle:start");const c=w.lazyLoad();w.lazyLoad(!1);w.componentize();"function"===typeof b&&(a=function(a){setTimeout(function(){w.willLoadMore()?(l.t("bundle:wait"),a(a)):(l.t("bundle:end"),w.lazyLoad(c),b())},1E3)},a(a))}else{for(let b=0;b<a.length;b++)a[b].css_applied&&delete a[b].css_applied,"string"===typeof a[b].controller&&(a[b].controller=eval(a[b].controller));G=a}return this};
e.prototype.$=p;e.prototype.TaskQueue=D;e.prototype.ObjectObserver=v;e.prototype.ZxQuery=p.ZxQuery;e.prototype.dumpCache=function(){return G};e.prototype.dumpContexts=function(){return K};u.exports=function(a){const b=new e;"loading"!=document.readyState?b.componentize():document.addEventListener("DOMContentLoaded",function(){b.componentize()});l.monitor(function(a,c){q.isFunction(b.monitor)&&b.monitor(a,Array.prototype.slice.call(c))});return b}},{"../helpers/Logger":2,"../helpers/ObjectObserver":3,
"../helpers/TaskQueue":4,"../helpers/Util":5,"../helpers/ZxQuery":6,"./ComponentCache":8,"./ComponentContext":9,"./Componentizer":10,"./ContextController":11,"./OptionAttributes":12}]},{},[7])(7)});
//# sourceMappingURL=zuix.min.js.map
