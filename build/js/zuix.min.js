/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.
         https://genielabs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';!function(C){if("object"==typeof exports)module.exports=C();else if("function"==typeof define&&define.amd)define(C);else{var m;"undefined"!=typeof window?m=window:"undefined"!=typeof global?m=global:"undefined"!=typeof self&&(m=self);m.zuix=C()}}(function(){return function m(p,t,d){function k(a,c){if(!t[a]){if(!p[a]){var f="function"==typeof require&&require;if(!c&&f)return f(a,!0);if(b)return b(a,!0);throw Error("Cannot find module '"+a+"'");}f=t[a]={exports:{}};p[a][0].call(f.exports,
function(b){var e=p[a][1][b];return k(e?e:b)},f,f.exports,m,p,t,d)}return t[a].exports}for(var b="function"==typeof require&&require,c=0;c<d.length;c++)k(d[c]);return k}({1:[function(m,p,t){function d(c){k=window?window.console:{};b=window?window:{};this._timers={};this.args=function(a,b,e){a="%c "+b+" %c"+(new Date).toISOString()+" %c"+a;b=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];
for(var g=0;g<e.length;g++)if("string"==typeof e[g]&&0==e[g].indexOf("timer:")){var c=e[g].split(":");if(3==c.length)switch(c[2]){case "start":this._timers[c[1]]=(new Date).getTime();a+=" %cSTART "+c[1];b.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":a+=" %cSTOP "+c[1]+" "+((new Date).getTime()-this._timers[c[1]])+" ms",b.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}a+=" \n%c ";b.push("background-color:transparent;color:inherit;");for(g=b.length-
1;0<=g;g--)Array.prototype.unshift.call(e,b[g]);Array.prototype.unshift.call(e,a);Array.prototype.push.call(e,"\n\n")};this.log=function(d,h){"function"===typeof a&&a.call(c,d,h);this.args(c,d,h);b.zuixNoConsoleOutput||k.log.apply(k,h)}}var k=null,b=null,c="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" "),a=null;d.prototype.monitor=function(b){a=b};d.prototype.console=function(a){if(a)window.console=
k;else for(window.console={},a=0;a<c.length;a++)window.console[c[a]]||(window.console[c[a]]=function(){})};d.prototype.i=d.prototype.info=d.prototype.l=d.prototype.log=function(){this.log("INFO",arguments);return this};d.prototype.w=d.prototype.warn=function(){this.log("WARN",arguments);return this};d.prototype.e=d.prototype.error=function(){this.log("ERROR",arguments);return this};d.prototype.d=d.prototype.debug=function(){this.log("DEBUG",arguments);return this};d.prototype.t=d.prototype.trace=
function(){this.log("TRACE",arguments);return this};p.exports=function(a){return new d(a)}},{}],2:[function(m,p,t){function d(b){var c=this;c._worker=null;c._taskList=[];c._requests=[];null==b&&(b=function(){});c.taskQueue=function(a,d,f){c._taskList.push({tid:a,fn:d,status:0,priority:f,step:function(a){k.t(a,"load:step");b(c,"load:step",{task:a})},end:function(){this.status=2;k.t(this.tid,"load:next","timer:task:stop");b(c,"load:next",{task:this.tid});c._taskList.splice(this.index,1);c.taskCheck();
null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});k.t(a,"task added",f,"priority");c._taskList.sort(function(a,b){return a.priority>b.priority?1:b.priority>a.priority?-1:0});c.taskCheck()};c.taskCheck=function(){for(var a=0;a<c._taskList.length;a++){if(0==c._taskList[a].status){c._taskList[a].status=1;k.t(c._taskList[a].tid,"load:begin","timer:task:start");b(c,"load:begin",{task:c._taskList[a].tid});c._taskList[a].index=a;c._taskList[a].fn.call(c._taskList[a]);
return}if(1==c._taskList[a].status||2==c._taskList[a].status)return}k.t("load:end");b(c,"load:end")}}var k=m("./Logger")("TaskQueue.js");d.prototype.queue=function(b,c,a){return this.taskQueue(b,c,a)};d.prototype.requestLock=function(b){return null!=b._taskerLock?!1:b._taskerLock=!0};d.prototype.releaseLock=function(b){delete b._taskerLock};d.prototype.lockLater=function(b,c,a){var d=this;null==b._taskerLock?c():null==b._taskerTimeout&&(b._taskerTimeout=!0,b._taskerTimeout=setTimeout(function(){delete b._taskerTimeout;
d.lockLater(b,c,a)},a));return!0};p.exports=d},{"./Logger":1}],3:[function(m,p,t){p.exports={isIE:function(){return 0<window.navigator.userAgent.indexOf("Trident")},isNoU:function(d){return"undefined"===typeof d||null===d},isFunction:function(d){return"function"===typeof d},objectEquals:function(d,k){if(null===d||void 0===d||null===k||void 0===k)return d===k;if(d.constructor!==k.constructor)return!1;if(d instanceof Function||d instanceof RegExp)return d===k;if(d===k||d.valueOf()===k.valueOf())return!0;
if(Array.isArray(d)&&d.length!==k.length||d instanceof Date||!(d instanceof Object)||!(k instanceof Object))return!1;var b=Object.keys(d);return Object.keys(k).every(function(c){return-1!==b.indexOf(c)})&&b.every(function(b){return util.objectEquals(d[b],k[b])})},propertyFromPath:function(d,k){if("string"===typeof k){k=k.replace(/\[(\w+)]/g,".$1");k=k.replace(/^\./,"");for(var b=k.split("."),c=d,a=0,v=b.length;a<v;++a){var f=b[a];if("undefined"!==typeof c[f])c=c[f];else return}return c}},cloneObject:function k(b){if(null===
b||"object"!==typeof b)return b;var c=b.constructor(),a;for(a in b)c[a]=k(b[a]);return c},evalJs:eval}},{}],4:[function(m,p,t){function d(a){c(this,a.type,a)}function k(a,b,c){var f=!1;e.each(h,function(){if(this.element===a&&this.path===b&&this.handler==c)return v.w("Handler already registered",a,b,c),f=!0,!1});f||(h.push({element:a,path:b,handler:c}),a.addEventListener(b,d,!1))}function b(a,b,c){var f=1,z=-1;e.each(h,function(e){this.element===a&&this.path===b&&this.handler==c&&(f--,z=e)});-1!==
z&&h.splice(z,1);0==f&&a.removeEventListener(b,d)}function c(a,b,c){var d=e(a);e.each(h,function(){this.element===a&&this.path===b&&this.handler.call(d,c)})}function a(g){this._selection=[];"undefined"===typeof g&&(g=document.documentElement);if(g instanceof a)return g;if(g instanceof HTMLCollection||g instanceof NodeList||Array.isArray(g))this._selection=g;else if(g instanceof HTMLElement||g instanceof Node)this._selection=[g];else if("string"===typeof g)this._selection=document.documentElement.querySelectorAll(g);
else if(null!==g)throw v.e("ZxQuery cannot wrap object of this type.",typeof g,g),Error(),g;return this}var v=m("./Logger")("TaskQueue.js"),f=m("./Util.js"),h=[];a.prototype.length=function(){return this._selection.length};a.prototype.parent=function(g){return f.isNoU(g)?new a(this._selection[0].parentNode):new a(e.getClosest(this._selection[0],g))};a.prototype.children=function(g){return f.isNoU(g)?new a(this._selection[0].children):new a(this._selection[0].querySelectorAll(g))};a.prototype.reverse=
function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};a.prototype.get=function(a){f.isNoU(a)&&(a=0);return this._selection[a]};a.prototype.eq=function(g){var b=this._selection,c=b[g];1<arguments.length&&(c=[],e.each(arguments,function(a,g){null!=b[g]&&c.push(b[g])}));return new a(c)};a.prototype.find=function(g){return new a(this._selection[0].querySelectorAll(g))};a.prototype.each=function(a){e.each(this._selection,a);return this};a.prototype.attr=function(a,
b){var c=this;if("object"===typeof a)e.each(a,function(a,g){c.each(function(b,c){c.setAttribute(a,g)})});else{if(f.isNoU(b))return this._selection[0].getAttribute(a);this.each(function(c,e){this.get().setAttribute(a,b)})}return this};a.prototype.trigger=function(a,b){var c;window.CustomEvent?c=new CustomEvent(a,{detail:b}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!0,!0,b));this.each(function(a,g){g.dispatchEvent(c)});return this};a.prototype.one=function(a,b){var c=!1;this.on(a,
function(d,f){c||(c=!0,e(this).off(a,b),b.call(this,d,f))});return this};a.prototype.on=function(a,b){var c=a.match(/\S+/g)||[];this.each(function(a,g){e.each(c,function(a,c){"body"===g.tagName.toLowerCase()&&(g=document);k(g,c,b)})});return this};a.prototype.off=function(a,c){var d=a.match(/\S+/g)||[];this.each(function(a,g){e.each(d,function(a,d){"body"===g.tagName.toLowerCase()&&(g=document);b(g,d,c)})});return this};a.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,
"").length};a.prototype.position=function(){return null!=this._selection[0]?e.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};a.prototype.css=function(a,b){var c=this;if("object"===typeof a)e.each(a,function(a,g){c.each(function(b,c){c.style[a]=g})});else{if(f.isNoU(b))return this._selection[0].style[a];c.each(function(c,d){d.style[a]=b})}return this};a.prototype.addClass=function(a){var b=a.match(/\S+/g)||[];e.each(this._selection,function(c,d){d.classList?e.each(b,function(a,g){d.classList.add(g)}):
d.className+=" "+a});return this};a.prototype.hasClass=function(a){return e.hasClass(this._selection[0],a)};a.prototype.removeClass=function(a){var b=a.match(/\S+/g)||[];e.each(this._selection,function(c,d){d.classList?e.each(b,function(a,g){d.classList.remove(g)}):d.className=d.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")});return this};a.prototype.prev=function(){return new a(this._selection[0].previousElementSibling)};a.prototype.next=function(){return new a(this._selection[0].nextElementSibling)};
a.prototype.html=function(a){if(f.isNoU(a))return this._selection[0].innerHTML;this.each(function(b,c){c.innerHTML=a});return this};a.prototype.append=function(a){"string"===typeof a?this._selection[0].innerHTML+=a:this._selection[0].appendChild(a);return this};a.prototype.insert=function(a,b){var c=this.children().get(a);null!==c?this._selection[0].insertBefore(b,c):this._selection[0].appendChild(b);return this};a.prototype.prepend=function(a){"string"===typeof a?this._selection[0].innerHTML=a+this._selection[0].innerHTML:
this._selection[0].insertBefore(a,this._selection[0].firstElementChild);return this};a.prototype.display=function(a){if(f.isNoU(a))return this._selection[0].style.display;e.each(this._selection,function(b,c){c.style.display=a});return this};a.prototype.visibility=function(a){if(f.isNoU(a))return this._selection[0].style.visibility;e.each(this._selection,function(b,c){c.style.visibility=a});return this};a.prototype.show=function(){return this.display("")};a.prototype.hide=function(){return this.display("none")};
var e=function(g){return new a(g)};e.find=function(a){return e().find(a)};e.each=function(a,b){var c=null==a?0:Object.keys(a).length;if(0<c){var d=0,f;for(f in a){var h=a[f];h instanceof Element&&(h=e(h));if(!1===b.call(h,f,a[f]))break;d++;if(d>=c)break}}return this};e.hasClass=function(a,b){var c=b.match(/\S+/g)||[],d=!1;e.each(c,function(b,c){if(d=a.classList?a.classList.contains(c):(new RegExp("(^| )"+c+"( |$)","gi")).test(a.className))return!1});return d};e.ajax=function(a){var b;b=f.isNoU(a)||
f.isNoU(a.url)?a:a.url;var c=new XMLHttpRequest;c.open("GET",b);c.onload=function(){200===c.status?f.isFunction(a.success)&&a.success(c.responseText):f.isFunction(a.error)&&a.error(c);f.isFunction(a.then)&&a.then(c)};c.send();return this};e.wrapElement=function(a,c){var b=document.createElement(a);"string"===typeof c?b.innerHTML=c:b.appendChild(c);return b};e.wrapCss=function(a,c){for(var b=/([.,\w])([^/{};]+)({)/g,d,f=null,h="";d=b.exec(c);){if(null!=f){var f=c.substring(f.index,d.index),k=/(.*)[^s]\{([^\}]+)[\}]/g.exec(f);
if(null!=k&&1<k.length){var m=k[1].split(",");e.each(m,function(c,b){h+="\n"+a+"\n"+b;c<m.length-1&&(h+=", ")});h+=" {"+k[2]+"}\n"}else v.w("ZUIX WARNING: z$.wrapCss was unable to parse rule.",k,f)}f=d}null!=f&&(h+=a+" "+c.substring(f.index));""!=h&&(c=h);return c};e.appendCss=function(a,c,b){var d=null,e;"string"===typeof a?(e=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style"),d.type="text/css",d.id=b,d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a))):
a instanceof Element&&(d=a);f.isNoU(c)||e.removeChild(c);f.isNoU(d)||e.appendChild(d);return d};e.getClosest=function(a,c){for(;a&&a!==document;a=a.parentNode)if(a.matches(c))return a;return null};e.getPosition=function(a){for(var c=e.isInView(a),b=0,d=0;a;){if("BODY"==a.tagName)var f=a.scrollTop||document.documentElement.scrollTop,b=b+(a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+a.clientLeft),d=d+(a.offsetTop-f+a.clientTop);else b+=a.offsetLeft-a.scrollLeft+a.clientLeft,d+=a.offsetTop-
a.scrollTop+a.clientTop;a=a.offsetParent}return{x:b,y:d,visible:c}};e.isInView=function(a){if(null===a.offsetParent)return!1;a=a.getBoundingClientRect();return 0<a.bottom&&0<a.right&&a.left<(window.innerWidth||document.documentElement.clientWidth)&&a.top<(window.innerHeight||document.documentElement.clientHeight)};e.ZxQuery=a;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||
Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var c=a.length;0<=--c&&a.item(c)!==this;);return-1<c});(function(){function a(c,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(c,b.bubbles,b.cancelable,b.detail);return d}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();p.exports=e},{"./Logger":1,"./Util.js":3}],
5:[function(m,p,t){m=m("./zuix/Zuix.js");"object"===typeof p&&p.exports?p.exports=m.call(this):this.zuix=m.call(this)},{"./zuix/Zuix.js":8}],6:[function(m,p,t){function d(a,c){this._options=null;this.contextId=null==a||null==a.contextId?null:a.contextId;this.componentId=null;this.trigger=function(a,b,d){"function"===typeof c&&c(a,b,d)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(a);
return this}var k=m("../helpers/Logger")("ComponentContext.js"),b=m("../helpers/ZxQuery"),c=m("../helpers/Util");d.prototype.container=function(a){if(null==a)return this._container;a instanceof b.ZxQuery&&(a=a.get());this._container=a;return this};d.prototype.view=function(a){if("undefined"===typeof a)return this._view;a instanceof b.ZxQuery&&(a=a.get());"string"===typeof a?(a={content:a},this.trigger(this,"html:parse",a),a=a.content,null!=this._container?(this._view=this._container,this._view.innerHTML+=
a):(a=b.wrapElement("div",a),null!=this._view?this._view.innerHTML=a.innerHTML:this._view=a),b(this._view).find("script").each(function(a,c){"true"!==this.attr("zuix-loaded")&&(this.attr("zuix-loaded","true"),eval.call(window,c.innerHTML))}),this.trigger(this,"view:process",b(this._view))):(a instanceof b.ZxQuery&&(a=a.get()),null!=this._container?(this._view=b.wrapElement("div",a.outerHTML).firstElementChild,this._view.removeAttribute("data-ui-view"),this._container.appendChild(this._view),this._view=
this._container):this._view=a);a=b(this._view);!1===this._options.css?a.addClass("zuix-css-ignore"):a.removeClass("zuix-css-ignore");this.modelToView();return this};d.prototype.style=function(a){if("undefined"===typeof a)return this._style;null==a||a instanceof Element?(this._css=a instanceof Element?a.innerText:a,this._style=b.appendCss(a,this._style,this.componentId)):"string"===typeof a&&(this._css=a,a=b.wrapCss('[data-ui-component="'+this.componentId+'"]:not(.zuix-css-ignore)',a),a={content:a},
this.trigger(this,"css:parse",a),a=a.content,this._style=b.appendCss(a,this._style,this.componentId));return this};d.prototype.model=function(a){if("undefined"===typeof a)return this._model;this._model=a;this.modelToView();null!=this._c&&c.isFunction(this._c.update)&&this._c.update.call(this._c);return this};d.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};d.prototype.options=function(a){if(null==a)return this._options;var c=this._options=
this._options||{};b.each(a,function(a,b){c[a]=b});null!=c.componentId&&(this.componentId=c.componentId);this.container(c.container);this.view(c.view);"undefined"!==typeof c.css&&this.style(c.css);this.controller(c.controller);this.model(c.model);c.lazyLoad&&null!=this.container()&&(this.container().setAttribute("data-ui-context",this.contextId),this.container().setAttribute("data-ui-load",this.componentId),this.container().setAttribute("data-ui-lazyload","true"));return this};d.prototype.on=function(a,
c){this._c.on(a,c);return this};d.prototype.loadCss=function(a,d){var f=this;c.isNoU(a)&&(a={});c.isNoU(a.caching)||(d=a.caching);var h=f.componentId+".css";c.isNoU(a.path)||(h=a.path);d||(h+="?"+(new Date).getTime());b.ajax({url:h,success:function(b){f.style(b);c.isFunction(a.success)&&a.success.call(f,b)},error:function(b){k.e(b,f);c.isFunction(a.error)&&a.error.call(f,b)},then:function(){c.isFunction(a.then)&&a.then.call(f)}});return this};d.prototype.loadHtml=function(a,d){var f=this,h=f.componentId;
c.isNoU(a)&&(a={});c.isNoU(a.caching)||(d=a.caching);c.isNoU(a.path)||(h=a.path);var e=b().find('[data-ui-view="'+h+'"]:not([data-ui-component*=""])');0<e.length()?(h=e.get(0),f.view()===h||null!=f.container()&&f.container().contains(h)?f.view(h):f.view(h.outerHTML),h=f.view().innerHTML,c.isFunction(a.success)&&a.success.call(f,h),c.isFunction(a.then)&&a.then.call(f)):(h==f.componentId&&(h+=".html"+(d?"":"?"+(new Date).getTime())),b.ajax({url:h,success:function(b){f.view(b);c.isFunction(a.success)&&
a.success.call(f,b)},error:function(b){k.e(b,f);c.isFunction(a.error)&&a.error.call(f,b)},then:function(){c.isFunction(a.then)&&a.then.call(f)}}));return this};d.prototype.viewToModel=function(){var a=this;this._model={};b(this._view).find("[data-ui-field]").each(function(b,d){if(0<this.parent("pre,code").length())return!0;var h=this.attr("data-ui-field"),e=!c.isNoU(d.innerHTML)&&c.isIE()?d.cloneNode(!0):d;if(0<h.indexOf(".")){for(var h=h.split("."),g=a._model,k=0;k<h.length-1;k++)"undefined"===typeof g[h[k]]&&
(g[h[k]]={}),g=g[h[k]];g[h[h.length-1]]=e}else a._model[h]=e});return this};d.prototype.modelToView=function(){if(null!=this._view&&null!=this._model){var a=this;b(this._view).find("[data-ui-field]").each(function(d,f){if(0<this.parent("pre,code").length())return!0;var h=this.attr("data-bind-to");null==h&&(h=this.attr("data-ui-field"));if("function"===typeof a._model)a._model.call(b(a._view),this,h);else{var e=c.propertyFromPath(a._model,h);if("function"===typeof e)e.call(b(a._view),this,h);else if(null!=
e)switch(f.tagName.toLowerCase()){case "img":f.src=c.isNoU(e.src)?c.isNoU(e.innerHTML)?e:e.innerHTML:e.src;e.alt&&(f.alt=e.alt);break;case "a":f.href=c.isNoU(e.href)?c.isNoU(e.innerHTML)?e:e.innerHTML:e.href;e.title&&(f.title=e.title);break;case "input":f.value=c.isNoU(e.value)?c.isNoU(e.innerHTML)?e:e.innerHTML:e.value;break;default:f.innerHTML=c.isNoU(e.innerHTML)?e:e.innerHTML}}})}return this};p.exports=d},{"../helpers/Logger":1,"../helpers/Util":3,"../helpers/ZxQuery":4}],7:[function(m,p,t){function d(b){var c=
this;this._view=null;this.context=b;this._fieldCache=[];this.destroy=this.create=this.init=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,b){c._childNodes.push(b)})};this.restoreView=function(){0<this._childNodes.length&&(c.view().html(""),k.each(c._childNodes,function(a,b){c.view().append(b)}),this._childNodes.length=0)};this.on=function(a,c){this.addEvent(this.view(),a,c);return this};this.mapEvent=function(a,c,b,d){null!=c&&(c.off(b,
this.eventRouter),a[b]=d,c.on(b,this.eventRouter))};this.eventRouter=function(a){"function"===typeof b._behaviorMap[a.type]&&b._behaviorMap[a.type].call(c.view(),a,a.detail);"function"===typeof b._eventMap[a.type]&&b._eventMap[a.type].call(c.view(),a,a.detail)};var a=b.options(),d=null;if(null!=a.on)for(var f in a.on)d=a.on[f],c.addEvent(c.view(),f,d);if(null!=a.behavior)for(var h in a.behavior)d=a.behavior[h],c.addBehavior(c.view(),h,d);b.controller().call(this,this);return this}var k=m("../helpers/ZxQuery");
d.prototype.addEvent=function(b,c,a){this.mapEvent(this.context._eventMap,b,c,a);return this};d.prototype.addBehavior=function(b,c,a){this.mapEvent(this.context._behaviorMap,b,c,a);return this};d.prototype.field=function(b){return null};d.prototype.clearCache=function(){this._fieldCache.length=0};d.prototype.view=function(b){if(null!=this.context.view()||this._view!==this.context.view())this.clearCache(),this._view=k(this.context.view());if(null!=b)return this._view.find(b);if(null!==this._view)return this._view;
throw{message:"Not attacched to a view yet.",source:this};};d.prototype.model=function(b){if(null==b)return this.context.model();this.context.model(b);return this};d.prototype.options=function(){return this.context.options()};d.prototype.trigger=function(b,c,a){null==this.context._eventMap[b]&&!0!==a&&this.addEvent(this.view(),b,null);!0===a?(a=this.context.container(),null==a&&(a=this.context.view()),null!=a&&k(a).trigger(b,c),this.context.trigger(this.context,b,c)):this.view().trigger(b,c);return this};
d.prototype.expose=function(b,c){if("object"===typeof b){var a=this;k.each(b,function(c,b){a.context[c]=b})}else this.context[b]=c;return this};d.prototype.loadCss=function(b){this.context.loadCss(b);return this};d.prototype.loadHtml=function(b){this.saveView();this.context.loadHtml(b);return this};d.prototype.log={};d.prototype.for=function(b){return this};p.exports=d},{"../helpers/ZxQuery":4}],8:[function(m,p,t){function d(){this._fieldCache=[];return this}function k(a,c,b){l.isNoU(b)&&(b=this);
null==b._fieldCache&&(b._fieldCache={});var d=null;"undefined"===typeof b._fieldCache[a]?(d=q(c).find('[data-ui-field="'+a+'"]'),null!=d&&(b._fieldCache[a]=d)):d=b._fieldCache[a];return d}function b(a){n.t("componentize:check","lock:request");if(A("zuix").requestLock(b)){n.t("componentize:begin","timer:task:start",a,w.length);var d=q(a).find("[data-ui-load]:not([data-ui-loaded=true]),[data-ui-include]:not([data-ui-loaded=true])"),d=Array.prototype.slice.call(d._selection);d.sort(function(a,b){var c=
parseInt(a.getAttribute("data-ui-priority"));isNaN(c)&&(c=0);var r=parseInt(b.getAttribute("data-ui-priority"));isNaN(r)&&(r=0);return c-r});n.t("componentize:count",d.length);q.each(d,function(a,r){this.visibility("hidden");var d=r.lazyContainer||q.getClosest(r,"[data-ui-lazyload=scroll]");r.lazyContainer=d;if(!(null!=d&&"force"==d.getAttribute("data-ui-lazyload")||g()&&"false"!=this.attr("data-ui-lazyload")))return c(r),!1;if(null!==d&&(-1==F.indexOf(d)&&(F.push(d),q(d).on("scroll",function(){b(d)})),
!q.getPosition(r).visible))return-1==w.indexOf(r)&&(n.t("componentize:lazyload","queue:add",r),w.push(r)),!0;n.t("componentize:lazyload","queue:load",r);c(r)});n.t("componentize:end","timer:task:end",a,B.length,x.length);A("zuix").releaseLock(b)}null!=d&&d.length>w.length&&A("zuix").lockLater(b,function(){b(a)},200)}function c(c){var b=q(c);if("true"===b.attr("data-ui-loaded")||0<b.parent("pre,code").length())n.w("Skipped",c);else{b.attr("data-ui-loaded","true");var d=b.attr("data-ui-options");l.isNoU(d)?
d={}:(d=l.propertyFromPath(window,d),d=l.cloneObject(d)||{});l.isNoU(d.view)&&!b.isEmpty()?(d.view=c,d.viewDeferred=!0):l.isNoU(d.view)&&l.isNoU(d.container)&&b.isEmpty()&&(d.container=c);var e=b.attr("data-ui-load");l.isNoU(e)&&(e=b.attr("data-ui-include"),b.attr("data-ui-component",e),l.isNoU(d.controller)&&(d.controller=function(){}));var f=b.attr("data-bind-model");!l.isNoU(f)&&0<f.length&&(d.model=l.propertyFromPath(window,f));f=b.attr("data-ui-context");l.isNoU(f)||(d.contextId=f);b=b.attr("data-ui-priority");
l.isNoU(b)?d.priority=B.length:d.priority=b;a(e,d);d=w.indexOf(c);n.t("componentize:lazyload","queue:remove",d,c);-1<d&&w.splice(d,1)}}function a(a,b){var c=null;l.isNoU(b)?(b={},c=new N(b,e)):(b.componentId=a,l.isNoU(b.contextId)?(!1===b&&(b={}),b.contextId="zuix-ctx-"+ ++R,c=f(b)):(c=h(b.contextId),null!==c?c.options(b):c=f(b)));c.componentId!=a&&(c.componentId=a);l.isFunction(b.ready)&&(c.ready=b.ready);l.isFunction(b.error)&&(c.error=b.error);if(b.lazyLoad)return c;if(null==u[a])return u[a]=!0,
v(c,b);var d=setInterval(function(){null==u[a]&&(u[a]=!0,clearInterval(d),v(c,b))},100);return c}function v(a,b){var c=L(a.componentId);null!==c&&null==b.controller&&null==a.controller()&&(a.controller(c.controller),n.t("js:"+a.componentId,"component:cached:js"));if(l.isNoU(b.view)){if(null!==c&&null!=c.view&&(a.view(c.view),n.t("html:"+a.componentId,"component:cached:html"),null!=c.view&&l.isNoU(b.css)&&(b.css=!1,c.css_applied||(c.css_applied=!0,a.style(c.css),n.t("css:"+a.componentId,"component:cached:css")))),
l.isNoU(a.view()))return A("resource-loader").queue("html:"+a.componentId,function(){u[a.componentId]=this;a.loadHtml({caching:y,success:function(d){null==c&&(c=z(a));c.view=d;delete c.controller;!1!==b.css?(u[a.componentId].step("css:"+a.componentId),a.loadCss({caching:y,success:function(a){c.css=a},error:function(b){n.e(b,a)},then:function(){D(a,u[a.componentId])}})):D(a,u[a.componentId])},error:function(c){n.e(c,a);l.isFunction(b.error)&&a.error.call(a,c)}})},b.priority),a}else a.view(b.view);
A("resource-loader").queue("js:"+a.componentId,function(){u[a.componentId]=this;D(a,u[a.componentId])},B.length);return a}function f(a){a=new N(a,e);B.push(a);return a}function h(a){var b=null;a instanceof q.ZxQuery&&(a=a.get());q.each(B,function(c,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||l.objectEquals(d.contextId,a))return b=d,!1});return b}function e(a,c,d){l.isFunction(G[c])&&G[c].call(a,d);"view:process"==c&&b(d)}function g(a){null!=a&&(O=!a);return!H&&!O}function K(a){null!=
a&&(y=a);return y}function L(a){var b=null;q.each(x,function(c,d){if(l.objectEquals(d.componentId,a))return b=d,!1});return b}function D(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(n.d(a.componentId,"controller:load"),l.isNoU(b)||b.step("js:"+a.componentId),l.isFunction(I[a.componentId]))a.controller(I[a.componentId]),E(a,b);else{var c=function(b){q.ajax({url:a.componentId+".js"+(y?"":"?"+(new Date).getTime()),success:function(b){try{var c=b.indexOf("function"),d=
b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-4));var e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+11));var f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+'.js"\n';a.controller(Q(b))}catch(g){n.e(Error(),g,b,a),l.isFunction(a.error)&&a.error.call(a,g)}},error:function(b){n.e(b,Error(),a);l.isFunction(a.error)&&a.error.call(a,b)},then:function(){E(a,b)}})};l.isNoU(b)?A("resource-loader").queue("js:"+a.componentId,function(){c(u[a.componentId]=
this)},a.options().priority):c(b)}else E(a,b)}function z(a){var b=a.view().innerHTML,b=q.wrapElement("div",b),b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};x.push(b);n.t(a.componentId,"bundle:added");return b}function E(a,b){u[a.componentId]=null;if(l.isNoU(a.view()))n.e(a.componentId,"component:view:undefined");else{var c=L(a.componentId);a.options().viewDeferred||(null===c?c=z(a):null==c.controller?c.controller=a.controller():n.w(a.componentId,"component:deferred:load"));
null!=b&&b.callback(function(){n.d(a.componentId,"controller:create:deferred");M(a._c)});n.d(a.componentId,"component:initializing");if(l.isFunction(a.controller())){var d=a._c=new S(a);d.log=m("../helpers/Logger")(a.contextId);"function"===typeof d.init&&d.init();if(!l.isNoU(d.view()))if(d.view().attr("data-ui-component",a.componentId),l.isNoU(a.model())&&!l.isNoU(a.view())&&a.viewToModel(),d.trigger("view:apply"),a.options().viewDeferred){a.options().viewDeferred=!1;d.saveView();null===c&&(c={componentId:a.componentId,
controller:a.controller()},x.push(c),n.t(a.componentId,"bundle:added"),n.d(a.componentId,"component:deferred:load"));var e=-1;!1!==a.options().css&&(null==c.css?(-1==e&&(e=0),e++,a.loadCss({caching:y,success:function(b){null==c.css&&(c.css=b);n.d(a.componentId,"component:deferred:css",e)},then:function(){0===--e&&null!=b&&b.end()}})):a.style(c.css));!1!==a.options().html&&(null==c.view?(-1==e&&(e=0),e++,a.loadHtml({caching:y,success:function(b){null==c.view&&(c.view=b);n.d(a.componentId,"component:deferred:html",
e)},then:function(){0===--e&&null!=b&&b.end()}})):a.view(c.view));-1==e&&null!=b&&b.end()}else null!=b&&b.end();null==b&&(n.d(a.componentId,"controller:create"),M(d))}else n.w(a.componentId,"component:controller:undefined")}}function M(a){a.field=function(b){b=k(b,a.view(),a);b.on=function(b,c,d,e){if("string"===typeof c){var f=c;c=function(){a.trigger(f,d,e)}}return q.ZxQuery.prototype.on.call(this,b,c)};return b};l.isFunction(a.create)&&a.create();a.trigger("view:create");a.trigger("component:ready",
a.view(),!0);l.isFunction(a.context.ready)&&a.context.ready.call(a.context);a.view().css("visibility","");n.i(a.context.componentId,"component:loaded",a.context.contextId)}function Q(a){var b=function(a){};if("string"===typeof a)try{b=eval.call(this,a)}catch(c){n.e(this,c,a)}return b}var n=m("../helpers/Logger")("Zuix.js"),l=m("../helpers/Util"),q=m("../helpers/ZxQuery"),P=m("../helpers/TaskQueue"),N=m("./ComponentContext"),S=m("./ContextController"),x=[],R=0,B=[],u=[],G=[],I={},w=[],F=[],J=[],A=
function(a){l.isNoU(J[a])&&(J[a]=new P(function(a,b,c){e(a,b,c)}));return J[a]},H=!1,O=!1,y=!0;navigator&&navigator.userAgent&&(H=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));H&&n.d(navigator.userAgent,"is a bot, ignoring 'data-ui-lazyload' option.");d.prototype.controller=function(a){"function"!==typeof a["for"]&&(a["for"]=function(b){return I[b]=a});return a};d.prototype.field=k;d.prototype.componentize=function(a){b(a);return this};d.prototype.load=a;
d.prototype.unload=function(a){l.isNoU(a)||l.isNoU(a._c)||(l.isNoU(a._c.view())||a._c.view().attr("data-ui-component",null),l.isFunction(a._c.destroy)&&a._c.destroy());return this};d.prototype.context=h;d.prototype.createComponent=function(b,c){null==c&&(c={});c.container=document.createElement("div");return a(b,c)};d.prototype.trigger=function(a,b,c){e(a,b,c);return this};d.prototype.hook=function(a,b){l.isNoU(b)||(G[a]=b);return this};d.prototype.lazyLoad=function(a){if(null!=a)g(a);else return g();
return this};d.prototype.httpCaching=function(a){if(null!=a)K(a);else return K();return this};d.prototype.bundle=function(a,c){if(l.isNoU(a))return x;if(a&&"boolean"===typeof a){n.t("bundle:start");var d=g();g(!1);b();if("function"===typeof c){var e=function(a){0<w.length?(n.t("bundle:wait"),setTimeout(function(){a(a)},1E3)):(n.t("bundle:end"),g(d),c())};e(e)}}else{for(e=0;e<a.length;e++)a[e].css_applied&&delete a[e].css_applied;x=a}return this};d.prototype.$=q;d.prototype.TaskQueue=P;d.prototype.ZxQuery=
q.ZxQuery;d.prototype.dumpCache=function(){return x};d.prototype.dumpContexts=function(){return B};d.prototype.dumpLazyLoaders=function(){return F};p.exports=function(a){var b=new d;"loading"!=document.readyState?b.componentize():document.addEventListener("DOMContentLoaded",function(){b.componentize()});n.monitor(function(a,c){l.isFunction(b.monitor)&&b.monitor(a,Array.prototype.slice.call(c))});return b}},{"../helpers/Logger":1,"../helpers/TaskQueue":2,"../helpers/Util":3,"../helpers/ZxQuery":4,
"./ComponentContext":6,"./ContextController":7}]},{},[5])(5)});
//# sourceMappingURL=zuix.min.js.map
