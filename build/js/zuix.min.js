/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.
         https://genielabs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';!function(G){if("object"==typeof exports)module.exports=G();else if("function"==typeof define&&define.amd)define(G);else{var l;"undefined"!=typeof window?l=window:"undefined"!=typeof global?l=global:"undefined"!=typeof self&&(l=self);l.zuix=G()}}(function(){return function l(r,u,b){function g(a,c){if(!u[a]){if(!r[a]){var e="function"==typeof require&&require;if(!c&&e)return e(a,!0);if(f)return f(a,!0);throw Error("Cannot find module '"+a+"'");}e=u[a]={exports:{}};r[a][0].call(e.exports,
function(c){var d=r[a][1][c];return g(d?d:c)},e,e.exports,l,r,u,b)}return u[a].exports}for(var f="function"==typeof require&&require,c=0;c<b.length;c++)g(b[c]);return g}({1:[function(l,r,u){function b(c){g=window?window.console:{};f=window?window:{};this._timers={};this.args=function(a,c,d){a="%c "+c+" %c"+(new Date).toISOString()+" %c"+a;c=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];
for(var h=0;h<d.length;h++)if("string"==typeof d[h]&&0==d[h].indexOf("timer:")){var t=d[h].split(":");if(3==t.length)switch(t[2]){case "start":this._timers[t[1]]=(new Date).getTime();a+=" %cSTART "+t[1];c.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":a+=" %cSTOP "+t[1]+" "+((new Date).getTime()-this._timers[t[1]])+" ms",c.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}a+=" \n%c ";c.push("background-color:transparent;color:inherit;");for(h=c.length-
1;0<=h;h--)Array.prototype.unshift.call(d,c[h]);Array.prototype.unshift.call(d,a);Array.prototype.push.call(d,"\n\n")};this.log=function(b,k){"function"===typeof a&&a.call(c,b,k);this.args(c,b,k);f.zuixNoConsoleOutput||g.log.apply(g,k)}}var g=null,f=null,c="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" "),a=null;b.prototype.monitor=function(c){a=c};b.prototype.console=function(a){if(a)window.console=
g;else for(window.console={},a=0;a<c.length;a++)window.console[c[a]]||(window.console[c[a]]=function(){})};b.prototype.i=b.prototype.info=b.prototype.l=b.prototype.log=function(){this.log("INFO",arguments);return this};b.prototype.w=b.prototype.warn=function(){this.log("WARN",arguments);return this};b.prototype.e=b.prototype.error=function(){this.log("ERROR",arguments);return this};b.prototype.d=b.prototype.debug=function(){this.log("DEBUG",arguments);return this};b.prototype.t=b.prototype.trace=
function(){this.log("TRACE",arguments);return this};r.exports=function(a){return new b(a)}},{}],2:[function(l,r,u){function b(b){var c=this;c._worker=null;c._taskList=[];c._requests=[];null==b&&(b=function(){});c.taskQueue=function(a,p,e){c._taskList.push({tid:a,fn:p,status:0,priority:e,step:function(a){g.t(a,"load:step");b(c,"load:step",{task:a})},end:function(){this.status=2;g.t(this.tid,"load:next","timer:task:stop");b(c,"load:next",{task:this.tid});c._taskList.splice(this.index,1);c.taskCheck();
null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});g.t(a,"task added",e,"priority");c._taskList.sort(function(a,c){return a.priority>c.priority?1:c.priority>a.priority?-1:0});c.taskCheck()};c.taskCheck=function(){for(var a=0;a<c._taskList.length;a++){if(0==c._taskList[a].status){c._taskList[a].status=1;g.t(c._taskList[a].tid,"load:begin","timer:task:start");b(c,"load:begin",{task:c._taskList[a].tid});c._taskList[a].index=a;c._taskList[a].fn.call(c._taskList[a]);
return}if(1==c._taskList[a].status||2==c._taskList[a].status)return}g.t("load:end");b(c,"load:end")}}var g=l("./Logger")("TaskQueue.js");b.prototype.queue=function(b,c,a){return this.taskQueue(b,c,a)};r.exports=b},{"./Logger":1}],3:[function(l,r,u){function b(a){d=a}function g(){e++;return e<p.length?a():!1}function f(){q=k=!1;t=0;e=-1;p.length=0;p=[];d.status("done")}function c(){q=!0;0<t?setTimeout(function(){c()},2E3):q=!1}function a(){if(q)return!1;if(k)return c(),k=!1,e<p.length&&d.status("stopped",
{remaining:p.length-e-1,jobs:p.splice(0,e+1)}),!1;var a=p[e];if(null==a)return!1;var h=function(){t++;d.doWork(a.item,function(){t--; -1==e||e>=p.length-1?f():requestAnimationFrame(g)})||(t--,g())};a.cancelable?requestAnimationFrame(h):h();return!0}b.prototype.break=function(){k=!0;0==t&&f()};b.prototype.isReady=function(){return 0==p.length};b.prototype.setJobs=function(a){0<p.length&&alert("ThreadPool warning, should not set a new job list if still working.");p=a;d.status("start",p);for(a=0;a<h-
t&&g();a++);};var p=[],e=0,k=!1,d=null,h=10,t=0,q=!1;r.exports=function(a){return new b(a)}},{}],4:[function(l,r,u){r.exports={isIE:function(){return 0<window.navigator.userAgent.indexOf("Trident")},isNoU:function(b){return"undefined"===typeof b||null===b},isFunction:function(b){return"function"===typeof b},objectEquals:function(b,g){if(null===b||void 0===b||null===g||void 0===g)return b===g;if(b.constructor!==g.constructor)return!1;if(b instanceof Function||b instanceof RegExp)return b===g;if(b===
g||b.valueOf()===g.valueOf())return!0;if(Array.isArray(b)&&b.length!==g.length||b instanceof Date||!(b instanceof Object)||!(g instanceof Object))return!1;var f=Object.keys(b);return Object.keys(g).every(function(c){return-1!==f.indexOf(c)})&&f.every(function(c){return util.objectEquals(b[c],g[c])})},propertyFromPath:function(b,g){if("string"===typeof g){g=g.replace(/\[(\w+)]/g,".$1");g=g.replace(/^\./,"");for(var f=g.split("."),c=b,a=0,p=f.length;a<p;++a){var e=f[a];if("undefined"!==typeof c[e])c=
c[e];else return}return c}},cloneObject:function g(f){if(null===f||"object"!==typeof f)return f;var c=f.constructor(),a;for(a in f)c[a]=g(f[a]);return c},evalJs:eval}},{}],5:[function(l,r,u){function b(a){c(this,a.type,a)}function g(a,c,q){var e=!1;d.each(k,function(){if(this.element===a&&this.path===c&&this.handler==q)return p.w("Handler already registered",a,c,q),e=!0,!1});e||(k.push({element:a,path:c,handler:q}),a.addEventListener(c,b,!1))}function f(a,c,q){var e=1,f=-1;d.each(k,function(b){this.element===
a&&this.path===c&&this.handler==q&&(e--,f=b)});-1!==f&&k.splice(f,1);0==e&&a.removeEventListener(c,b)}function c(a,c,b){var e=d(a);d.each(k,function(){this.element===a&&this.path===c&&this.handler.call(e,b)})}function a(h){this._selection=[];"undefined"===typeof h&&(h=document.documentElement);if(h instanceof a)return h;if(h instanceof HTMLCollection||h instanceof NodeList||Array.isArray(h))this._selection=h;else if(h instanceof HTMLElement||h instanceof Node)this._selection=[h];else if("string"===
typeof h)this._selection=document.documentElement.querySelectorAll(h);else if(null!==h)throw p.e("ZxQuery cannot wrap object of this type.",typeof h,h),Error(),h;return this}var p=l("./Logger")("TaskQueue.js"),e=l("./Util.js"),k=[];a.prototype.length=function(){return this._selection.length};a.prototype.parent=function(h){return e.isNoU(h)?new a(this._selection[0].parentNode):new a(d.getClosest(this._selection[0],h))};a.prototype.children=function(h){return e.isNoU(h)?new a(this._selection[0].children):
new a(this._selection[0].querySelectorAll(h))};a.prototype.reverse=function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};a.prototype.get=function(a){e.isNoU(a)&&(a=0);return this._selection[a]};a.prototype.eq=function(h){var c=this._selection,b=c[h];1<arguments.length&&(b=[],d.each(arguments,function(a,h){null!=c[h]&&b.push(c[h])}));return new a(b)};a.prototype.find=function(h){return new a(this._selection[0].querySelectorAll(h))};a.prototype.each=function(a){d.each(this._selection,
a);return this};a.prototype.attr=function(a,c){var b=this;if("object"===typeof a)d.each(a,function(a,h){b.each(function(c,b){b.setAttribute(a,h)})});else{if("undefined"==typeof c)return this._selection[0].getAttribute(a);null===c?this._selection[0].removeAttribute(a):this.each(function(b,d){this.get().setAttribute(a,c)})}return this};a.prototype.trigger=function(a,c){var b;window.CustomEvent?b=new CustomEvent(a,{detail:c}):(b=document.createEvent("CustomEvent"),b.initCustomEvent(a,!0,!0,c));this.each(function(a,
h){h.dispatchEvent(b)});return this};a.prototype.one=function(a,c){var b=!1;this.on(a,function(e,f){b||(b=!0,d(this).off(a,c),c.call(this,e,f))});return this};a.prototype.on=function(a,c){var b=a.match(/\S+/g)||[];this.each(function(a,h){d.each(b,function(a,b){"body"===h.tagName.toLowerCase()&&(h=document);g(h,b,c)})});return this};a.prototype.off=function(a,c){var b=a.match(/\S+/g)||[];this.each(function(a,h){d.each(b,function(a,b){"body"===h.tagName.toLowerCase()&&(h=document);f(h,b,c)})});return this};
a.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};a.prototype.position=function(){return null!=this._selection[0]?d.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};a.prototype.css=function(a,c){var b=this;if("object"===typeof a)d.each(a,function(a,h){b.each(function(c,b){b.style[a]=h})});else{if(e.isNoU(c))return this._selection[0].style[a];b.each(function(b,d){d.style[a]=c})}return this};a.prototype.addClass=function(a){var c=a.match(/\S+/g)||
[];d.each(this._selection,function(b,e){e.classList?d.each(c,function(a,h){e.classList.add(h)}):e.className+=" "+a});return this};a.prototype.hasClass=function(a){return d.hasClass(this._selection[0],a)};a.prototype.removeClass=function(a){var c=a.match(/\S+/g)||[];d.each(this._selection,function(b,e){e.classList?d.each(c,function(a,h){e.classList.remove(h)}):e.className=e.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")});return this};a.prototype.prev=function(){return new a(this._selection[0].previousElementSibling)};
a.prototype.next=function(){return new a(this._selection[0].nextElementSibling)};a.prototype.html=function(a){if(e.isNoU(a))return this._selection[0].innerHTML;this.each(function(c,b){b.innerHTML=a});return this};a.prototype.append=function(a){"string"===typeof a?this._selection[0].innerHTML+=a:this._selection[0].appendChild(a);return this};a.prototype.insert=function(a,c){var b=this.children().get(a);null!==b?this._selection[0].insertBefore(c,b):this._selection[0].appendChild(c);return this};a.prototype.prepend=
function(a){"string"===typeof a?this._selection[0].innerHTML=a+this._selection[0].innerHTML:this._selection[0].insertBefore(a,this._selection[0].firstElementChild);return this};a.prototype.display=function(a){if(e.isNoU(a))return this._selection[0].style.display;d.each(this._selection,function(c,b){b.style.display=a});return this};a.prototype.visibility=function(a){if(e.isNoU(a))return this._selection[0].style.visibility;d.each(this._selection,function(c,b){b.style.visibility=a});return this};a.prototype.show=
function(){return this.display("")};a.prototype.hide=function(){return this.display("none")};var d=function(h){return new a(h)};d.find=function(a){return d().find(a)};d.each=function(a,c){var b=null==a?0:Object.keys(a).length;if(0<b){var e=0,f;for(f in a){var k=a[f];k instanceof Element&&(k=d(k));if(!1===c.call(k,f,a[f]))break;e++;if(e>=b)break}}return this};d.hasClass=function(a,c){var b=c.match(/\S+/g)||[],e=!1;d.each(b,function(c,b){if(e=a.classList?a.classList.contains(b):(new RegExp("(^| )"+
b+"( |$)","gi")).test(a.className))return!1});return e};d.ajax=function(a){var c;c=e.isNoU(a)||e.isNoU(a.url)?a:a.url;var b=new XMLHttpRequest;b.open("GET",c);b.onload=function(){200===b.status?e.isFunction(a.success)&&a.success(b.responseText):e.isFunction(a.error)&&a.error(b);e.isFunction(a.then)&&a.then(b)};b.send();return this};d.wrapElement=function(a,b){var c=document.createElement(a);"string"===typeof b?c.innerHTML=b:c.appendChild(b);return c};d.wrapCss=function(a,b){for(var c=/([.,\w])([^/{};]*)({)/g,
e,f=null,k="";e=c.exec(b);){if(null!=f){var f=b.substring(f.index,e.index),g=/(.*)\{([^\}]+)[\}]/g.exec(f);if(null!=g&&1<g.length){var l=g[1].split(",");d.each(l,function(b,c){"."==c.replace(" ","")&&(c="");k+="\n"+a+"\n"+c;b<l.length-1&&(k+=", ")});k+=" {"+g[2]+"}\n"}else p.w("z$.wrapCss was unable to parse rule.",g,f)}f=e}null!=f&&(k+=a+" "+b.substring(f.index));""!=k&&(b=k);return b};d.appendCss=function(a,b,c){var d=null,f;"string"===typeof a?(f=document.head||document.getElementsByTagName("head")[0],
d=document.createElement("style"),d.type="text/css",d.id=c,d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a))):a instanceof Element&&(d=a);e.isNoU(b)||f.removeChild(b);e.isNoU(d)||f.appendChild(d);return d};d.replaceBraces=function(a,b){for(var c="",d=0,f=0,k=new RegExp(/[^{}]+(?=})/g),g;g=k.exec(a);){var p="{"+g[0]+"}";if("function"===typeof b){var l=b(g[0]);e.isNoU(l)||(p=l,d++)}c+=a.substr(f,g.index-f-1)+p;f=g.index+g[0].length+1}if(0<d)return c+=a.substr(f)};d.getClosest=
function(a,b){for(;a&&a!==document;a=a.parentNode)if(a.matches(b))return a;return null};d.getPosition=function(a){for(var b=d.isInView(a),c=0,e=0;a;){if("BODY"==a.tagName)var f=a.scrollTop||document.documentElement.scrollTop,c=c+(a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+a.clientLeft),e=e+(a.offsetTop-f+a.clientTop);else c+=a.offsetLeft-a.scrollLeft+a.clientLeft,e+=a.offsetTop-a.scrollTop+a.clientTop;a=a.offsetParent}return{x:c,y:e,visible:b}};d.isInView=function(a){if(null===
a.offsetParent)return!1;a=a.getBoundingClientRect();return 0<a.bottom&&0<a.right&&a.left<(window.innerWidth||document.documentElement.clientWidth)&&a.top<(window.innerHeight||document.documentElement.clientHeight)};d.scrollTo=function(a,b){if(0!==b&&null!=b){var c=a.scrollTop+b-56,d=a.scrollTop-c;a.firstElementChild.style.transition="transform 500ms ease";"undefined"!==typeof a.firstElementChild.style.WebkitTransform?a.firstElementChild.style.WebkitTransform="translate(0, "+d+"px)":"undefined"!==
typeof a.firstElementChild.style.MozTransform?a.firstElementChild.style.MozTransform="translate(0, "+d+"px)":a.firstElementChild.style.transform="translate(0, "+d+"px)";window.setTimeout(function(){"undefined"!==typeof a.firstElementChild.style.WebkitTransform?a.firstElementChild.style.WebkitTransform="":"undefined"!==typeof a.firstElementChild.style.MozTransform?a.firstElementChild.style.MozTransform="":a.firstElementChild.style.transform="";a.firstElementChild.style.transition="";a.scrollTop=c},
500)}};d.ZxQuery=a;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var b=a.length;0<=--b&&a.item(b)!==this;);return-1<b});(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");
d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return d}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();r.exports=d},{"./Logger":1,"./Util.js":4}],6:[function(l,r,u){l=l("./zuix/Zuix.js");"object"===typeof r&&r.exports?r.exports=l.call(this):this.zuix=l.call(this)},{"./zuix/Zuix.js":10}],7:[function(l,r,u){function b(a,b){this._options=null;this.contextId=null==a||null==a.contextId?null:a.contextId;this.componentId=null;this.trigger=
function(a,c,d){"function"===typeof b&&b(a,c,d)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(a);return this}var g=l("../helpers/Logger")("ComponentContext.js"),f=l("../helpers/ZxQuery"),c=l("../helpers/Util");b.prototype.container=function(a){if(null==a)return this._container;a instanceof f.ZxQuery&&(a=a.get());this._container=a;return this};b.prototype.view=function(a){if("undefined"===
typeof a)return this._view;a instanceof f.ZxQuery&&(a=a.get());"string"===typeof a?(a={content:a},this.trigger(this,"html:parse",a),a=a.content,null!=this._container?(this._view=this._container,this._view.innerHTML+=a):(a=f.wrapElement("div",a),null!=this._view?this._view.innerHTML=a.innerHTML:this._view=a),f(this._view).find("script").each(function(a,b){"true"!==this.attr("zuix-loaded")&&(this.attr("zuix-loaded","true"),eval.call(window,b.innerHTML))}),this.trigger(this,"view:process",f(this._view))):
(a instanceof f.ZxQuery&&(a=a.get()),null!=this._container?(this._view=f.wrapElement("div",a.outerHTML).firstElementChild,this._view.removeAttribute("data-ui-view"),this._container.appendChild(this._view),this._view=this._container):this._view=a);a=f(this._view);!1===this._options.css?a.addClass("zuix-css-ignore"):a.removeClass("zuix-css-ignore");this.modelToView();return this};b.prototype.style=function(a){if("undefined"===typeof a)return this._style;null==a||a instanceof Element?(this._css=a instanceof
Element?a.innerText:a,this._style=f.appendCss(a,this._style,this.componentId)):"string"===typeof a&&(this._css=a,a=f.wrapCss('[data-ui-component="'+this.componentId+'"]:not(.zuix-css-ignore)',a),a={content:a},this.trigger(this,"css:parse",a),a=a.content,this._style=f.appendCss(a,this._style,this.componentId));return this};b.prototype.model=function(a){if("undefined"===typeof a)return this._model;this._model=a;this.modelToView();null!=this._c&&c.isFunction(this._c.update)&&this._c.update.call(this._c);
return this};b.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};b.prototype.options=function(a){if(null==a)return this._options;var b=this._options=this._options||{};f.each(a,function(a,c){b[a]=c});null!=b.componentId&&(this.componentId=b.componentId);this.container(b.container);this.view(b.view);"undefined"!==typeof b.css&&this.style(b.css);this.controller(b.controller);this.model(b.model);b.lazyLoad&&null!=this.container()&&(this.container().setAttribute("data-ui-context",
this.contextId),this.container().setAttribute("data-ui-load",this.componentId),this.container().setAttribute("data-ui-lazyload","true"));return this};b.prototype.on=function(a,b){this._c.on(a,b);return this};b.prototype.loadCss=function(a,b){var e=this;c.isNoU(a)&&(a={});c.isNoU(a.caching)||(b=a.caching);var k=e.componentId+".css";c.isNoU(a.path)||(k=a.path);b||(k+="?"+(new Date).getTime());f.ajax({url:k,success:function(b){e.style(b);c.isFunction(a.success)&&a.success.call(e,b)},error:function(b){g.e(b,
e);c.isFunction(a.error)&&a.error.call(e,b)},then:function(){c.isFunction(a.then)&&a.then.call(e)}});return this};b.prototype.loadHtml=function(a,b){var e=this,k=e.componentId;c.isNoU(a)&&(a={});c.isNoU(a.caching)||(b=a.caching);c.isNoU(a.path)||(k=a.path);var d=f().find('[data-ui-view="'+k+'"]:not([data-ui-component*=""])');0<d.length()?(k=d.get(0),e.view()===k||null!=e.container()&&e.container().contains(k)?e.view(k):e.view(k.outerHTML),k=e.view().innerHTML,c.isFunction(a.success)&&a.success.call(e,
k),c.isFunction(a.then)&&a.then.call(e)):(k==e.componentId&&(k+=".html"+(b?"":"?"+(new Date).getTime())),f.ajax({url:k,success:function(b){e.view(b);c.isFunction(a.success)&&a.success.call(e,b)},error:function(b){g.e(b,e);c.isFunction(a.error)&&a.error.call(e,b)},then:function(){c.isFunction(a.then)&&a.then.call(e)}}));return this};b.prototype.viewToModel=function(){var a=this;this._model={};f(this._view).find("[data-ui-field]").each(function(b,e){if(0<this.parent("pre,code").length())return!0;var f=
this.attr("data-ui-field"),d=!c.isNoU(e.innerHTML)&&c.isIE()?e.cloneNode(!0):e;if(0<f.indexOf(".")){for(var f=f.split("."),h=a._model,g=0;g<f.length-1;g++)"undefined"===typeof h[f[g]]&&(h[f[g]]={}),h=h[f[g]];h[f[f.length-1]]=d}else a._model[f]=d});return this};b.prototype.modelToView=function(){if(null!=this._view&&null!=this._model){var a=this;f(this._view).find("[data-ui-field]").each(function(b,e){if(0<this.parent("pre,code").length())return!0;var g=this.attr("data-bind-to");null==g&&(g=this.attr("data-ui-field"));
if("function"===typeof a._model)a._model.call(f(a._view),this,g);else{var d=c.propertyFromPath(a._model,g);if("function"===typeof d)d.call(f(a._view),this,g);else if(null!=d)switch(e.tagName.toLowerCase()){case "img":e.src=c.isNoU(d.src)?c.isNoU(d.innerHTML)?d:d.innerHTML:d.src;d.alt&&(e.alt=d.alt);break;case "a":e.href=c.isNoU(d.href)?c.isNoU(d.innerHTML)?d:d.innerHTML:d.href;d.title&&(e.title=d.title);break;case "input":e.value=c.isNoU(d.value)?c.isNoU(d.innerHTML)?d:d.innerHTML:d.value;break;default:e.innerHTML=
c.isNoU(d.innerHTML)?d:d.innerHTML}}})}return this};r.exports=b},{"../helpers/Logger":1,"../helpers/Util":4,"../helpers/ZxQuery":5}],8:[function(l,r,u){function b(){}function g(a){null!=a&&(n=!a);return!E&&!n}function f(){m.sort(function(a,b){return a.priority-b.priority});for(var a=[],b=100,c=[],d=0<m.length?m.shift():null;null!=d&&null!=d.element&&0<b;){var f=h(d.element);g()&&!1!==f.scroller?(d.lazy=!0,d.visible=y.getPosition(d.element).visible):(d.lazy=!1,d.visible=!0);if(null!=d.element&&"true"==
d.element.getAttribute("data-ui-loaded")||!d.visible)d.visible||a.push(d),d=null;null!=d&&null!=d.element&&d.visible&&(c.push({item:d,cancelable:d.lazy}),b--);d=0<b?0<m.length?m.shift():null:null}m=m.concat(a);return c}function c(a){if(z.isReady()){null==a&&0<A.length&&(a=A.unshift());a instanceof y.ZxQuery&&(a=a.get());var b=y(a).find("[data-ui-load]:not([data-ui-loaded=true]),[data-ui-include]:not([data-ui-loaded=true])"),b=Array.prototype.slice.call(b._selection);a=[];for(var c=0;c<b.length;c++){var d=
parseInt(b[c].getAttribute("data-ui-priority"));isNaN(d)&&(d=0);var e=new x;e.element=b[c];e.priority=d;a.push(e)}for(b=0;b<a.length;b++){c=!1;for(d=0;d<m.length;d++)if(a[b].element===m[d].element){c=!0;break}c||m.push(a[b])}t.t("componentize:count",m.length);a=f();0<a.length&&z.setJobs(a)}}function a(a){var b=y(a);if("true"===b.attr("data-ui-loaded")||0<b.parent("pre,code").length())return!1;b.attr("data-ui-loaded","true");var c=b.attr("data-ui-options");q.isNoU(c)?c={}:(c=q.propertyFromPath(window,
c),c=q.cloneObject(c)||{});q.isNoU(c.view)&&!b.isEmpty()?(c.view=a,c.viewDeferred=!0):q.isNoU(c.view)&&q.isNoU(c.container)&&b.isEmpty()&&(c.container=a);a=b.attr("data-ui-load");q.isNoU(a)&&(a=b.attr("data-ui-include"),b.attr("data-ui-component",a),q.isNoU(c.controller)&&(c.controller=function(){}));var d=b.attr("data-bind-model");!q.isNoU(d)&&0<d.length&&(c.model=q.propertyFromPath(window,d));d=b.attr("data-ui-context");q.isNoU(d)||(c.contextId=d);b=b.attr("data-ui-priority");q.isNoU(b)||(c.priority=
b);D.load(a,c);return!0}function p(a){for(var b=0;b<v.length;b++){var c=v[b];if(c.element===a)return c}return null}function e(a){a={element:a,scroller:!1};v.push(a);return a}function k(a){for(var b=0;b<C.length;b++){var c=C[b];if(c.element===a)return c}return null}function d(a){a={element:a,handler:!1};C.push(a);return a}function h(a){var b=p(a);if(null==b){var b=e(a),c=y.getClosest(a,"[data-ui-lazyload=scroll]");(null!=c&&"force"==c.getAttribute("data-ui-lazyload")||g()&&"false"!=a.getAttribute("data-ui-lazyload"))&&
null!=c&&(a=k(c),null==a&&(a=d(c),function(a,b){var c=(new Date).getTime();y(b).on("scroll",function(){var a=(new Date).getTime();30>a-c||(c=a,z.break())})}(this,c)),b.scroller=null==a?!1:a)}return b}b.prototype.componentize=function(a){null==a&&(a=document);A.indexOf(a)||A.push(a);c();return this};b.prototype.willLoadMore=function(){return 0<m.length||0<A.length};b.prototype.lazyLoad=function(a){return g(a)};b.prototype.setHost=function(a){D=a;return this};r.exports=function(){return new b};var t=
l("../helpers/Logger")("ComponentContext.js"),q=l("../helpers/Util"),y=l("../helpers/ZxQuery"),A=[],m=[],n=!1,v=[],C=[],D=null,E=!1;navigator&&navigator.userAgent&&(E=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));E&&t.d(navigator.userAgent,"is a bot, ignoring `lazy-loading` option.");var x=function(){return{element:null,priority:0,visible:!0,lazy:!1}},z=l("../helpers/ThreadPool")({doWork:function(b,c){y(b.element).one("component:ready",function(){c()});return a(b.element)},
status:function(a,b){switch(a){case "stopped":if(0<b.jobs.length)for(var d in b.jobs)m.push(b.jobs[d].item);break;case "done":c()}}})},{"../helpers/Logger":1,"../helpers/ThreadPool":3,"../helpers/Util":4,"../helpers/ZxQuery":5}],9:[function(l,r,u){function b(b){var c=this;this._view=null;this.context=b;this._fieldCache=[];this.destroy=this.create=this.init=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,b){c._childNodes.push(b)})};this.restoreView=
function(){0<this._childNodes.length&&(c.view().html(""),g.each(c._childNodes,function(a,b){c.view().append(b)}),this._childNodes.length=0)};this.on=function(a,b){this.addEvent(this.view(),a,b);return this};this.mapEvent=function(a,b,c,e){null!=b&&(b.off(c,this.eventRouter),a[c]=e,b.on(c,this.eventRouter))};this.eventRouter=function(a){"function"===typeof b._behaviorMap[a.type]&&b._behaviorMap[a.type].call(c.view(),a,a.detail);"function"===typeof b._eventMap[a.type]&&b._eventMap[a.type].call(c.view(),
a,a.detail)};var a=b.options(),l=null;if(null!=a.on)for(var e in a.on)l=a.on[e],c.addEvent(c.view(),e,l);if(null!=a.behavior)for(var k in a.behavior)l=a.behavior[k],c.addBehavior(c.view(),k,l);b.controller().call(this,this);return this}var g=l("../helpers/ZxQuery");b.prototype.addEvent=function(b,c,a){this.mapEvent(this.context._eventMap,b,c,a);return this};b.prototype.addBehavior=function(b,c,a){this.mapEvent(this.context._behaviorMap,b,c,a);return this};b.prototype.field=function(b){return null};
b.prototype.clearCache=function(){this._fieldCache.length=0};b.prototype.view=function(b){if(null!=this.context.view()||this._view!==this.context.view())this.clearCache(),this._view=g(this.context.view());if(null!=b)return this._view.find(b);if(null!==this._view)return this._view;throw{message:"Not attacched to a view yet.",source:this};};b.prototype.model=function(b){if(null==b)return this.context.model();this.context.model(b);return this};b.prototype.options=function(){return this.context.options()};
b.prototype.trigger=function(b,c,a){null==this.context._eventMap[b]&&!0!==a&&this.addEvent(this.view(),b,null);!0===a?(a=this.context.container(),null==a&&(a=this.context.view()),null!=a&&g(a).trigger(b,c),this.context.trigger(this.context,b,c)):this.view().trigger(b,c);return this};b.prototype.expose=function(b,c){if("object"===typeof b){var a=this;g.each(b,function(b,c){a.context[b]=c})}else this.context[b]=c;return this};b.prototype.loadCss=function(b){this.context.loadCss(b);return this};b.prototype.loadHtml=
function(b){this.saveView();this.context.loadHtml(b);return this};b.prototype.log={};b.prototype.for=function(b){return this};r.exports=b},{"../helpers/ZxQuery":5}],10:[function(l,r,u){function b(){x.setHost(this);this._fieldCache=[];return this}function g(a,b,c){n.isNoU(c)&&(c=this);null==c._fieldCache&&(c._fieldCache={});var d=null;"undefined"===typeof c._fieldCache[a]?(d=v(b).find('[data-ui-field="'+a+'"]'),null!=d&&(c._fieldCache[a]=d)):d=c._fieldCache[a];return d}function f(b,d){var f=null;n.isNoU(d)?
(d={},f=new D(d,e)):(d.componentId=b,n.isNoU(d.contextId)?(!1===d&&(d={}),d.contextId="zuix-ctx-"+ ++L,f=a(d)):(f=p(d.contextId),null!==f?f.options(d):f=a(d)));f.componentId!=b&&(f.componentId=b);n.isFunction(d.ready)&&(f.ready=d.ready);n.isFunction(d.error)&&(f.error=d.error);if(d.lazyLoad)return f;if(null==w[b])return w[b]=!0,c(f,d);var g=setInterval(function(){null==w[b]&&(w[b]=!0,clearInterval(g),c(f,d))},100);return f}function c(a,b){var c=d(a.componentId);null!==c&&null==b.controller&&null==
a.controller()&&(a.controller(c.controller),m.t(a.componentId+":js","component:cached:js"));if(n.isNoU(b.view)){if(null!==c&&null!=c.view&&(a.view(c.view),m.t(a.componentId+":html","component:cached:html"),null!=c.view&&n.isNoU(b.css)&&(b.css=!1,c.css_applied||(c.css_applied=!0,a.style(c.css),m.t(a.componentId+":css","component:cached:css")))),n.isNoU(a.view()))return K("resource-loader").queue(a.componentId+":html",function(){w[a.componentId]=this;a.loadHtml({caching:B,success:function(d){null==
c&&(c=t(a));c.view=d;delete c.controller;!1!==b.css?(w[a.componentId].step(a.componentId+":css"),a.loadCss({caching:B,success:function(a){c.css=a},error:function(b){m.e(b,a)},then:function(){h(a,w[a.componentId])}})):h(a,w[a.componentId])},error:function(c){m.e(c,a);n.isFunction(b.error)&&a.error.call(a,c)}})},b.priority),a}else a.view(b.view);K("resource-loader").queue(a.componentId+":js",function(){w[a.componentId]=this;h(a,w[a.componentId])},F.length);return a}function a(a){a=new D(a,e);F.push(a);
return a}function p(a){var b=null;a instanceof v.ZxQuery&&(a=a.get());v.each(F,function(c,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||n.objectEquals(d.contextId,a))return b=d,!1});return b}function e(a,b,c){n.isFunction(I[b])&&I[b].call(a,c)}function k(a){null!=a&&(B=a);return B}function d(a){var b=null;v.each(z,function(c,d){if(n.objectEquals(d.componentId,a))return b=d,!1});return b}function h(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(m.d(a.componentId,
"controller:load"),n.isNoU(b)||b.step(a.componentId+":js"),n.isFunction(J[a.componentId]))a.controller(J[a.componentId]),q(a,b);else{var c=function(b){v.ajax({url:a.componentId+".js"+(B?"":"?"+(new Date).getTime()),success:function(b){try{var c=b.indexOf("function"),d=b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-4));var e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+11));var f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+'.js"\n';a.controller(A(b))}catch(g){m.e(Error(),
g,b,a),n.isFunction(a.error)&&a.error.call(a,g)}},error:function(b){m.e(b,Error(),a);n.isFunction(a.error)&&a.error.call(a,b)},then:function(){q(a,b)}})};n.isNoU(b)?K("resource-loader").queue(a.componentId+":js",function(){c(w[a.componentId]=this)},a.options().priority):c(b)}else q(a,b)}function t(a){var b=a.view().innerHTML,b=v.wrapElement("div",b),b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};z.push(b);m.t(a.componentId,"bundle:added");return b}function q(a,
b){w[a.componentId]=null;if(n.isNoU(a.view()))m.e(a.componentId,"component:view:undefined");else{var c=d(a.componentId);a.options().viewDeferred||(null===c?c=t(a):null==c.controller?c.controller=a.controller():m.w(a.componentId,"component:deferred:load"));null!=b&&b.callback(function(){m.d(a.componentId,"controller:create:deferred");y(a._c)});m.d(a.componentId,"component:initializing");if(n.isFunction(a.controller())){var e=a._c=new E(a);e.log=l("../helpers/Logger")(a.contextId);"function"===typeof e.init&&
e.init();if(!n.isNoU(e.view()))if(e.view().attr("data-ui-component",a.componentId),n.isNoU(a.model())&&!n.isNoU(a.view())&&a.viewToModel(),e.trigger("view:apply"),a.options().viewDeferred){a.options().viewDeferred=!1;e.saveView();null===c&&(c={componentId:a.componentId,controller:a.controller()},z.push(c),m.t(a.componentId,"bundle:added"),m.d(a.componentId,"component:deferred:load"));var f=-1;!1!==a.options().css&&(null==c.css?(-1==f&&(f=0),f++,a.loadCss({caching:B,success:function(b){null==c.css&&
(c.css=b);m.d(a.componentId,"component:deferred:css",f)},then:function(){0===--f&&null!=b&&b.end()}})):a.style(c.css));!1!==a.options().html&&(null==c.view?(-1==f&&(f=0),f++,a.loadHtml({caching:B,success:function(b){null==c.view&&(c.view=b);m.d(a.componentId,"component:deferred:html",f)},then:function(){0===--f&&null!=b&&b.end()}})):a.view(c.view));-1==f&&null!=b&&b.end()}else null!=b&&b.end();null==b&&(m.d(a.componentId,"controller:create"),y(e))}else m.w(a.componentId,"component:controller:undefined")}}
function y(a){a.field=function(b){b=g(b,a.view(),a);b.on=function(b,c,d,e){if("string"===typeof c){var f=c;c=function(){a.trigger(f,d,e)}}return v.ZxQuery.prototype.on.call(this,b,c)};return b};n.isFunction(a.create)&&a.create();a.trigger("view:create");n.isFunction(a.context.ready)&&a.context.ready.call(a.context);a.trigger("component:ready",a.view(),!0);m.i(a.context.componentId,"component:loaded",a.context.contextId)}function A(a){var b=function(a){};if("string"===typeof a)try{b=eval.call(this,
a)}catch(c){m.e(this,c,a)}return b}var m=l("../helpers/Logger")("Zuix.js"),n=l("../helpers/Util"),v=l("../helpers/ZxQuery"),C=l("../helpers/TaskQueue"),D=l("./ComponentContext"),E=l("./ContextController"),x=l("./Componentizer")(),z=[],L=0,F=[],w=[],I=[],J={},B=!0,H=[],K=function(a){n.isNoU(H[a])&&(H[a]=new C(function(a,b,c){e(a,b,c)}));return H[a]};b.prototype.controller=function(a){"function"!==typeof a["for"]&&(a["for"]=function(b){return J[b]=a});return a};b.prototype.field=g;b.prototype.componentize=
function(a){x.componentize(a);return this};b.prototype.load=f;b.prototype.unload=function(a){n.isNoU(a)||n.isNoU(a._c)||(n.isNoU(a._c.view())||a._c.view().attr("data-ui-component",null),n.isFunction(a._c.destroy)&&a._c.destroy());return this};b.prototype.context=p;b.prototype.createComponent=function(a,b){null==b&&(b={});b.container=document.createElement("div");return f(a,b)};b.prototype.trigger=function(a,b,c){e(a,b,c);return this};b.prototype.hook=function(a,b){n.isNoU(b)||(I[a]=b);return this};
b.prototype.lazyLoad=function(a){if(null!=a)x.lazyLoad(a);else return x.lazyLoad();return this};b.prototype.httpCaching=function(a){if(null!=a)k(a);else return k();return this};b.prototype.bundle=function(a,b){if(n.isNoU(a))return z;if(a&&"boolean"===typeof a){m.t("bundle:start");var c=x.lazyLoad();x.lazyLoad(!1);x.componentize();if("function"===typeof b){var d=function(a){setTimeout(function(){x.willLoadMore()?(m.t("bundle:wait"),a(a)):(m.t("bundle:end"),x.lazyLoad(c),b())},1E3)};d(d)}}else{for(d=
0;d<a.length;d++)a[d].css_applied&&delete a[d].css_applied;z=a}return this};b.prototype.$=v;b.prototype.TaskQueue=C;b.prototype.ZxQuery=v.ZxQuery;b.prototype.dumpCache=function(){return z};b.prototype.dumpContexts=function(){return F};r.exports=function(a){var c=new b;"loading"!=document.readyState?c.componentize():document.addEventListener("DOMContentLoaded",function(){c.componentize()});m.monitor(function(a,b){n.isFunction(c.monitor)&&c.monitor(a,Array.prototype.slice.call(b))});return c}},{"../helpers/Logger":1,
"../helpers/TaskQueue":2,"../helpers/Util":4,"../helpers/ZxQuery":5,"./ComponentContext":7,"./Componentizer":8,"./ContextController":9}]},{},[6])(6)});
//# sourceMappingURL=zuix.min.js.map
