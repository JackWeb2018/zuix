/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.
         https://genielabs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var $jscomp={scope:{},findInternal:function(d,k,l){d instanceof String&&(d=String(d));for(var n=d.length,m=0;m<n;m++){var t=d[m];if(k.call(l,t,m,d))return{i:m,v:t}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,k,l){if(l.get||l.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[k]=l.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,k,l,n){if(k){l=$jscomp.global;d=d.split(".");for(n=0;n<d.length-1;n++){var m=d[n];m in l||(l[m]={});l=l[m]}d=d[d.length-1];n=l[d];k=k(n);k!=n&&null!=k&&$jscomp.defineProperty(l,d,{configurable:!0,writable:!0,value:k})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,l){return $jscomp.findInternal(this,d,l).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var k=0;return $jscomp.iteratorPrototype(function(){return k<d.length?{done:!1,value:d[k++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(d,k){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var l=0,n={next:function(){if(l<d.length){var m=l++;return{value:k(m,d[m]),done:!1}}n.next=function(){return{done:!0,value:void 0}};return n.next()}};n[Symbol.iterator]=function(){return n};return n};
$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6-impl","es3");
function Zuix(){function d(b){this._options=null;this.contextId=e.isNoU(b)||e.isNoU(b.contextId)?null:b.contextId;this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=this.componentId=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(b);return this}function k(b){var a=this;this.context=b;this.componentId=b.componentId;this.view=function(){return b.view()};this.model=function(){return b.model()};this.expose=function(a,c){b[a]=c};this.behavior=
function(){return b.behavior};this.mapEvent=function(a,b,c,g){e.isNoU(b)||(b=f(b),b.off(c,this.eventRouter),a[c]=g,b.on(c,this.eventRouter))};this._fieldCache=[];this.api=this.event=this.refresh=this.destroy=this.pause=this.resume=this.create=null;this.trigger=function(c,g){e.isNoU(b._eventMap[c])&&this.addEvent(a.view(),c,null);f(a.view()).trigger(c,g)};this.on=function(b,c){this.addEvent(a.view(),b,c)};this.invoke=function(b,c){e.isFunction(a.api)&&a.api(b,c)};this.eventRouter=function(c){e.isFunction(b._behaviorMap[c.type])&&
b._behaviorMap[c.type].call(a.view(),c,c.detail);e.isFunction(b._eventMap[c.type])&&b._eventMap[c.type].call(a.view(),c,c.detail)};var c=b.options(),g=null;if(!e.isNoU(c.on))for(var d in c.on)g=c.on[d],a.addEvent(a.view(),d,g);if(!e.isNoU(c.behavior))for(var h in c.behavior)g=c.behavior[h],a.addBehavior(a.view(),h,g);b.controller().call(this,this);return this}function l(b){return b}function n(b,a){return f(a).find('[data-ui-field\x3d"'+b+'"]').get(0)}function m(b){q.requestLock(m)?(f(b).find("[data-ui-load]:not([data-ui-loaded\x3dtrue]),[data-ui-include]:not([data-ui-loaded\x3dtrue])").each(function(){if("true"===
this.getAttribute("data-ui-forceload"))return t(this),!0;var a=f.getClosest(this,"[data-ui-lazyload\x3dtrue]");if(null!==a&&(-1==B.indexOf(a)&&(B.push(a),f(a).on("scroll",function(){m(a)})),!f.getPosition(this).visible))return-1==u.indexOf(this)&&u.push(this),!0;var b=u.indexOf(this);-1<b&&u.splice(b,1);t(this)}),q.releaseLock(m)):q.lockLater(m,function(){m(b)},200)}function t(b){var a=f(b);if("true"===a.attr("data-ui-loaded")||0<a.parent("pre,code").length())console.log("ZUIX","WARN","Skipped",b);
else{a.attr("data-ui-loaded","true");var c=a.attr("data-ui-options");e.isNoU(c)?c={}:(c=e.propertyFromPath(window,c),c=e.cloneObject(c)||{});e.isNoU(c.view)&&!a.isEmpty()?c.view=b:e.isNoU(c.view)&&e.isNoU(c.container)&&a.isEmpty()&&(c.container=b);b=a.attr("data-ui-load");e.isNoU(b)&&(b=a.attr("data-ui-include"),a.attr("data-ui-component",b),e.isNoU(c.controller)&&(c.controller=function(){}));a=a.attr("data-bind-model");!e.isNoU(a)&&0<a.length&&(c.model=e.propertyFromPath(window,a));C(b,c)}}function C(b,
a){var c=null;e.isNoU(a)?(a={},c=new d(a)):e.isNoU(a.contextId)?(!1===a&&(a={}),a.contextId="zuix-ctx-"+ ++H,c=D(a)):(c=E(a.contextId),null!==c?c.options(a):c=D(a));c.componentId!=b&&(c.componentId=b);b=F(c.componentId);null!==b&&e.isNoU(c.controller())&&c.controller(b.controller);e.isFunction(a.ready)&&(c.ready=a.ready);e.isFunction(a.error)&&(c.error=a.error);if(e.isNoU(a.view)){if(null!==b?c.view(b.view):(b=f().find('[data-ui-view\x3d"'+c.componentId+'"]'),0<b.length()&&c.view(b.get(0))),e.isNoU(c.view()))return q.queue("html:"+
c.componentId,function(){var b=this;f.ajax({url:c.componentId+".html?"+(new Date).getTime(),success:function(g){c.view(g);b.end();!1!==a.css?I(c,function(){w(c)}):w(c)},error:function(g){b.end();console.log(g,c);e.isFunction(a.error)&&c.error(c,g)}})}),c}else c.view(a.view);w(c);return c}function J(b){e.isNoU(b)||e.isNoU(b._c)||(e.isNoU(b._c.view())||b._c.view().removeAttribute("data-ui-component"),e.isFunction(b._c.destroy)&&b._c.destroy())}function E(b){var a=null;f.each(x,function(c,g){if(b instanceof
Node&&g.view()===b||e.objectEquals(g.contextId,b))return a=g,!1});return a}function D(b){b=new d(b);x.push(b);return b}function F(b){var a=null;f.each(y,function(c,g){if(e.objectEquals(g.componentId,b))return a=g,!1});return a}function I(b,a){q.queue("css:"+b.componentId,function(){var c=this;f.ajax({url:b.componentId+".css?"+(new Date).getTime(),success:function(g){b.style(g);c.end();e.isFunction(a)&&a.call(b)},error:function(g){c.end();console.log(g,b);e.isFunction(a)&&a.call(b)}})})}function w(b){"undefined"===
typeof b.options().controller&&null===b.controller()?q.queue("js:"+b.componentId,function(){var a=this;f.ajax({url:b.componentId+".js?"+(new Date).getTime(),success:function(c){try{var g=c.indexOf(".load");1<g&&(c=c.substring(0,g-4));var d=c.indexOf(".controller");1<d&&(c=c.substring(d+11));b.controller(K(c))}catch(A){console.log(A,c,b);e.isFunction(b.error)&&b.error(b,A);return}z(b);a.end()},error:function(c){a.end();z(b);console.log(c,b);e.isFunction(b.error)&&b.error(b,c)}})}):z(b)}function z(b){if(!e.isNoU(b.view())){if(null===
F(b.componentId)){var a=b.view()===b.container()?b.view().innerHTML:b.view().outerHTML,a=f.wrapElement("div",a);y.push({componentId:b.componentId,view:a.innerHTML,controller:b.controller()})}e.isFunction(b.controller())&&(a=b._c=new k(b),e.isNoU(a.view())||a.view().setAttribute("data-ui-component",a.componentId),e.isFunction(a.create)&&a.create(),a.trigger("view:create"),b.updateModelView(),e.isFunction(a.resume)&&a.resume());e.isFunction(b.ready)&&b.ready(b)}}function K(b){var a=function(a){};"string"===
typeof b&&(a=G(b));return a}function p(b,a,c){e.isFunction(v[a])&&v[a].call(b,a,c)}function L(b,a){if(e.isNoU(a))return v[b];v[b]=a;return this}function r(){var b=this;b._worker=null;b._taskList=[];b._requests=[];b.taskQueue=function(a,c){b._taskList.push({tid:a,fn:c,status:0,end:function(){this.status=2}});b.check()};b.check=function(){null!=b._worker&&clearTimeout(b._worker);b._worker=setTimeout(function(){b.taskCheck()},10)};b.taskCheck=function(){for(var a=-1,c=0;c<b._taskList.length;c++)if(-2!=
a&&0==b._taskList[c].status)a=c;else{if(1==b._taskList[c].status){b.check();p(b,"load:step",{task:b._taskList[c].tid});return}if(2==b._taskList[c].status){p(this,"load:next",{task:b._taskList[c].tid});b._taskList.splice(c,1);b.check();return}}0<=a?(b._taskList[a].status=1,b._taskList[a].fn.call(b._taskList[a]),b.check(),p(b,"load:begin",{task:b._taskList[a].tid})):p(b,"load:end")}}function h(b){this._selection=[];"undefined"===typeof b&&(b=document.documentElement);if(b instanceof h)return b;if(b instanceof
HTMLCollection||b instanceof NodeList||Array.isArray(b))this._selection=b;else if(b instanceof HTMLElement||b instanceof Node)this._selection=[b];else if("string"===typeof b)this._selection=document.documentElement.querySelectorAll(b);else if(null!==b)throw console.log(typeof b),b;return this}var y=[],x=[];d.prototype.options=function(b){if(e.isNoU(b))return this._options;this._options=b;e.isNoU(b)||(e.isNoU(b.componentId)||(this.componentId=b.componentId),this.container(b.container),this.view(b.view),
"undefined"!==typeof b.css&&this.style(b.css),this.controller(b.controller),this.model(b.model));return this};d.prototype.ready=function(b){};d.prototype.error=function(b,a){};d.prototype.on=function(b,a){return this._c.on(b,a)};d.prototype.invoke=function(b,a){return this._c.invoke(b,a)};d.prototype.model=function(b){if("undefined"===typeof b)return this._model;this._model=b;this.updateModelView();return this};d.prototype.updateModelView=function(){if(!e.isNoU(this._view)&&!e.isNoU(this._model)){var b=
this;f(this._view).find("[data-ui-field]").each(function(a,c){c=f(this);a=c.attr("data-bind-to");e.isNoU(a)&&(a=c.attr("data-ui-field"));if(e.isFunction(b._model))b._model.call(b._view,this,a);else if(c=e.propertyFromPath(b._model,a),e.isFunction(c))c.call(b._view,this,a);else if(!e.isNoU(c))switch(this.tagName.toLowerCase()){case "img":this.src=c;break;case "input":this.value=c;break;default:this.innerHTML=c}})}};d.prototype.style=function(b){if("undefined"===typeof b)return this._style;null==b||
b instanceof Element?(this._css=b instanceof Element?b.innerText:b,this._style=f.appendCss(b,this._style)):"string"===typeof b&&(this._css=b,b=f.wrapCss('[data-ui-component\x3d"'+this.componentId+'"]:not(.zuix-css-ignore)',b),b={content:b},p(this,"css:parse",b),b=b.content,this._style=f.appendCss(b,this._style));return this};d.prototype.view=function(b){if("undefined"===typeof b)return this._view;"string"===typeof b?(b={content:b},p(this,"html:parse",b),b=b.content,e.isNoU(this._container)?this._view=
f.wrapElement("div",b):(this._view=this._container,this._view.innerHTML+=b),f(this._view).find("script").each(function(){"true"!==this.getAttribute("zuix-loaded")&&(this.setAttribute("zuix-loaded","true"),G.call(window,this.innerHTML))}),p(this,"view:process",this._view),m(this._view),this.updateModelView()):e.isNoU(this._container)?this._view=b:(this._view=f.wrapElement("div",b.outerHTML).firstElementChild,this._view.removeAttribute("data-ui-view"),this._container.appendChild(this._view),this._view=
this._container);b=f(this._view);!1===this._options.css?b.addClass("zuix-css-ignore"):b.removeClass("zuix-css-ignore");return this};d.prototype.controller=function(b){if("undefined"===typeof b)return this._controller;this._controller=b;return this};d.prototype.container=function(b){if(e.isNoU(b))return this._container;this._container=b;return this};k.prototype.addEvent=function(b,a,c){this.mapEvent(this.context._eventMap,b,a,c);return this};k.prototype.addBehavior=function(b,a,c){this.mapEvent(this.context._behaviorMap,
b,a,c);return this};k.prototype.field=function(b,a){var c=a?"@"+b:b;"undefined"===typeof this._fieldCache[c]?(b=a?f(b).get(0):f(this.view()).find("[data-ui-field\x3d"+b+"]").get(0),e.isNoU(b)||(this._fieldCache[c]=b)):b=this._fieldCache[c];return b};k.prototype.clearCache=function(){this._fieldCache.length=0};var G=eval,H=0,u=[],B=[],v=[],e={isNoU:function(b){return"undefined"===typeof b||null===b},isFunction:function(b){return"function"===typeof b},objectEquals:function(b,a){if(null===b||void 0===
b||null===a||void 0===a)return b===a;if(b.constructor!==a.constructor)return!1;if(b instanceof Function||b instanceof RegExp)return b===a;if(b===a||b.valueOf()===a.valueOf())return!0;if(Array.isArray(b)&&b.length!==a.length||b instanceof Date||!(b instanceof Object)||!(a instanceof Object))return!1;var c=Object.keys(b);return Object.keys(a).every(function(a){return-1!==c.indexOf(a)})&&c.every(function(c){return e.objectEquals(b[c],a[c])})},propertyFromPath:function(b,a){if("string"===typeof a){a=
a.replace(/\[(\w+)]/g,".$1");a=a.replace(/^\./,"");a=a.split(".");for(var c=0,g=a.length;c<g;++c){var d=a[c];if("undefined"!==typeof b[d])b=b[d];else return}return b}},cloneObject:function a(c){if(null===c||"object"!==typeof c)return c;var g=c.constructor(),d;for(d in c)g[d]=a(c[d]);return g}};r.prototype.queue=function(a,c){return this.taskQueue(a,c)};r.prototype.requestLock=function(a){return e.isNoU(a._taskerLock)?a._taskerLock=!0:!1};r.prototype.releaseLock=function(a){setTimeout(function(){delete a._taskerLock},
100)};r.prototype.lockLater=function(a,c,g){var d=this;e.isNoU(a._taskerLock)?c():e.isNoU(a._taskerTimeout)&&(a._taskerTimeout=!0,a._taskerTimeout=setTimeout(function(){delete a._taskerTimeout;d.lockLater(a,c,g)},g));return!0};var q=new r;h.prototype.length=function(){return this._selection.length};h.prototype.parent=function(a){return e.isNoU(a)?new h(this._selection[0].parentNode):new h(f.getClosest(this._selection[0],a))};h.prototype.children=function(a){return e.isNoU(a)?new h(this._selection[0].children):
new h(this._selection[0].querySelectorAll(a))};h.prototype.get=function(a){e.isNoU(a)&&(a=0);return this._selection[a]};h.prototype.eq=function(a){return new h(this._selection[a])};h.prototype.find=function(a){return new h(this._selection[0].querySelectorAll(a))};h.prototype.each=function(a){f.each(this._selection,a);return this};h.prototype.css=function(a,c){if(e.isNoU(c))return this._selection[0].style[a];this.each(function(d,e){this.style[a]=c});return this};h.prototype.attr=function(a,c){if(e.isNoU(c))return this._selection[0].getAttribute(a);
this.each(function(d,e){this.setAttribute(a,c)});return this};h.prototype.trigger=function(a,c){var d;window.CustomEvent?d=new CustomEvent(a,{detail:c}):(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c));this.each(function(a,c){this.dispatchEvent(d)});return this};h.prototype.one=function(a,c){var d=!1;this.on(a,function(e,g){d||(d=!0,f(this).off(a,c),c.call(this,e,g))});return this};h.prototype.on=function(a,c){var d=a.match(/\S+/g)||[];this.each(function(a,e){var g=this;f.each(d,
function(a,d){g.addEventListener(d,c,!1)})});return this};h.prototype.off=function(a,c){var d=a.match(/\S+/g)||[];this.each(function(a,e){var g=this;f.each(d,function(a,d){g.removeEventListener(d,c)})});return this};h.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};h.prototype.css=function(a,c){if(e.isNoU(c))return this._selection[0].style[a];this.each(function(d,e){this.style[a]=c});return this};h.prototype.addClass=function(a){var c=a.match(/\S+/g)||
[];f.each(this._selection,function(d,e){if(this.classList){var g=this;f.each(c,function(a,c){g.classList.add(c)})}else this.className+=" "+a});return this};h.prototype.hasClass=function(a){a=a.match(/\S+/g)||[];var c=!1,d=this._selection[0];f.each(a,function(a,e){if(c=d?d.classList.contains(e):(new RegExp("(^| )"+e+"( |$)","gi")).test(d.className))return!1});return c};h.prototype.removeClass=function(a){var c=a.match(/\S+/g)||[];f.each(this._selection,function(d,e){if(this.classList){var g=this;f.each(c,
function(a,c){g.classList.remove(c)})}else this.className=this.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")});return this};h.prototype.prev=function(){return new h(this._selection[0].previousElementSibling)};h.prototype.next=function(){return new h(this._selection[0].nextElementSibling)};h.prototype.html=function(a){if(e.isNoU(a))return this._selection[0].innerHTML;this.each(function(c,d){this.innerHTML=a});return this};h.prototype.display=function(a){f.each(this._selection,
function(c,d){this.style.display=a});return this};h.prototype.show=function(){return this.display("")};h.prototype.hide=function(){return this.display("none")};var f=function(a){return new h(a)};f.find=function(a){return f().find(a)};f.each=function(a,c){for(var d=0,e=a.length;d<e&&!1!==c.call(a[d],d,a[d]);d++);return this};f.ajax=function(a){var c;c=e.isNoU(a)||e.isNoU(a.url)?a:a.url;var d=new XMLHttpRequest;d.open("GET",c);d.onload=function(){200===d.status?e.isFunction(a.success)&&a.success(d.responseText):
e.isFunction(a.error)&&a.error(d)};d.send();return this};f.wrapElement=function(a,c){a=document.createElement(a);"string"===typeof c?a.innerHTML=c:a.appendChild(c);return a};f.wrapCss=function(a,c){for(var d=/([.,\w])([^/{};]+)({)/g,e,f=null,h="";e=d.exec(c);)null!=f&&(h+=a+" "+c.substring(f.index,e.index)),f=e;null!=f&&(h+=a+" "+c.substring(f.index));""!=h&&(c=h);return c};f.appendCss=function(a,c){var d=null,f;"string"===typeof a?(f=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style"),
d.type="text/css",d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a))):a instanceof Element&&(d=a);e.isNoU(c)||f.removeChild(c);e.isNoU(d)||f.appendChild(d);return d};f.getClosest=function(a,c){for(;a&&a!==document;a=a.parentNode)if(a.matches(c))return a;return null};f.getPosition=function(a){for(var c=f.isInView(a),d=0,e=0;a;){if("BODY"==a.tagName)var h=a.scrollTop||document.documentElement.scrollTop,d=d+(a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+
a.clientLeft),e=e+(a.offsetTop-h+a.clientTop);else d+=a.offsetLeft-a.scrollLeft+a.clientLeft,e+=a.offsetTop-a.scrollTop+a.clientTop;a=a.offsetParent}return{x:d,y:e,visible:c}};f.isInView=function(a){a=a.getBoundingClientRect();return 0<a.bottom&&0<a.right&&a.left<(window.innerWidth||document.documentElement.clientWidth)&&a.top<(window.innerHeight||document.documentElement.clientHeight)};Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||
Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var c=a.length;0<=--c&&a.item(c)!==this;);return-1<c});return this.zuix=this.zuix||{controller:l,load:C,unload:J,componentize:m,context:E,hook:function(a,c){L(a,c);return this},$:f,field:n,TaskQueue:r,ZQuery:h,dumpCache:function(){console.log("ZUIX","Component Cache",y)},dumpContexts:function(){console.log("ZUIX",
"Loaded Component Instances",x)}}}(function(d,k){"function"===typeof define&&define.amd?define(["zuix"],function(){return d.zuix=k.call(d)}):"object"===typeof module&&module.exports?module.exports=k.call(d):d.zuix=k.call(d)})(this,Zuix);
//# sourceMappingURL=zuix.min.js.map
