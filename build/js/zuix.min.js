/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var $jscomp={scope:{},findInternal:function(c,f,g){c instanceof String&&(c=String(c));for(var h=c.length,k=0;k<h;k++){var m=c[k];if(f.call(g,m,k,c))return{i:k,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[f]=g.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,f,g,h){if(f){g=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var k=c[h];k in g||(g[k]={});g=g[k]}c=c[c.length-1];h=g[c];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,g){return $jscomp.findInternal(this,c,g).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var f=0;return $jscomp.iteratorPrototype(function(){return f<c.length?{done:!1,value:c[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(c,f){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var g=0,h={next:function(){if(g<c.length){var k=g++;return{value:f(k,c[k]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};
$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");
(function(){function c(a){this.options=a;this.contextId=d.isNoU(a)||d.isNoU(a.contextId)?null:a.contextId;this.componentId=d.isNoU(a)||d.isNoU(a.componentId)?null:a.componentId;this._container=d.isNoU(a)||d.isNoU(a.container)?null:a.container;this._model=d.isNoU(a)||d.isNoU(a.model)?null:a.model;this._view=d.isNoU(a)||d.isNoU(a.view)?null:a.view;this._controller=d.isNoU(a)||d.isNoU(a.controller)?null:a.controller;this._c=this.behavior=null;return this}function f(a){var b=this;this.context=a;this.componentId=
a.componentId;this.view=function(){return a.view()};this.model=function(){return a.model()};this.expose=function(b,c){a[b]=c};this.behavior=function(){return a.behavior};this._fieldCache=[];this.api=this.event=this.refresh=this.destroy=this.pause=this.resume=this.create=null;this.trigger=function(e,c){d.isNoU(a._eventMap[e])&&this.addEvent(b.view(),e,null);b.view().trigger(e,c)};this.on=function(a,c){this.addEvent(b.view(),a,c)};this.invoke=function(a,c){d.isFunction(b.api)&&b.api(a,c)};this.eventRouter=
function(e,c){d.isFunction(b.behavior())&&b.behavior().call(b.view(),e,c);d.isFunction(a._eventMap[e.type])&&a._eventMap[e.type].call(b.view(),e,c)};a.controller().call(this,this);return this}function g(a){return a}function h(a,b){d.isNoU(b)&&(b=document);return $(b).find('[data-ui-field\x3d"'+a+'"]')}function k(a,b,e){if(null===b){var c="zuix-include-"+ ++u;document.write('\x3cdiv data-ui-include\x3d"'+a+'" data-ui-field\x3d"'+c+'" /\x3e');b=zuix.field(c)}v(a,{auto:!1,markdown:!0,ready:function(a){$(b).append(a.view());
d.isFunction(e)&&e(a)},error:function(a,c){$(b).append($("\x3cp\x3e").append("ERROR zuix.include"));$(b).append($("\x3cp\x3e").append(data));d.isFunction(e)&&e(a,c)}})}function m(a){d.isNoU(a)&&(a=document);$(a).find("[data-ui-load]").each(function(){var a=$(this).attr("data-ui-load");if(!0===$(this).attr("data-ui-loaded")||$(this).parent("pre,code").length)console.log("Skipped",this);else{$(this).attr("data-ui-loaded",!0);var e={view:$(this)};d.isNoU($(this).attr("data-ui-ready"))||(e.ready=d.propertyFromPath(window,
$(this).attr("data-ui-ready")));d.isNoU($(this).attr("data-ui-error"))||(e.error=d.propertyFromPath(window,$(this).attr("data-ui-error")));d.isNoU($(this).attr("data-ui-container"))||(e.container=$(this).attr("data-ui-container"));d.isNoU($(this).attr("data-ui-model"))||(e.model=d.propertyFromPath(window,$(this).attr("data-ui-model")));d.isNoU($(this).attr("data-ui-view"))||(e.view=$(this).attr("data-ui-view"));d.isNoU($(this).attr("data-ui-controller"))||(e.controller=d.propertyFromPath(window,$(this).attr("data-ui-controller")));
zuix.load(a,e)}})}function x(a,b){l.push({tid:a,fn:b,status:0});setTimeout(function(){n()},1)}function n(){for(var a=-1,b=0;b<l.length;b++)if(-2!=a&&0==l[b].status)a=b;else{if(1==l[b].status){console.log("... waiting task ",l[b].tid);setTimeout(n,10);return}if(2==l[b].status){console.log("Completed task ",l[b].tid,a);l.splice(b,1);setTimeout(n,10);return}}0<=a?(l[a].status=1,l[a].fn.call(l[a]),console.log("Started task ",l[a].tid),d.isFunction(q)&&q(),setTimeout(n,10)):d.isFunction(r)&&r()}function v(a,
b){var e=null;d.isNoU(b)?(b={},e=new c(b)):d.isNoU(b.contextId)?(!1===b&&(b={auto:!1}),b.contextId="zuix-ctx-"+ ++u,e=new c(b),p.push(e)):(e=B(b.contextId),null!==e?(d.isNoU(b.view)||e.view(b.view),d.isNoU(b.model)||e.model(b.model),d.isNoU(b.controller)||e.controller(b.controller)):(e=new c(b),p.push(e)));e.componentId!=a&&(e.componentId=a);a=y(e.componentId);null!==a&&d.isNoU(e.controller())&&e.controller(a.controller);d.isFunction(b.ready)&&(e.ready=b.ready);d.isFunction(b.error)&&(e.error=b.error);
if(d.isNoU(b.view)){if(null!==a?e.view(a.view):(a=$(document).find('[data-ui-view\x3d"'+e.componentId+'"]'),1<=a.length&&e.view(a.eq(0))),d.isNoU(e.view()))return x("html:"+e.componentId,function(){var a=this;$.ajax({url:e.componentId+".html?"+(new Date).getTime(),dataType:"text",type:"GET",success:function(a){e.view(a);z(e)},error:function(a){console.log(a);d.isFunction(b.error)&&e.error(e,a)}}).then(function(){a.status=2})}),e}else e.view(b.view);z(e);return e}function C(a){d.isNoU(a)||d.isNoU(a._c)||
(d.isNoU(a._c.view())||a._c.view().removeAttr("data-ui-component"),d.isFunction(a._c.destroy)&&a._c.destroy())}function B(a){var b=null;$.each(p,function(e,c){if(d.objectEquals(c.contextId,a))return b=c,!1});return b}function y(a){var b=null;$.each(t,function(c,f){if(d.objectEquals(f.componentId,a))return b=f,!1});return b}function z(a){null===a.controller()&&!1!==a.options.auto?x("js:"+a.componentId,function(){var b=this;$.ajax({url:a.componentId+".js?"+(new Date).getTime(),dataType:"text",type:"GET",
success:function(b){try{var c=b.indexOf(".load");1<c&&(b=b.substring(0,c-4));var e=b.indexOf(".controller");1<e&&(b=b.substring(e+11));a.controller(D(b))}catch(w){console.log(b);console.log(w);d.isFunction(a.error)&&a.error(a,w);return}A(a)},error:function(b){console.log(b);d.isFunction(a.error)&&a.error(a,b)}}).then(function(){b.status=2})}):A(a)}function A(a){d.isNoU(a.view())||(null===y(a.componentId)&&t.push({componentId:a.componentId,view:$("\x3cdiv\x3e").append(a.view().clone()).html(),controller:a.controller()}),
d.isNoU(a.container())||(a.view().detach(),a.container().append(a.view())),a.view().one("create",function(){if(d.isFunction(a.controller())){var b=a._c=new f(a);d.isNoU(b.view())||b.view().attr("data-ui-component",b.componentId);d.isFunction(b.create)&&b.create();d.isFunction(b.resume)&&b.resume();d.isFunction(b.refresh)&&b.refresh()}d.isFunction(a.ready)&&a.ready(a)}),a.view().trigger("create"))}function D(a){var b=function(a){};"string"===typeof a&&(b=E(a));return b}var t=[],p=[];c.prototype.ready=
function(a){};c.prototype.error=function(a,b){};c.prototype.on=function(a,b){return this._c.on(a,b)};c.prototype.invoke=function(a,b){return this._c.invoke(a,b)};c.prototype.model=function(a){if(d.isNoU(a))return this._model;this._model=a;return this};c.prototype.view=function(a){if("undefined"===typeof a)return this._view;"string"===typeof a?(!0!==this.options.markdown||d.isNoU(showdown)||(a=(new showdown.Converter).makeHtml(a)),this._view=$("\x3cdiv/\x3e").append(a),this._view.find("code").each(function(a,
c){$(c).addClass("language-javascript");Prism.highlightElement(c)}),componentHandler&&componentHandler.upgradeElements(this._view[0]),m(this._view)):this._view=a;return this};c.prototype.controller=function(a){if(d.isNoU(a))return this._controller;this._controller=a;return this};c.prototype.container=function(a){if(d.isNoU(a))return this._container;this._container=$(a);return this};c.prototype._eventMap=[];f.prototype.addEvent=function(a,b,c){console.log(a,b);d.isNoU(a)||(a.off(b,this.eventRouter),
this.context._eventMap[b]=c,a.on(b,this.eventRouter))};f.prototype.field=function(a,b){var c=b?"@"+a:a;"undefined"===typeof this._fieldCache[c]?(a=b?$(a):this.view().find("[data-ui-field\x3d"+a+"]"),a.length&&(this._fieldCache[c]=a)):a=this._fieldCache[c];return a};f.prototype.clearCache=function(){this._fieldCache.length=0};var E=eval,u=0,q=null,r=null,l=[],d={isNoU:function(a){return"undefined"===typeof a||null===a},isFunction:function(a){return"function"===typeof a},objectEquals:function(a,b){if(null===
a||void 0===a||null===b||void 0===b)return a===b;if(a.constructor!==b.constructor)return!1;if(a instanceof Function||a instanceof RegExp)return a===b;if(a===b||a.valueOf()===b.valueOf())return!0;if(Array.isArray(a)&&a.length!==b.length||a instanceof Date||!(a instanceof Object)||!(b instanceof Object))return!1;var c=Object.keys(a);return Object.keys(b).every(function(a){return-1!==c.indexOf(a)})&&c.every(function(c){return d.objectEquals(a[c],b[c])})},propertyFromPath:function(a,b){if("string"===
typeof b){b=b.replace(/\[(\w+)\]/g,".$1");b=b.replace(/^\./,"");b=b.split(".");for(var c=0,d=b.length;c<d;++c){var f=b[c];if("undefined"!==typeof a[f])a=a[f];else return}return a}}};return this.zuix=this.zuix||{controller:g,load:v,unload:C,componentize:m,include:k,loadBegin:function(a){q=a},loadEnd:function(a){r=a},field:h,dumpCache:function(){console.log("ZUIX","Component Cache",t)},dumpContexts:function(){console.log("ZUIX","Loaded Component Instances",p)}}}).call(this);
//# sourceMappingURL=zuix.min.js.map
