/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.
         https://genielabs.github.io/zuix

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
'use strict';!function(A){if("object"==typeof exports)module.exports=A();else if("function"==typeof define&&define.amd)define(A);else{var k;"undefined"!=typeof window?k=window:"undefined"!=typeof global?k=global:"undefined"!=typeof self&&(k=self);k.zuix=A()}}(function(){return function k(p,q,b){function f(a,c){if(!q[a]){if(!p[a]){var e="function"==typeof require&&require;if(!c&&e)return e(a,!0);if(d)return d(a,!0);throw Error("Cannot find module '"+a+"'");}e=q[a]={exports:{}};p[a][0].call(e.exports,
function(c){var g=p[a][1][c];return f(g?g:c)},e,e.exports,k,p,q,b)}return q[a].exports}for(var d="function"==typeof require&&require,c=0;c<b.length;c++)f(b[c]);return f}({1:[function(k,p,q){function b(c){f=window?window.console:{};this._context=c;this._timers={};this.args=function(a,c,d){a="%c "+c+" %c"+(new Date).toISOString()+" %c"+a;c=["background-color:rgba(200,200,200,0.2);color:#8a53ff;","background-color:rgba(200,200,200,0.2);color:#777777","background-color:rgba(200,200,200,0.2);color:#888888;"];
for(var b=0;b<d.length;b++)if("string"==typeof d[b]&&0==d[b].indexOf("timer:")){var g=d[b].split(":");if(3==g.length)switch(g[2]){case "start":this._timers[g[1]]=(new Date).getTime();a+=" %cSTART "+g[1];c.push("background-color:rgba(200,200,200,0.2);color:#999900;");break;case "stop":a+=" %cSTOP "+g[1]+" "+((new Date).getTime()-this._timers[g[1]])+" ms",c.push("background-color:rgba(200,200,200,0.2);color:#00aa00;")}}a+=" \n%c ";c.push("background-color:transparent;color:inherit;");for(b=c.length-
1;0<=b;b--)Array.prototype.unshift.call(d,c[b]);Array.prototype.unshift.call(d,a);Array.prototype.push.call(d,"\n\n")}}var f=null,d="log info warn error debug trace dir group groupCollapsed groupEnd time timeEnd profile profileEnd dirxml assert count markTimeline timeStamp clear".split(" ");b.prototype.console=function(c){if(c)window.console=f;else for(window.console={},c=0;c<d.length;c++)window.console[d[c]]||(window.console[d[c]]=function(){})};b.prototype.i=b.prototype.info=b.prototype.l=b.prototype.log=
function(){this.args(this._context,"INFO",arguments);f.log.apply(f,arguments);return this};b.prototype.w=b.prototype.warn=function(){this.args(this._context,"WARN",arguments);f.log.apply(f,arguments);return this};b.prototype.e=b.prototype.error=function(){this.args(this._context,"ERROR",arguments);f.log.apply(f,arguments);return this};b.prototype.d=b.prototype.debug=function(){this.args(this._context,"DEBUG",arguments);f.log.apply(f,arguments);return this};b.prototype.t=b.prototype.trace=function(){this.args(this._context,
"TRACE",arguments);f.log.apply(f,arguments);return this};p.exports=function(c){return new b(c)}},{}],2:[function(k,p,q){function b(d){var c=this;c._worker=null;c._taskList=[];c._requests=[];null==d&&(d=function(){});c.taskQueue=function(a,b,e){c._taskList.push({tid:a,fn:b,status:0,priority:e,step:function(a){f.t(a,"load:step");d(c,"load:step",{task:a})},end:function(){this.status=2;f.t(this.tid,"load:next","timer:task:stop");d(c,"load:next",{task:this.tid});c._taskList.splice(this.index,1);c.taskCheck();
null!=this._callback&&this._callback.call(this)},callback:function(a){this._callback=a}});f.t(a,"task added",e,"priority");c._taskList.sort(function(a,c){return a.priority>c.priority?1:c.priority>a.priority?-1:0});c.taskCheck()};c.taskCheck=function(){for(var a=0;a<c._taskList.length;a++){if(0==c._taskList[a].status){c._taskList[a].status=1;f.t(c._taskList[a].tid,"load:begin",a,"timer:task:start");d(c,"load:begin",{task:c._taskList[a].tid});c._taskList[a].index=a;c._taskList[a].fn.call(c._taskList[a]);
return}if(1==c._taskList[a].status||2==c._taskList[a].status)return}f.t("load:end");d(c,"load:end")}}var f=k("./Logger")("TaskQueue.js");b.prototype.queue=function(b,c,a){return this.taskQueue(b,c,a)};b.prototype.requestLock=function(b){return null!=b._taskerLock?!1:b._taskerLock=!0};b.prototype.releaseLock=function(b){setTimeout(function(){delete b._taskerLock},10)};b.prototype.lockLater=function(b,c,a){var f=this;null==b._taskerLock?c():null==b._taskerTimeout&&(b._taskerTimeout=!0,b._taskerTimeout=
setTimeout(function(){delete b._taskerTimeout;f.lockLater(b,c,a)},a));return!0};p.exports=b},{"./Logger":1}],3:[function(k,p,q){p.exports={isNoU:function(b){return"undefined"===typeof b||null===b},isFunction:function(b){return"function"===typeof b},objectEquals:function(b,f){if(null===b||void 0===b||null===f||void 0===f)return b===f;if(b.constructor!==f.constructor)return!1;if(b instanceof Function||b instanceof RegExp)return b===f;if(b===f||b.valueOf()===f.valueOf())return!0;if(Array.isArray(b)&&
b.length!==f.length||b instanceof Date||!(b instanceof Object)||!(f instanceof Object))return!1;var d=Object.keys(b);return Object.keys(f).every(function(b){return-1!==d.indexOf(b)})&&d.every(function(c){return util.objectEquals(b[c],f[c])})},propertyFromPath:function(b,f){if("string"===typeof f){f=f.replace(/\[(\w+)]/g,".$1");f=f.replace(/^\./,"");for(var d=f.split("."),c=b,a=0,k=d.length;a<k;++a){var e=d[a];if("undefined"!==typeof c[e])c=c[e];else return}return c}},cloneObject:function f(d){if(null===
d||"object"!==typeof d)return d;var c=d.constructor(),a;for(a in d)c[a]=f(d[a]);return c},evalJs:eval}},{}],4:[function(k,p,q){function b(a){c(this,a.type,a)}function f(a,c,d){var e=!1;g.each(m,function(){if(this.element===a&&this.path===c&&this.handler==d)return t.w("Handler already registered",a,c,d),e=!0,!1});e||(m.push({element:a,path:c,handler:d}),a.addEventListener(c,b,!1))}function d(a,c,d){var e=1,f=-1;g.each(m,function(b){this.element===a&&this.path===c&&this.handler==d&&(e--,f=b)});-1!==
f&&m.splice(f,1);0==e&&a.removeEventListener(c,b)}function c(a,b,c){var d=g(a);g.each(m,function(){this.element===a&&this.path===b&&this.handler.call(d,c)})}function a(h){this._selection=[];"undefined"===typeof h&&(h=document.documentElement);if(h instanceof a)return h;if(h instanceof HTMLCollection||h instanceof NodeList||Array.isArray(h))this._selection=h;else if(h instanceof HTMLElement||h instanceof Node)this._selection=[h];else if("string"===typeof h)this._selection=document.documentElement.querySelectorAll(h);
else if(null!==h)throw t.e("ZxQuery cannot wrap object of this type.",typeof h,h),Error(),h;return this}var t=k("./Logger")("TaskQueue.js"),e=k("./Util.js"),m=[];a.prototype.length=function(){return this._selection.length};a.prototype.parent=function(h){return e.isNoU(h)?new a(this._selection[0].parentNode):new a(g.getClosest(this._selection[0],h))};a.prototype.children=function(h){return e.isNoU(h)?new a(this._selection[0].children):new a(this._selection[0].querySelectorAll(h))};a.prototype.reverse=
function(){this._selection=Array.prototype.slice.call(this._selection,0).reverse();return this};a.prototype.get=function(a){e.isNoU(a)&&(a=0);return this._selection[a]};a.prototype.eq=function(h){return new a(this._selection[h])};a.prototype.find=function(h){return new a(this._selection[0].querySelectorAll(h))};a.prototype.each=function(a){g.each(this._selection,a);return this};a.prototype.attr=function(a,b){if(e.isNoU(b))return this._selection[0].getAttribute(a);this.each(function(c,d){this.get().setAttribute(a,
b)});return this};a.prototype.trigger=function(a,b){var c;window.CustomEvent?c=new CustomEvent(a,{detail:b}):(c=document.createEvent("CustomEvent"),c.initCustomEvent(a,!0,!0,b));this.each(function(a,h){h.dispatchEvent(c)});return this};a.prototype.one=function(a,b){var c=!1;this.on(a,function(d,e){c||(c=!0,g(this).off(a,b),b.call(this,d,e))});return this};a.prototype.on=function(a,b){var c=a.match(/\S+/g)||[];this.each(function(a,h){g.each(c,function(a,c){"body"===h.tagName.toLowerCase()&&(h=document);
f(h,c,b)})});return this};a.prototype.off=function(a,b){var c=a.match(/\S+/g)||[];this.each(function(a,h){g.each(c,function(a,c){"body"===h.tagName.toLowerCase()&&(h=document);d(h,c,b)})});return this};a.prototype.isEmpty=function(){return 0===this._selection[0].innerHTML.replace(/\s/g,"").length};a.prototype.position=function(){return null!=this._selection[0]?g.getPosition(this._selection[0]):{x:-1,y:-1,visible:!1}};a.prototype.css=function(a,b){var c=this;if("object"===typeof a)t.t(typeof a,a,Object.keys(a).length),
g.each(a,function(b,d){c.each(function(c,g){t.t(a,c,g);g.style[b]=d})});else{if(e.isNoU(b))return this._selection[0].style[a];c.each(function(c,d){d.style[a]=b})}return this};a.prototype.addClass=function(a){var b=a.match(/\S+/g)||[];g.each(this._selection,function(c,d){d.classList?g.each(b,function(a,h){d.classList.add(h)}):d.className+=" "+a});return this};a.prototype.hasClass=function(a){return g.hasClass(this._selection[0],a)};a.prototype.removeClass=function(a){var b=a.match(/\S+/g)||[];g.each(this._selection,
function(c,d){d.classList?g.each(b,function(a,h){d.classList.remove(h)}):d.className=d.className.replace(new RegExp("(^|\\b)"+a.split(" ").join("|")+"(\\b|$)","gi")," ")});return this};a.prototype.prev=function(){return new a(this._selection[0].previousElementSibling)};a.prototype.next=function(){return new a(this._selection[0].nextElementSibling)};a.prototype.html=function(a){if(e.isNoU(a))return this._selection[0].innerHTML;this.each(function(b,c){c.innerHTML=a});return this};a.prototype.append=
function(a){"string"===typeof a?this._selection[0].innerHTML+=a:this._selection[0].appendChild(a);return this};a.prototype.prepend=function(a){"string"===typeof a?this._selection[0].innerHTML=a+this._selection[0].innerHTML:this._selection[0].insertBefore(a,this._selection[0].innerHTML.firstElementChild);return this};a.prototype.display=function(a){if(e.isNoU(a))return this._selection[0].style.display;g.each(this._selection,function(b,c){c.style.display=a});return this};a.prototype.visibility=function(a){if(e.isNoU(a))return this._selection[0].style.visibility;
g.each(this._selection,function(b,c){c.style.visibility=a});return this};a.prototype.show=function(){return this.display("")};a.prototype.hide=function(){return this.display("none")};var g=function(c){return new a(c)};g.find=function(a){return g().find(a)};g.each=function(a,c){var b=null==a?0:Object.keys(a).length;if(0<b){var d=0,e;for(e in a){var f=a[e];f instanceof Element&&(f=g(f));if(!1===c.call(f,e,a[e]))break;d++;if(d>=b)break}}return this};g.hasClass=function(a,c){var b=c.match(/\S+/g)||[],
d=!1;g.each(b,function(c,b){if(d=a.classList?a.classList.contains(b):(new RegExp("(^| )"+b+"( |$)","gi")).test(a.className))return!1});return d};g.ajax=function(a){var b;b=e.isNoU(a)||e.isNoU(a.url)?a:a.url;var c=new XMLHttpRequest;c.open("GET",b);c.onload=function(){200===c.status?e.isFunction(a.success)&&a.success(c.responseText):e.isFunction(a.error)&&a.error(c);e.isFunction(a.then)&&a.then(c)};c.send();return this};g.wrapElement=function(a,c){var b=document.createElement(a);"string"===typeof c?
b.innerHTML=c:b.appendChild(c);return b};g.wrapCss=function(a,c){for(var b=/([.,\w])([^/{};]+)({)/g,d,e=null,f="";d=b.exec(c);){if(null!=e){var e=c.substring(e.index,d.index),m=/(.*)[^s]\{([^\}]+)[\}]/g.exec(e);if(null!=m&&1<m.length){var k=m[1].split(",");g.each(k,function(c,b){f+="\n"+a+"\n"+b;c<k.length-1&&(f+=", ")});f+=" {"+m[2]+"}\n"}else t.w("ZUIX WARNING: z$.wrapCss was unable to parse rule.",m,e)}e=d}null!=e&&(f+=a+" "+c.substring(e.index));""!=f&&(c=f);return c};g.appendCss=function(a,c){var b=
null,d;"string"===typeof a?(d=document.head||document.getElementsByTagName("head")[0],b=document.createElement("style"),b.type="text/css",b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a))):a instanceof Element&&(b=a);e.isNoU(c)||d.removeChild(c);e.isNoU(b)||d.appendChild(b);return b};g.getClosest=function(a,c){for(;a&&a!==document;a=a.parentNode)if(a.matches(c))return a;return null};g.getPosition=function(a){for(var c=g.isInView(a),b=0,d=0;a;){if("BODY"==a.tagName)var e=
a.scrollTop||document.documentElement.scrollTop,b=b+(a.offsetLeft-(a.scrollLeft||document.documentElement.scrollLeft)+a.clientLeft),d=d+(a.offsetTop-e+a.clientTop);else b+=a.offsetLeft-a.scrollLeft+a.clientLeft,d+=a.offsetTop-a.scrollTop+a.clientTop;a=a.offsetParent}return{x:b,y:d,visible:c}};g.isInView=function(a){if(null===a.offsetParent)return!1;a=a.getBoundingClientRect();return 0<a.bottom&&0<a.right&&a.left<(window.innerWidth||document.documentElement.clientWidth)&&a.top<(window.innerHeight||
document.documentElement.clientHeight)};g.ZxQuery=a;Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){a=(this.document||this.ownerDocument).querySelectorAll(a);for(var b=a.length;0<=--b&&a.item(b)!==this;);return-1<b});(function(){function a(b,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=
document.createEvent("CustomEvent");d.initCustomEvent(b,c.bubbles,c.cancelable,c.detail);return d}if("function"===typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype;window.CustomEvent=a})();p.exports=g},{"./Logger":1,"./Util.js":3}],5:[function(k,p,q){k=k("./zuix/Zuix.js");"object"===typeof p&&p.exports?p.exports=k.call(this):this.zuix=k.call(this)},{"./zuix/Zuix.js":8}],6:[function(k,p,q){function b(a,b){this._options=null;this.contextId=null==a||null==a.contextId?null:a.contextId;
this.componentId=null;this.trigger=function(a,c,d){"function"===typeof b&&b(a,c,d)};this.behavior=this._controller=this._style=this._css=this._view=this._model=this._container=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(a);return this}var f=k("../helpers/Logger")("ComponentContext.js"),d=k("../helpers/ZxQuery"),c=k("../helpers/Util");b.prototype.container=function(a){if(null==a)return this._container;this._container=a;return this};b.prototype.view=function(a){if("undefined"===
typeof a)return this._view;"string"===typeof a?(a={content:a},this.trigger(this,"html:parse",a),a=a.content,null!=this._container?(this._view=this._container,this._view.innerHTML+=a):(a=d.wrapElement("div",a),null!=this._view?this._view.innerHTML=a.innerHTML:this._view=a),d(this._view).find("script").each(function(a,b){"true"!==this.attr("zuix-loaded")&&(this.attr("zuix-loaded","true"),eval.call(window,b.innerHTML))}),this.trigger(this,"view:process",d(this._view))):(a instanceof d.ZxQuery&&(a=a.get()),
null!=this._container?(this._view=d.wrapElement("div",a.outerHTML).firstElementChild,this._view.removeAttribute("data-ui-view"),this._container.appendChild(this._view),this._view=this._container):this._view=a);a=d(this._view);!1===this._options.css?a.addClass("zuix-css-ignore"):a.removeClass("zuix-css-ignore");this.modelToView();return this};b.prototype.style=function(a){if("undefined"===typeof a)return this._style;null==a||a instanceof Element?(this._css=a instanceof Element?a.innerText:a,this._style=
d.appendCss(a,this._style)):"string"===typeof a&&(this._css=a,a=d.wrapCss('[data-ui-component="'+this.componentId+'"]:not(.zuix-css-ignore)',a),a={content:a},this.trigger(this,"css:parse",a),a=a.content,this._style=d.appendCss(a,this._style));return this};b.prototype.model=function(a){if("undefined"===typeof a)return this._model;this._model=a;this.modelToView();return this};b.prototype.controller=function(a){if("undefined"===typeof a)return this._controller;this._controller=a;return this};b.prototype.options=
function(a){if(null==a)return this._options;this._options=a;null!=a.componentId&&(this.componentId=a.componentId);this.container(a.container);this.view(a.view);"undefined"!==typeof a.css&&this.style(a.css);this.controller(a.controller);this.model(a.model);return this};b.prototype.on=function(a,b){this._c.on(a,b);return this};b.prototype.loadCss=function(a,b){var e=this;c.isNoU(a)&&(a={});c.isNoU(a.caching)||(b=a.caching);var m=e.componentId+".css";c.isNoU(a.path)||(m=a.path);b||(m+="?"+(new Date).getTime());
d.ajax({url:m,success:function(b){e.style(b);c.isFunction(a.success)&&a.success.call(e,b)},error:function(b){f.e(b,e);c.isFunction(a.error)&&a.error.call(e,b)},then:function(){c.isFunction(a.then)&&a.then.call(e)}});return this};b.prototype.loadHtml=function(a,b){var e=this,m=e.componentId;c.isNoU(a)&&(a={});c.isNoU(a.caching)||(b=a.caching);c.isNoU(a.path)||(m=a.path);var g=d().find('[data-ui-view="'+m+'"]:not([data-ui-component*=""])');0<g.length()?(m=g.get(0),e.view()===m||null!=e.container()&&
e.container().contains(m)?e.view(m):e.view(m.outerHTML),m=e.view().innerHTML,c.isFunction(a.success)&&a.success.call(e,m),c.isFunction(a.then)&&a.then.call(e)):(m==e.componentId&&(m+=".html"+(b?"":"?"+(new Date).getTime())),d.ajax({url:m,success:function(b){e.view(b);c.isFunction(a.success)&&a.success.call(e,b)},error:function(b){f.e(b,e);c.isFunction(a.error)&&a.error.call(e,b)},then:function(){c.isFunction(a.then)&&a.then.call(e)}}));return this};b.prototype.viewToModel=function(){var a=this;this._model=
{};d(this._view).find("[data-ui-field]").each(function(b,c){if(0<this.parent("pre,code").length())return!0;var d=this.attr("data-ui-field");if(0<d.indexOf(".")){for(var d=d.split("."),g=a._model,f=0;f<d.length-1;f++)"undefined"===typeof g[d[f]]&&(g[d[f]]={}),g=g[d[f]];g[d[d.length-1]]=c}else a._model[d]=c});return this};b.prototype.modelToView=function(){if(null!=this._view&&null!=this._model){var a=this;d(this._view).find("[data-ui-field]").each(function(b,e){if(0<this.parent("pre,code").length())return!0;
var f=this.attr("data-bind-to");null==f&&(f=this.attr("data-ui-field"));if("function"===typeof a._model)a._model.call(d(a._view),this,f);else{var g=c.propertyFromPath(a._model,f);if("function"===typeof g)g.call(d(a._view),this,f);else if(null!=g)switch(e.tagName.toLowerCase()){case "img":e.src=g.src||g.innerHTML||g;g.alt&&(e.alt=g.alt);break;case "a":e.href=g.href||g.innerHTML||g;g.title&&(e.title=g.title);break;case "input":e.value=g.value||g.innerHTML||g;break;default:e.innerHTML=g.innerHTML||g}}})}return this};
p.exports=b},{"../helpers/Logger":1,"../helpers/Util":3,"../helpers/ZxQuery":4}],7:[function(k,p,q){function b(b){var c=this;this._view=null;this.context=b;this._fieldCache=[];this.destroy=this.create=this.init=null;this._childNodes=[];this.saveView=function(){this.restoreView();this.view().children().each(function(a,b){c._childNodes.push(b)})};this.restoreView=function(){0<this._childNodes.length&&(c.view().html(""),f.each(c._childNodes,function(a,b){c.view().append(b)}),this._childNodes.length=
0)};this.on=function(a,b){this.addEvent(this.view(),a,b);return this};this.mapEvent=function(a,b,c,d){null!=b&&(b.off(c,this.eventRouter),a[c]=d,b.on(c,this.eventRouter))};this.eventRouter=function(a){"function"===typeof b._behaviorMap[a.type]&&b._behaviorMap[a.type].call(c.view(),a,a.detail);"function"===typeof b._eventMap[a.type]&&b._eventMap[a.type].call(c.view(),a,a.detail)};var a=b.options(),k=null;if(null!=a.on)for(var e in a.on)k=a.on[e],c.addEvent(c.view(),e,k);if(null!=a.behavior)for(var m in a.behavior)k=
a.behavior[m],c.addBehavior(c.view(),m,k);b.controller().call(this,this);return this}var f=k("../helpers/ZxQuery");b.prototype.addEvent=function(b,c,a){this.mapEvent(this.context._eventMap,b,c,a);return this};b.prototype.addBehavior=function(b,c,a){this.mapEvent(this.context._behaviorMap,b,c,a);return this};b.prototype.field=function(b){return null};b.prototype.clearCache=function(){this._fieldCache.length=0};b.prototype.view=function(b){if(null!=this.context.view()||this._view!==this.context.view())this._view=
f(this.context.view());if(null!=b)return this._view.find(b);if(null!==this._view)return this._view;throw{message:"Not attacched to a view yet.",source:this};};b.prototype.model=function(b){if(null==b)return this.context.model();this.context.model(b);return this};b.prototype.options=function(){return this.context.options()};b.prototype.trigger=function(b,c,a){null==this.context._eventMap[b]&&!0!==a&&this.addEvent(this.view(),b,null);!0===a?this.context.trigger(this.context,b,c):this.view().trigger(b,
c);return this};b.prototype.expose=function(b,c){this.context[b]=c;return this};b.prototype.loadCss=function(b){this.context.loadCss(b);return this};b.prototype.loadHtml=function(b){this.saveView();this.context.loadHtml(b);return this};b.prototype.for=function(b){return this};p.exports=b},{"../helpers/ZxQuery":4}],8:[function(k,p,q){function b(){this._fieldCache=[];return this}function f(a,b,c){l.isNoU(c)&&(c=this);null==c._fieldCache&&(c._fieldCache={});var d=null;"undefined"===typeof c._fieldCache[a]?
(d=r(b).find('[data-ui-field="'+a+'"]'),null!=d&&(c._fieldCache[a]=d)):d=c._fieldCache[a];return d}function d(a){w.requestLock(d)?(r(a).find("[data-ui-load]:not([data-ui-loaded=true]),[data-ui-include]:not([data-ui-loaded=true])").each(function(a,b){this.visibility("hidden");var u=b.lazyContainer||r.getClosest(b,"[data-ui-lazyload=scroll]");b.lazyContainer=u;if(!(null!=u&&"force"==u.getAttribute("data-ui-lazyload")||g()&&"false"!=this.attr("data-ui-lazyload")))return c(b),!0;if(null!==u&&(-1==I.indexOf(u)&&
(I.push(u),r(u).on("scroll",function(){d(u)})),!r.getPosition(b).visible))return-1==z.indexOf(b)&&z.push(b),!0;var e=z.indexOf(b);-1<e&&z.splice(e,1);c(b)}),w.releaseLock(d)):w.lockLater(d,function(){d(a)},200)}function c(b){var c=r(b);if("true"===c.attr("data-ui-loaded")||0<c.parent("pre,code").length())n.w("Skipped",b);else{c.attr("data-ui-loaded","true");var d=c.attr("data-ui-options");l.isNoU(d)?d={}:(d=l.propertyFromPath(window,d),d=l.cloneObject(d)||{});l.isNoU(d.view)&&!c.isEmpty()?(d.view=
b,d.viewDeferred=!0):l.isNoU(d.view)&&l.isNoU(d.container)&&c.isEmpty()&&(d.container=b);b=c.attr("data-ui-load");l.isNoU(b)&&(b=c.attr("data-ui-include"),c.attr("data-ui-component",b),l.isNoU(d.controller)&&(d.controller=function(){}));var e=c.attr("data-bind-model");!l.isNoU(e)&&0<e.length&&(d.model=l.propertyFromPath(window,e));e=c.attr("data-ui-context");l.isNoU(e)||(d.contextId=e);c=c.attr("data-ui-priority");l.isNoU(c)?d.priority=x.length:d.priority=c;a(b,d)}}function a(a,b){var c=null;l.isNoU(b)?
(b={},c=new J(b,m)):l.isNoU(b.contextId)?(!1===b&&(b={}),b.contextId="zuix-ctx-"+ ++N,c=t(b)):(c=e(b.contextId),null!==c?c.options(b):c=t(b));c.componentId!=a&&(c.componentId=a);l.isFunction(b.ready)&&(c.ready=b.ready);l.isFunction(b.error)&&(c.error=b.error);var d=G(c.componentId);null!==d&&null==b.controller&&null==c.controller()&&(c.controller(d.controller),n.t(c.componentId,"loaded controller from cache"));if(l.isNoU(b.view)){if(null!==d&&null!=d.view&&(c.view(d.view),n.t(c.componentId,"loaded html from cache"),
null!==d&&l.isNoU(b.css)&&(c.style(d.css),b.css=!1,n.t(c.componentId,"loaded css from cache"))),l.isNoU(c.view()))return w.queue("html:"+c.componentId,function(){var a=this;c.loadHtml({caching:v,success:function(){!1!==b.css?(a.step("css:"+c.componentId),c.loadCss({caching:v,error:function(a){n.e(a,c)},then:function(){B(c,a)}})):B(c,a)},error:function(a){n.e(a,c);l.isFunction(b.error)&&c.error.call(c,a)}})},b.priority),c}else c.view(b.view);w.queue("js:"+c.componentId,function(){B(c,this)},x.length);
return c}function t(a){a=new J(a,m);x.push(a);return a}function e(a){var b=null;a instanceof r.ZxQuery&&(a=a.get());r.each(x,function(c,d){if(a instanceof Element&&(d.view()===a||d.container()===a)||l.objectEquals(d.contextId,a))return b=d,!1});return b}function m(a,b,c){l.isFunction(D[b])&&D[b].call(a,c);"view:process"==b&&d(c)}function g(a){null!=a&&(K=!a);return!E&&!K}function h(a){null!=a&&(v=a);return v}function G(a){var b=null;r.each(y,function(c,d){if(l.objectEquals(d.componentId,a))return b=
d,!1});return b}function B(a,b){if("undefined"===typeof a.options().controller&&null===a.controller())if(n.d(a.componentId,"loading controller"),l.isNoU(b)||b.step("js:"+a.componentId),l.isFunction(F[a.componentId]))a.controller(F[a.componentId]),C(a,b);else{var c=function(b){r.ajax({url:a.componentId+".js"+(v?"":"?"+(new Date).getTime()),success:function(b){try{var c=b.indexOf("function"),d=b.indexOf(".load");1<d&&d<c&&(b=b.substring(0,d-4));var e=b.indexOf(".controller");1<e&&e<c&&(b=b.substring(e+
11));var f=b.indexOf("//<--controller");0<f&&(b=b.substring(0,f));b+='\n//# sourceURL="'+a.componentId+'.js"\n';a.controller(M(b))}catch(g){n.e(Error(),g,b,a),l.isFunction(a.error)&&a.error.call(a,g)}},error:function(b){n.e(b,Error(),a);l.isFunction(a.error)&&a.error.call(a,b)},then:function(){C(a,b)}})};l.isNoU(b)?w.queue("js:"+a.componentId,function(){c(this)},a.options().priority):c(b)}else C(a,b)}function L(a){var b=a.view()===a.container()?a.view().innerHTML:a.view().outerHTML,b=r.wrapElement("div",
b),b={componentId:a.componentId,view:b.innerHTML,css:a._css,controller:a.controller()};y.push(b);n.t(a.componentId,"added to cache",b);return b}function C(a,b){if(l.isNoU(a.view()))n.e(a.componentId,"no view attacched");else{var c=G(a.componentId);a.options().viewDeferred?n.w(a.componentId,"deferred view, not caching"):null===c&&(c=L(a),n.t(a.componentId,"added to cache",c));null!=b&&b.callback(function(){n.d(a.componentId,"controller::create:deferred");H(a._c);d()});n.d(a.componentId,"initializing component");
if(l.isFunction(a.controller())){var e=a._c=new O(a);"function"===typeof e.init&&e.init();if(!l.isNoU(e.view()))if(e.view().attr("data-ui-component",a.componentId),l.isNoU(a.model())&&!l.isNoU(a.view())&&a.viewToModel(),e.trigger("view:apply"),a.options().viewDeferred){a.options().viewDeferred=!1;e.saveView();null===c&&(c={componentId:a.componentId,controller:a.controller()},y.push(c),n.e(a.componentId,"added to cache",c));var f=-1;!1!==a.options().css&&(null==c.css?(-1==f&&(f=0),f++,a.loadCss({caching:v,
success:function(b){c.css=b;n.e(a.componentId,"updated cached css",c,f)},then:function(){0===--f&&null!=b&&b.end()}})):a.style(c.css));!1!==a.options().html&&(null==c.view?(-1==f&&(f=0),f++,a.loadHtml({caching:v,success:function(b){c.view=b;n.e(a.componentId,"updated cached html",c,f)},then:function(){0===--f&&null!=b&&b.end()}})):a.view(c.view));-1==f&&null!=b&&b.end()}else null!=b&&b.end();null==b&&(n.d(a.componentId,"controller::create"),H(e))}else n.w(a.componentId,"no controller defined")}}function H(a){a.field=
function(b){b=f(b,a.view(),a);b.on=function(b,c,d,e){if("string"===typeof c){var f=c;c=function(){a.trigger(f,d,e)}}r.ZxQuery.prototype.on.call(this,b,c)};return b};l.isFunction(a.create)&&a.create();a.trigger("view:create");a.trigger("component:ready",a.view(),!0);l.isFunction(a.context.ready)&&a.context.ready.call(a.context);a.view().css("visibility","");n.d(a.context.componentId,"component created")}function M(a){var b=function(a){};if("string"===typeof a)try{b=eval.call(this,a)}catch(c){n.e(this,
c,a)}return b}var n=k("../helpers/Logger")("Zuix.js"),l=k("../helpers/Util"),r=k("../helpers/ZxQuery");q=k("../helpers/TaskQueue");var J=k("./ComponentContext"),O=k("./ContextController"),y=[],N=0,x=[],D=[],F={},z=[],I=[],w=new q(function(a,b,c){m(a,b,c)}),E=!1,K=!1,v=!0;navigator&&navigator.userAgent&&(E=(new RegExp(/bot|googlebot|crawler|spider|robot|crawling/i)).test(navigator.userAgent));E&&n.d(navigator.userAgent,"is a bot, ignoring 'data-ui-lazyload' option.");b.prototype.controller=function(a){"function"!==
typeof a["for"]&&(a["for"]=function(b){return F[b]=a});return a};b.prototype.field=f;b.prototype.componentize=function(a){d(a);return this};b.prototype.load=a;b.prototype.unload=function(a){l.isNoU(a)||l.isNoU(a._c)||(l.isNoU(a._c.view())||a._c.view().attr("data-ui-component",null),l.isFunction(a._c.destroy)&&a._c.destroy());return this};b.prototype.context=e;b.prototype.trigger=function(a,b,c){m(a,b,c);return this};b.prototype.hook=function(a,b){l.isNoU(b)||(D[a]=b);return this};b.prototype.lazyLoad=
function(a){if(null!=a)g(a);else return g();return this};b.prototype.httpCaching=function(a){if(null!=a)h(a);else return h();return this};b.prototype.setBundle=function(a){y=a};b.prototype.$=r;b.prototype.TaskQueue=q;b.prototype.ZxQuery=r.ZxQuery;b.prototype.dumpCache=function(){n.d("Component Cache",y)};b.prototype.dumpContexts=function(){n.d("Loaded Component Instances",x)};p.exports=function(a){var c=new b;"loading"!=document.readyState?c.componentize():document.addEventListener("DOMContentLoaded",
function(){c.componentize()});return c}},{"../helpers/Logger":1,"../helpers/TaskQueue":2,"../helpers/Util":3,"../helpers/ZxQuery":4,"./ComponentContext":6,"./ContextController":7}]},{},[5])(5)});
//# sourceMappingURL=zuix.min.js.map
