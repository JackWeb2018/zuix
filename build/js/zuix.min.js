/*

 Copyright 2015-2017 G-Labs. All Rights Reserved.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
var $jscomp={scope:{},findInternal:function(c,f,g){c instanceof String&&(c=String(c));for(var h=c.length,k=0;k<h;k++){var n=c[k];if(f.call(g,n,k,c))return{i:k,v:n}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[f]=g.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,f,g,h){if(f){g=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var k=c[h];k in g||(g[k]={});g=g[k]}c=c[c.length-1];h=g[c];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,g){return $jscomp.findInternal(this,c,g).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var f=0;return $jscomp.iteratorPrototype(function(){return f<c.length?{done:!1,value:c[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(c,f){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var g=0,h={next:function(){if(g<c.length){var k=g++;return{value:f(k,c[k]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};
$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6-impl","es3");
(function(){function c(a){this._options=null;this.contextId=d.isNoU(a)||d.isNoU(a.contextId)?null:a.contextId;this.behavior=this._controller=this._view=this._model=this._container=this.componentId=null;this._eventMap=[];this._behaviorMap=[];this._c=null;this.options(a);return this}function f(a){var b=this;this.context=a;this.componentId=a.componentId;this.view=function(){return a.view()};this.model=function(){return a.model()};this.expose=function(b,c){a[b]=c};this.behavior=function(){return a.behavior};
this._fieldCache=[];this.api=this.event=this.refresh=this.destroy=this.pause=this.resume=this.create=null;this.trigger=function(c,e){d.isNoU(a._eventMap[c])&&this.addEvent(b.view(),c,null);b.view().trigger(c,e)};this.on=function(a,c){this.addEvent(b.view(),a,c)};this.invoke=function(a,c){d.isFunction(b.api)&&b.api(a,c)};this.eventRouter=function(c,e){d.isFunction(a._behaviorMap[c.type])&&a._behaviorMap[c.type].call(b.view(),c,e);d.isFunction(a._eventMap[c.type])&&a._eventMap[c.type].call(b.view(),
c,e)};var e=a.options();if(!d.isNoU(e.on))for(var c in e.on){var f=e.on[c];b.addEvent(b.view(),c,f)}if(!d.isNoU(e.behavior))for(c in e.behavior)f=e.behavior[c],b.addBehavior(b.view(),c,f);a.controller().call(this,this);return this}function g(a){return a}function h(a,b){d.isNoU(b)&&(b=document);return $(b).find('[data-ui-field\x3d"'+a+'"]')}function k(a){d.isNoU(a)&&(a=document);$(a).find("[data-ui-load],[data-ui-include]").each(function(){if(!0===$(this).attr("data-ui-loaded")||$(this).parent("pre,code").length)console.log("ZUIX",
"WARN","Skipped",this);else{$(this).attr("data-ui-loaded",!0);var a;d.isNoU($(this).attr("data-ui-options"))?a={}:(a=d.propertyFromPath(window,$(this).attr("data-ui-options")),a=jQuery.extend({},a),console.log("OPTIONS!",a));d.isNoU(a.view)&&!$(this).is(":empty")?a.view=$(this):d.isNoU(a.view)&&d.isNoU(a.container)&&$(this).is(":empty")&&(a.container=$(this));var c=$(this).attr("data-ui-load");d.isNoU(c)&&(c=$(this).attr("data-ui-include"),d.isNoU(a.controller)&&(a.controller=function(){}));w(c,a)}})}
function n(a,b){l.push({tid:a,fn:b,status:0});setTimeout(function(){p()},1)}function p(){for(var a=-1,b=0;b<l.length;b++)if(-2!=a&&0==l[b].status)a=b;else{if(1==l[b].status){setTimeout(p,100);m(this,"load:step",{task:l[b].tid});return}if(2==l[b].status){m(this,"load:next",{task:l[b].tid});l.splice(b,1);setTimeout(p,100);return}}0<=a?(l[a].status=1,l[a].fn.call(l[a]),setTimeout(p,100),m(this,"load:begin",{task:l[a].tid})):m(this,"load:end")}function w(a,b){var e=null;d.isNoU(b)?(b={},e=new c(b)):(console.log("OPTIONS!#",
b),d.isNoU(b.contextId)?(!1===b&&(b={}),b.contextId="zuix-ctx-"+ ++z,e=new c(b),q.push(e)):(e=A(b.contextId),null!==e?e.options(b):(e=new c(b),q.push(e))));e.componentId!=a&&(e.componentId=a);a=x(e.componentId);null!==a&&d.isNoU(e.controller())&&e.controller(a.controller);d.isFunction(b.ready)&&(e.ready=b.ready);d.isFunction(b.error)&&(e.error=b.error);if(d.isNoU(b.view)){if(null!==a?e.view(a.view):(a=$(document).find('[data-ui-view\x3d"'+e.componentId+'"]'),1<=a.length&&e.view(a.eq(0))),d.isNoU(e.view()))return n("html:"+
e.componentId,function(){var a=this;$.ajax({url:e.componentId+".html?"+(new Date).getTime(),dataType:"text",type:"GET",success:function(a){e.view(a);y(e)},error:function(c){a.status=2;console.log(c);d.isFunction(b.error)&&e.error(e,c)}}).then(function(){a.status=2})}),e}else e.view(b.view);y(e);return e}function B(a){d.isNoU(a)||d.isNoU(a._c)||(d.isNoU(a._c.view())||a._c.view().removeAttr("data-ui-component"),d.isFunction(a._c.destroy)&&a._c.destroy())}function A(a){var b=null;$.each(q,function(c,
f){if(d.objectEquals(f.contextId,a))return b=f,!1});return b}function x(a){var b=null;$.each(t,function(c,f){if(d.objectEquals(f.componentId,a))return b=f,!1});return b}function y(a){null===a.controller()?n("js:"+a.componentId,function(){var b=this;$.ajax({url:a.componentId+".js?"+(new Date).getTime(),dataType:"text",type:"GET",success:function(b){try{var c=b.indexOf(".load");1<c&&(b=b.substring(0,c-4));var e=b.indexOf(".controller");1<e&&(b=b.substring(e+11));a.controller(C(b))}catch(v){console.log(b);
console.log(v);d.isFunction(a.error)&&a.error(a,v);return}u(a)},error:function(c){b.status=2;u(a);console.log(c);d.isFunction(a.error)&&a.error(a,c)}}).then(function(){b.status=2})}):u(a)}function u(a){d.isNoU(a.view())||(null===x(a.componentId)&&t.push({componentId:a.componentId,view:$("\x3cdiv\x3e").append(a.view().clone()).html(),controller:a.controller()}),d.isNoU(a.container())||(a.view().detach(),a.container().append(a.view())),a.view().one("create",function(){if(d.isFunction(a.controller())){var b=
a._c=new f(a);d.isNoU(b.view())||b.view().attr("data-ui-component",b.componentId);d.isFunction(b.create)&&b.create();d.isFunction(b.resume)&&b.resume();d.isFunction(b.refresh)&&b.refresh()}d.isFunction(a.ready)&&a.ready(a)}),a.view().trigger("create"))}function C(a){var b=function(a){};"string"===typeof a&&(b=D(a));return b}function m(a,b,c){d.isFunction(r[b])&&r[b].call(a,b,c)}function E(a,b){if(d.isNoU(b))return r[a];r[a]=b;return this}var t=[],q=[];c.prototype.options=function(a){if(d.isNoU(a))return this._options;
this._options=a;d.isNoU(a)||(d.isNoU(a.componentId)||(this.componentId=a.componentId),this.container(a.container),this.model(a.model),this.view(a.view),this.controller(a.controller));return this};c.prototype.ready=function(a){};c.prototype.error=function(a,b){};c.prototype.on=function(a,b){return this._c.on(a,b)};c.prototype.invoke=function(a,b){return this._c.invoke(a,b)};c.prototype.model=function(a){if(d.isNoU(a))return this._model;this._model=a;return this};c.prototype.view=function(a){if("undefined"===
typeof a)return this._view;"string"===typeof a?(a={content:a},m(this,"html:parse",a),a=a.content,this._view=$("\x3cdiv/\x3e").append(a),m(this,"view:process",this._view),k(this._view)):this._view=a;return this};c.prototype.controller=function(a){if(d.isNoU(a))return this._controller;this._controller=a;return this};c.prototype.container=function(a){if(d.isNoU(a))return this._container;this._container=$(a);return this};f.prototype.addEvent=function(a,b,c){d.isNoU(a)||(a.off(b,this.eventRouter),this.context._eventMap[b]=
c,a.on(b,this.eventRouter))};f.prototype.addBehavior=function(a,b,c){d.isNoU(a)||(a.off(b,this.eventRouter),this.context._behaviorMap[b]=c,a.on(b,this.eventRouter))};f.prototype.field=function(a,b){var c=b?"@"+a:a;"undefined"===typeof this._fieldCache[c]?(a=b?$(a):this.view().find("[data-ui-field\x3d"+a+"]"),a.length&&(this._fieldCache[c]=a)):a=this._fieldCache[c];return a};f.prototype.clearCache=function(){this._fieldCache.length=0};var D=eval,z=0,l=[],r=[],d={isNoU:function(a){return"undefined"===
typeof a||null===a},isFunction:function(a){return"function"===typeof a},objectEquals:function(a,b){if(null===a||void 0===a||null===b||void 0===b)return a===b;if(a.constructor!==b.constructor)return!1;if(a instanceof Function||a instanceof RegExp)return a===b;if(a===b||a.valueOf()===b.valueOf())return!0;if(Array.isArray(a)&&a.length!==b.length||a instanceof Date||!(a instanceof Object)||!(b instanceof Object))return!1;var c=Object.keys(a);return Object.keys(b).every(function(a){return-1!==c.indexOf(a)})&&
c.every(function(c){return d.objectEquals(a[c],b[c])})},propertyFromPath:function(a,b){if("string"===typeof b){b=b.replace(/\[(\w+)]/g,".$1");b=b.replace(/^\./,"");b=b.split(".");for(var c=0,d=b.length;c<d;++c){var f=b[c];if("undefined"!==typeof a[f])a=a[f];else return}return a}}};this.zuix=this.zuix||{controller:g,load:w,unload:B,componentize:k,hook:function(a,b){E(a,b);return this},field:h,dumpCache:function(){console.log("ZUIX","Component Cache",t)},dumpContexts:function(){console.log("ZUIX","Loaded Component Instances",
q)}};return zuix}).call(this);
//# sourceMappingURL=zuix.min.js.map
